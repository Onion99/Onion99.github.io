{"title":"自定义View(1) - 基本绘制","date":"2021-11-01T22:17:37.000Z","date_formatted":{"ll":"2021年11月1日","L":"2021/11/01","MM-DD":"11-01"},"link":"2021/11/01/K0uh0dFU4QBtZ8Wm","comments":true,"tags":["图形绘制"],"categories":["Android"],"updated":"2021-11-01T14:17:06.000Z","content":"<blockquote>\n<p>简单的绘制基本由<code>Canvas.drawxxx()</code>和Paint的配置组成</p>\n</blockquote>\n<p><img src=\"https://z3.ax1x.com/2021/11/01/IC9uZj.png\" alt=\"IC9uZj.png\" loading=\"lazy\" class=\"φbp\"></p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">PaintView</span> <span class=\"meta\">@JvmOverloads</span> <span class=\"keyword\">constructor</span></span>(context: Context, attrs: AttributeSet? = <span class=\"literal\">null</span>, defStyleAttr: <span class=\"built_in\">Int</span> = <span class=\"number\">0</span>) : View(context, attrs, defStyleAttr) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> <span class=\"keyword\">val</span> mPaint <span class=\"keyword\">by</span> lazy &#123; Paint() &#125;</span><br><span class=\"line\">  <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onDraw</span><span class=\"params\">(canvas: <span class=\"type\">Canvas</span>)</span></span> &#123;  </span><br><span class=\"line\">    <span class=\"keyword\">super</span>.onDraw(canvas)</span><br><span class=\"line\">    paint.setColor(Color.RED)<span class=\"comment\">// 设置为红色</span></span><br><span class=\"line\">    canvas.drawCircle(<span class=\"number\">300</span>, <span class=\"number\">300</span>, <span class=\"number\">200</span>, paint)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<span id=\"more\"></span>\n<h3 id=\"canvas\">Canvas<a title=\"#canvas\" href=\"#canvas\"></a></h3>\n<ul>\n<li><code>Canvas.drawArc()</code> 绘制弧形或扇形<br>\n+ <code>left</code>, <code>top</code>, <code>right</code>, <code>bottom</code> 描述的是这个弧形所在的椭圆<br>\n+ <code>startAngle</code> 是弧形的起始角度<br>\n+ <code>sweepAngle</code> 是弧形划过的角度<br>\n+ <code>useCenter</code> 表示是否连接到圆心，如果不连接到圆心，就是弧形，如果连接到圆心，就是扇形</li>\n<li><code>Canvas.drawPath()</code> 组合图形</li>\n</ul>\n<h3 id=\"paint\">Paint<a title=\"#paint\" href=\"#paint\"></a></h3>\n<ul>\n<li><code>Paint.setStyle(Style style)</code>  设置绘制模式</li>\n<li><code>Paint.setColor(int color)</code>  设置颜色</li>\n<li><code>Paint.setStrokeWidth(float width)</code>  设置线条宽度</li>\n<li><code>Paint.setTextSize(float textSize)</code>  设置文字大小</li>\n<li><code>Paint.setAntiAlias(boolean aa)</code>  设置抗锯齿开关</li>\n</ul>\n<h3 id=\"path\">Path<a title=\"#path\" href=\"#path\"></a></h3>\n<blockquote>\n<p>如果只画一个圆，没必要用 Path，直接用 drawCircle() 就行了。drawPath() 一般是在绘制组合图形时才会用到的</p>\n</blockquote>\n<h4 id=\"path.addxxx\">Path.addXxx<a title=\"#path.addxxx\" href=\"#path.addxxx\"></a></h4>\n<blockquote>\n<p>添加子图形</p>\n</blockquote>\n<p><code>path.addCircle(300, 300, 200, Path.Direction.CW)</code></p>\n<h4 id=\"path.xxxto\">Path.xxxTo<a title=\"#path.xxxto\" href=\"#path.xxxto\"></a></h4>\n<blockquote>\n<p>用于画线（直线或曲线）</p>\n</blockquote>\n<p><code>lineTo(float x, float y) / rLineTo(float x, float y) </code>画直线:<br>\n<img src=\"https://z3.ax1x.com/2021/11/01/ICkWGR.png\" alt=\"ICkWGR.png\" loading=\"lazy\"></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">paint.setStyle(Style.STROKE);</span><br><span class=\"line\">path.lineTo(<span class=\"number\">100</span>, <span class=\"number\">100</span>); <span class=\"comment\">// 由当前位置 (0, 0) 向 (100, 100) 画一条直线</span></span><br><span class=\"line\">path.rLineTo(<span class=\"number\">100</span>, <span class=\"number\">0</span>); <span class=\"comment\">// 由当前位置 (100, 100) 向正右方 100 像素的位置画一条直线</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://z3.ax1x.com/2021/11/01/ICASL8.png\" alt=\"ICASL8.png\" loading=\"lazy\">]</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">paint.setStyle(Style.STROKE);</span><br><span class=\"line\">path.lineTo(<span class=\"number\">100</span>, <span class=\"number\">100</span>); <span class=\"comment\">// 画斜线</span></span><br><span class=\"line\">path.moveTo(<span class=\"number\">200</span>, <span class=\"number\">100</span>); <span class=\"comment\">// 我移~~</span></span><br><span class=\"line\">path.lineTo(<span class=\"number\">200</span>, <span class=\"number\">0</span>); <span class=\"comment\">// 画竖线</span></span><br></pre></td></tr></table></figure>\n<p><code>arcTo()</code> 和 <code>addArc()</code>画弧线:</p>\n<div class=\"φbq\"><div class=\"φbs\"><table><thead>\n<tr>\n<th style=\"text-align:center\">true</th>\n<th style=\"text-align:center\">false</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\"><img src=\"https://z3.ax1x.com/2021/11/01/ICEuct.png\" alt=\"ICEuct.png\" loading=\"lazy\"></td>\n<td style=\"text-align:center\"><img src=\"https://z3.ax1x.com/2021/11/01/ICEinK.png\" alt=\"ICEinK.png\" loading=\"lazy\"></td>\n</tr>\n</tbody>\n</table></div></div><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">paint.setStyle(Style.STROKE);</span><br><span class=\"line\">path.lineTo(<span class=\"number\">100</span>, <span class=\"number\">100</span>);</span><br><span class=\"line\"><span class=\"comment\">// true 直接连线连到弧形起点（有痕迹）</span></span><br><span class=\"line\"><span class=\"comment\">// false 强制移动到弧形起点（无痕迹）</span></span><br><span class=\"line\">path.arcTo(<span class=\"number\">100</span>, <span class=\"number\">100</span>, <span class=\"number\">300</span>, <span class=\"number\">300</span>, -<span class=\"number\">90</span>, <span class=\"number\">90</span>, <span class=\"keyword\">true</span>/<span class=\"keyword\">false</span>); </span><br><span class=\"line\"><span class=\"comment\">// 等同上面</span></span><br><span class=\"line\">paint.setStyle(Style.STROKE);</span><br><span class=\"line\">path.lineTo(<span class=\"number\">100</span>, <span class=\"number\">100</span>);</span><br><span class=\"line\">path.addArc(<span class=\"number\">100</span>, <span class=\"number\">100</span>, <span class=\"number\">300</span>, <span class=\"number\">300</span>, -<span class=\"number\">90</span>, <span class=\"number\">90</span>); <span class=\"comment\">// addArc() 只是一个直接使用了 forceMoveTo = true 的简化版 arcTo()</span></span><br></pre></td></tr></table></figure>\n<p><code>close() </code>封闭当前子图形:</p>\n<div class=\"φbq\"><div class=\"φbs\"><table><thead>\n<tr>\n<th style=\"text-align:center\">no close</th>\n<th style=\"text-align:center\">close</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\"><img src=\"https://z3.ax1x.com/2021/11/01/ICVaPH.png\" alt=\"ICVaPH.png\" loading=\"lazy\"></td>\n<td style=\"text-align:center\"><img src=\"https://z3.ax1x.com/2021/11/01/ICVgIg.png\" alt=\"ICVgIg.png\" loading=\"lazy\"></td>\n</tr>\n</tbody>\n</table></div></div><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">paint.setStyle(Style.STROKE);</span><br><span class=\"line\">path.moveTo(<span class=\"number\">100</span>, <span class=\"number\">100</span>);</span><br><span class=\"line\">path.lineTo(<span class=\"number\">200</span>, <span class=\"number\">100</span>);</span><br><span class=\"line\">path.lineTo(<span class=\"number\">150</span>, <span class=\"number\">150</span>);</span><br><span class=\"line\">path.close(); </span><br></pre></td></tr></table></figure>\n<h4 id=\"path.setfilltype\">Path.setFillType<a title=\"#path.setfilltype\" href=\"#path.setfilltype\"></a></h4>\n<blockquote>\n<p>设置填充方式</p>\n</blockquote>\n<p><img src=\"https://z3.ax1x.com/2021/11/01/ICFucV.png\" alt=\"ICFucV.png\" loading=\"lazy\" class=\"φbp\"></p>\n<div class=\"φbq\"><div class=\"φbs\"><table><thead>\n<tr>\n<th style=\"text-align:center\">EVEN_ODD:even-odd rule （奇偶原则）</th>\n<th style=\"text-align:center\">WINDING: non-zero winding rule （非零环绕数原则）</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\"><img src=\"https://z3.ax1x.com/2021/11/01/ICFKXT.png\" alt=\"ICFKXT.png\" loading=\"lazy\"></td>\n<td style=\"text-align:center\"><img src=\"https://z3.ax1x.com/2021/11/01/ICFJhR.png\" alt=\"ICFJhR.png\" loading=\"lazy\"></td>\n</tr>\n</tbody>\n</table></div></div>","prev":{"title":"自定义View(2) - Paint相关","link":"2021/11/01/weRgrdLnBqIUWkcH"},"next":{"title":"Java 理论","link":"2021/10/31/nOSSxZ51uxl6hUq8"},"plink":"https://onion99.github.io/2021/11/01/K0uh0dFU4QBtZ8Wm/","reward":true,"copyright":{"custom":"Copyright:自由转载-非商用-禁止演绎-保持署名（CC BY-NC-ND 4.0）"}}