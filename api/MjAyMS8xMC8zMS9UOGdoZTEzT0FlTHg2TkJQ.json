{"title":"安卓优化 - 内存优化","date":"2021-10-31T20:46:21.000Z","date_formatted":{"ll":"2021年10月31日","L":"2021/10/31","MM-DD":"10-31"},"link":"2021/10/31/T8ghe13OAeLx6NBP","comments":true,"tags":["性能优化"],"categories":["Android"],"updated":"2021-10-31T12:45:36.000Z","content":"<h3 id=\"内存信息查看\">内存信息查看<a title=\"#内存信息查看\" href=\"#内存信息查看\"></a></h3>\n<p><a href=\"https://www.jianshu.com/p/28b9cd87e667\" target=\"_blank\">App内存优化实践：一步一步做内存分析与优化</a></p>\n<p>查看每个App进程可以分配到的最大内存</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">adb shell getprop | grep dalvik.vm.heapsize</span><br></pre></td></tr></table></figure>\n<p>App的内存使用情况概览</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">adb shell dumpsys meminfo 包名</span><br></pre></td></tr></table></figure>\n<h3 id=\"优化工具\">优化工具<a title=\"#优化工具\" href=\"#优化工具\"></a></h3>\n<ul>\n<li>CPU Profiler</li>\n<li>Memory Analyzer（MAT）</li>\n<li>LeakCannary</li>\n</ul>\n<span id=\"more\"></span>\n<h3 id=\"优化方向\">优化方向<a title=\"#优化方向\" href=\"#优化方向\"></a></h3>\n<p><a href=\"https://www.cnblogs.com/wangjie1990/p/11327112.html\" target=\"_blank\">Android 如何优化APP内存 </a></p>\n<ul>\n<li>谨慎使用Services\n<ul>\n<li>启动一个Service时， 系统需要始终保持运行该Service的进程,该Service占用的RAM对其他进程不共享</li>\n<li>避免使用持久性服务,如<code>JobScheduler</code>之类</li>\n</ul>\n</li>\n<li>使用经过优化的多数据容器\n<ul>\n<li>如SparseArray，SparseBooleanArray和LongSparseArray</li>\n<li>如有必要，您可以随时切换到原始数组以获得精简的数据结构</li>\n</ul>\n</li>\n<li>使用nano protobufs进行序列化数据</li>\n<li>避免内存泄漏\n<ul>\n<li>内存泄露会导致大量的垃圾收集事件发生,从而导致系统执行其他内容(如渲染或者传输)的时间变少</li>\n</ul>\n</li>\n<li>移除内存密集型资源，以及lib库\n<ul>\n<li>减小APK的大小</li>\n<li>请使用不进行反射扫描的依赖注入库(Dagger2),频繁的反射需要更多的CPU和内存消耗</li>\n<li>谨慎使用外部库,外部库可能对同一个功能有不一样的实现,这可能导致预期之外的事情</li>\n</ul>\n</li>\n</ul>\n","prev":{"title":"安卓优化 - 卡顿优化","link":"2021/10/31/UYa5EEntsM9sKTYz"},"next":{"title":"安卓优化 - 启动优化","link":"2021/10/31/4LlbPfdOOCp58LMK"},"plink":"https://onion99.github.io/2021/10/31/T8ghe13OAeLx6NBP/","reward":true,"copyright":{"custom":"Copyright:自由转载-非商用-禁止演绎-保持署名（CC BY-NC-ND 4.0）"}}