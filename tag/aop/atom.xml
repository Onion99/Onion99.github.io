<?xml version="1.0"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://onion99.github.io</id>
    <title>Stay hungry , Stay foolish â€¢ Posts by &#34;aop&#34; tag</title>
    <link href="https://onion99.github.io" />
    <updated>2022-03-12T09:45:36.000Z</updated>
    <category term="æºç è§£æ" />
    <category term="AOP" />
    <category term="æ€§èƒ½ä¼˜åŒ–" />
    <category term="å¹¶å‘" />
    <category term="å›¾å½¢ç»˜åˆ¶" />
    <category term="è¯¾ç¨‹å­¦ä¹ " />
    <category term="ç†è®ºå­¦ä¹ " />
    <category term="é»‘ç§‘æŠ€" />
    <entry>
        <id>https://onion99.github.io/2022/03/12/Kt2Wobik8Fv12ZRY/</id>
        <title>Android AOP - ASM+Transform</title>
        <link rel="alternate" href="https://onion99.github.io/2022/03/12/Kt2Wobik8Fv12ZRY/"/>
        <content type="html">&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;p&gt;&lt;img src=&#34;https://s1.ax1x.com/2022/03/10/bhoW8O.png&#34; alt=&#34;bhoW8O.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;transform&#34;&gt;Transform&lt;a title=&#34;#transform&#34; href=&#34;#transform&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;Android Gradle Plugin ä» 1.5.0 å¼€å§‹æ”¯æŒ Transform APIï¼Œä»¥å…è®¸ç¬¬ä¸‰æ–¹æ’ä»¶åœ¨ç»è¿‡ç¼–è¯‘çš„ .class æ–‡ä»¶è½¬æ¢ä¸º .dex æ–‡ä»¶ä¹‹å‰å¯¹å…¶è¿›è¡Œæ“çºµã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ™®é€šç¼–è¯‘è¿‡ç¨‹ï¼š&lt;br&gt;
&lt;img src=&#34;https://s1.ax1x.com/2022/03/11/bINI8f.png&#34; alt=&#34;bINI8f.png&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
å¯ä»¥çœ‹åˆ°Android æ„å»ºæµç¨‹æ˜¯ä¸€å¥—æµæ°´çº¿çš„å·¥ä½œæœºåˆ¶ï¼Œæ¯ä¸€ä¸ªçš„æ„å»ºå•å…ƒæ¥æ”¶ä¸Šä¸€ä¸ªæ„å»ºå•å…ƒçš„è¾“å‡ºï¼Œä½œä¸ºè¾“å…¥ï¼Œå†å°†äº§å“è¿›è¡Œè¾“å‡ºï¼Œ&lt;code&gt;com.android.build&lt;/code&gt;åº“æä¾›äº†&lt;code&gt;Transform&lt;/code&gt;çš„æœºåˆ¶ï¼Œè€Œè¿™ä¸ªæœºåˆ¶æ˜¯Android æ„å»ºç³»ç»Ÿä¸ºäº†ç»™å¤–éƒ¨æä¾›ä¸€ä¸ªå¯ä»¥åŠ å…¥è‡ªå®šä¹‰æ„å»ºå•å…ƒï¼Œå¦‚æ‹¦æˆªæŸä¸ªæ„å»ºå•å…ƒçš„è¾“å‡ºï¼Œæˆ–è€…åŠ å…¥ä¸€äº›è¾“å‡ºç­‰ã€‚è€Œè¿™äº›Transformæ˜¯åœ¨javaæºç ç¼–è¯‘å®Œæˆä¹‹åï¼Œpackageä¹‹å‰è¿›è¡Œçš„ã€‚&lt;br&gt;
&lt;img src=&#34;https://s1.ax1x.com/2022/03/11/bIZBy8.md.png&#34; alt=&#34;bIZBy8.md.png&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;åœ¨Android Gradleæ„å»ºç³»ç»Ÿä¸­ï¼Œå¯ä»¥é€šè¿‡&lt;code&gt;AppExtension &lt;/code&gt;å°†&lt;code&gt;transform&lt;/code&gt;æ³¨å†Œåˆ°æ„å»ºç³»ç»Ÿä¸­:&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;CustomPlugin&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;implements&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;Plugin&lt;/span&gt;&amp;lt;&lt;span class=&#34;title&#34;&gt;Project&lt;/span&gt;&amp;gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;apply&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(Project project)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        AppExtension appExtension = (AppExtension)project.getProperties().get(&lt;span class=&#34;string&#34;&gt;&amp;quot;android&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// ç»™Appç¼–è¯‘è¿‡ç¨‹æ³¨å†Œtransform&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        appExtension.registerTransform(&lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; CustomTransform(), Collections.EMPTY_LIST);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;asm&#34;&gt;ASM&lt;a title=&#34;#asm&#34; href=&#34;#asm&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&#34;https://asm.ow2.io/&#34; target=&#34;_blank&#34;&gt;ASM&lt;/a&gt;æ˜¯ä¸€ç§é€šç”¨&lt;strong&gt;Javaå­—èŠ‚ç &lt;/strong&gt;æ“ä½œå’Œåˆ†ææ¡†æ¶ã€‚å®ƒå¯ä»¥ç”¨æ¥ä¿®æ”¹ç°æœ‰çš„ç±»ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä»¥äºŒè¿›åˆ¶å½¢å¼åŠ¨æ€ç”Ÿæˆç±»ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&#34;https://s1.ax1x.com/2022/03/11/bI0iSx.png&#34; alt=&#34;bI0iSx.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;p&gt;ASMè®¾è®¡äº†ä¸¤ç§APIç±»å‹è§£ææ–‡ä»¶ç»“æ„ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Tree API&lt;/li&gt;
&lt;li&gt;åŸºäºVisitor API(visitor pattern)ï¼Œ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è®©æˆ‘ä»¬ä»¥ä¸åŒçš„æ–¹å¼å¤„ç†ä¸‹å§ğŸ¤¤ğŸ¤¤ğŸ¤¤&lt;/p&gt;
&lt;h4 id=&#34;tree-api&#34;&gt;Tree API&lt;a title=&#34;#tree-api&#34; href=&#34;#tree-api&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Tree APIå°†classçš„ç»“æ„è¯»å–åˆ°å†…å­˜ï¼Œæ„å»ºä¸€ä¸ªæ ‘å½¢ç»“æ„ï¼Œç„¶åéœ€è¦å¤„ç†Methodã€Fieldç­‰å…ƒç´ æ—¶ï¼Œåˆ°æ ‘å½¢ç»“æ„ä¸­å®šä½åˆ°æŸä¸ªå…ƒç´ ï¼Œè¿›è¡Œæ“ä½œï¼Œç„¶åæŠŠæ“ä½œå†å†™å…¥æ–°çš„classæ–‡ä»¶ã€‚&lt;/p&gt;
&lt;figure class=&#34;highlight kotlin&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;TestPlugin&lt;/span&gt; : &lt;span class=&#34;type&#34;&gt;Plugin&lt;/span&gt;&amp;lt;&lt;span class=&#34;type&#34;&gt;Project&lt;/span&gt;&amp;gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;override&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;apply&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(target: &lt;span class=&#34;type&#34;&gt;Project&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        println(&lt;span class=&#34;string&#34;&gt;&amp;quot;Test Plugin : target = [&lt;span class=&#34;subst&#34;&gt;$&amp;#123;target&amp;#125;&lt;/span&gt;]&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;val&lt;/span&gt; appExtension: AppExtension = target.extensions.getByType()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        appExtension.registerTransform(TestTransform())&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;TestTransform&lt;/span&gt; : &lt;span class=&#34;type&#34;&gt;BaseTransform&lt;/span&gt;&lt;/span&gt;()&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;companion&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;object&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; isPrint = &lt;span class=&#34;literal&#34;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; isChange = &lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;override&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;modifyClass&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(byteArray: &lt;span class=&#34;type&#34;&gt;ByteArray&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;: ByteArray &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;val&lt;/span&gt; classReader = ClassReader(byteArray)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;val&lt;/span&gt; classNode = ClassNode()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// é€šè¿‡ä¼ é€’ ClassReader è§£æå¯¹åº” ClassFile ç”Ÿæˆ ClassNode&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        classReader.accept(classNode, ClassReader.EXPAND_FRAMES)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// æ‰“å°æµ‹è¯•&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(isPrint)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            isPrint = &lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            Log.log(classNode.toString())&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; (methodNode &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; classNode.methods) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                Log.log(&lt;span class=&#34;string&#34;&gt;&amp;quot;&lt;span class=&#34;subst&#34;&gt;$&amp;#123;classNode.name&amp;#125;&lt;/span&gt; ------&amp;gt;&amp;gt;&amp;gt; &lt;span class=&#34;variable&#34;&gt;$methodNode&lt;/span&gt;&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// å¦‚æœæ–‡ä»¶å¯¹classNodeæœ‰ä¿®æ”¹çš„æƒ…å†µä¸‹ï¼Œéœ€è¦è¿™æ ·å¤„ç†&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(isChange)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;val&lt;/span&gt; classWriter = ClassWriter(ClassWriter.COMPUTE_MAXS)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            classNode.accept(classWriter)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; classWriter.toByteArray()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// è¿”å›ä¿®æ”¹å†…å®¹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; byteArray&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;override&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;getInputTypes&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;: MutableSet&amp;lt;QualifiedContent.ContentType&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; TransformManager.CONTENT_CLASS&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;override&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;getScopes&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;: MutableSet&amp;lt;&lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; QualifiedContent.Scope&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; mutableSetOf(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            QualifiedContent.Scope.PROJECT&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        )&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°ç¼–è¯‘çš„ç±»æ­£è¢«æˆ‘ä»¬æ‰“å°å‡ºæ¥ï¼š&lt;br&gt;
&lt;img src=&#34;https://s1.ax1x.com/2022/03/11/bIq3id.png&#34; alt=&#34;bIq3id.png&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;visitor-api&#34;&gt;Visitor API&lt;a title=&#34;#visitor-api&#34; href=&#34;#visitor-api&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Visitor APIåˆ™å°†é€šè¿‡æ¥å£çš„æ–¹å¼ï¼Œåˆ†ç¦»è¯»classå’Œå†™classçš„é€»è¾‘ï¼Œä¸€èˆ¬é€šè¿‡ä¸€ä¸ªClassReaderè´Ÿè´£è¯»å–classå­—èŠ‚ç ï¼Œç„¶åClassReaderé€šè¿‡ä¸€ä¸ªClassVisitoræ¥å£ï¼Œå°†å­—èŠ‚ç çš„æ¯ä¸ªç»†èŠ‚æŒ‰é¡ºåºé€šè¿‡æ¥å£çš„æ–¹å¼ï¼Œä¼ é€’ç»™ClassVisitorï¼ˆä½ ä¼šå‘ç°ClassVisitorä¸­æœ‰å¤šä¸ªvisitXXXXæ¥å£ï¼‰ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±åƒClassReaderå¸¦ç€ClassVisitoræ¸¸è§ˆäº†classå­—èŠ‚ç çš„æ¯ä¸€ä¸ªæŒ‡ä»¤ã€‚&lt;/p&gt;
&lt;figure class=&#34;highlight kotlin&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;TestPlugin&lt;/span&gt; : &lt;span class=&#34;type&#34;&gt;Plugin&lt;/span&gt;&amp;lt;&lt;span class=&#34;type&#34;&gt;Project&lt;/span&gt;&amp;gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;override&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;apply&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(target: &lt;span class=&#34;type&#34;&gt;Project&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        println(&lt;span class=&#34;string&#34;&gt;&amp;quot;Test Plugin : target = [&lt;span class=&#34;subst&#34;&gt;$&amp;#123;target&amp;#125;&lt;/span&gt;]&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;val&lt;/span&gt; appExtension: AppExtension = target.extensions.getByType()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        appExtension.registerTransform(TestVisitorTransform())&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;TestClassVisitor&lt;/span&gt;&lt;/span&gt;(visitor: ClassVisitor):ClassVisitor(Opcodes.ASM4,visitor)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;TestVisitorTransform&lt;/span&gt; : &lt;span class=&#34;type&#34;&gt;BaseTransform&lt;/span&gt;&lt;/span&gt;()&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;companion&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;object&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; isPrint = &lt;span class=&#34;literal&#34;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; isChange = &lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;override&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;modifyClass&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(byteArray: &lt;span class=&#34;type&#34;&gt;ByteArray&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;: ByteArray &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// è§£æclassæ–‡ä»¶&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;val&lt;/span&gt; classReader = ClassReader(byteArray)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// å°†classæ–‡ä»¶å†…å®¹å†™å…¥åˆ°ClassWriterä¸­&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;val&lt;/span&gt; classWriter = ClassWriter(classReader,ClassWriter.COMPUTE_MAXS)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// èµ‹äºˆå¯¹åº”çš„ClassVisitorè¯»å†™èƒ½åŠ›&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;val&lt;/span&gt; classVisitor = TestClassVisitor(classWriter)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        classReader.accept(classVisitor, ClassReader.EXPAND_FRAMES)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// æ‰“å°æµ‹è¯•&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(isPrint)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            isPrint = &lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            Log.log(classVisitor.toString())&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// å¦‚æœæ–‡ä»¶å¯¹classNodeæœ‰ä¿®æ”¹çš„æƒ…å†µä¸‹ï¼Œéœ€è¦è¿™æ ·å¤„ç†&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(isChange)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; classWriter.toByteArray()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// è¿”å›ä¿®æ”¹å†…å®¹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; byteArray&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;override&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;getInputTypes&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;: MutableSet&amp;lt;QualifiedContent.ContentType&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; TransformManager.CONTENT_CLASS&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;override&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;getScopes&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;: MutableSet&amp;lt;&lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; QualifiedContent.Scope&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; mutableSetOf(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            QualifiedContent.Scope.PROJECT&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        )&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;åŒæ ·å¯ä»¥çœ‹åˆ°ç¼–è¯‘çš„ç±»æ­£è¢«æˆ‘ä»¬æ‰“å°å‡ºæ¥ï¼š&lt;br&gt;
&lt;img src=&#34;https://s1.ax1x.com/2022/03/11/bIvebV.png&#34; alt=&#34;bIvebV.png&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ClassReaderï¼šè´Ÿè´£å¯¹ .class æ–‡ä»¶è¿›è¡Œè¯»å–&lt;/li&gt;
&lt;li&gt;ClassVisitorï¼š è´Ÿè´£è®¿é—® .class æ–‡ä»¶ä¸­å„ä¸ªå…ƒç´ &lt;/li&gt;
&lt;li&gt;ClassWriterï¼š è´Ÿè´£å¯¹ .class æ–‡ä»¶è¿›è¡Œå†™å…¥ï¼Œå°†å­—èŠ‚ç è¾“å‡ºä¸º byte æ•°ç»„ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;å­—èŠ‚ç äº†è§£&#34;&gt;å­—èŠ‚ç äº†è§£&lt;a title=&#34;#å­—èŠ‚ç äº†è§£&#34; href=&#34;#å­—èŠ‚ç äº†è§£&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://plugins.jetbrains.com/plugin/14860-asm-bytecode-viewer-support-kotlin&#34; target=&#34;_blank&#34;&gt;Android Studio è¾…åŠ©ç±»è½¬å­—èŠ‚ç æ’ä»¶ï¼šASM Bytecode Viewer Support Kotlin&lt;/a&gt;&lt;br&gt;
&lt;img src=&#34;https://pic1.zhimg.com/v2-fdd5caeb51dbfb819539611fa9ccbcd4_r.jpg&#34; alt=&#34;preview&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://juejin.cn/post/6944517233674551304#heading-5&#34; target=&#34;_blank&#34;&gt;å­—èŠ‚ç ç»“æ„åˆ†æ - æ˜é‡‘ (juejin.cn)&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://www.jianshu.com/p/92a75a18cbc1&#34; target=&#34;_blank&#34;&gt;Java ByteCode - ç®€ä¹¦ (jianshu.com)&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://zhuanlan.zhihu.com/p/94498015&#34; target=&#34;_blank&#34;&gt;å²ä¸Šæœ€é€šä¿—æ˜“æ‡‚çš„ASMæ•™ç¨‹ - çŸ¥ä¹ (zhihu.com)&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;è‡ªå®šä¹‰gradleæ’ä»¶&#34;&gt;è‡ªå®šä¹‰gradleæ’ä»¶&lt;a title=&#34;#è‡ªå®šä¹‰gradleæ’ä»¶&#34; href=&#34;#è‡ªå®šä¹‰gradleæ’ä»¶&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;Transformå’ŒAsmçš„ç»“åˆä½¿ç”¨éœ€è¦ç”¨åˆ°Gradleæ’ä»¶&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è‡ªå®šä¹‰æ’ä»¶æ–¹å¼ï¼šè¯¦çœ‹&lt;a href=&#34;https://docs.gradle.org/current/userguide/custom_plugins.html#example_a_build_for_a_custom_plugin&#34; target=&#34;_blank&#34;&gt;Developing Custom Gradle Plugins&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Build script&lt;/li&gt;
&lt;li&gt;&lt;code&gt;buildSrc&lt;/code&gt; é¡¹ç›®&lt;/li&gt;
&lt;li&gt;ç‹¬ç«‹é¡¹ç›®ï¼ˆStandalone projectï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;build-script&#34;&gt;Build script&lt;a title=&#34;#build-script&#34; href=&#34;#build-script&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;ç›´æ¥åœ¨é¡¹ç›®çš„build.gradleä¸­æ·»åŠ groovyè„šæœ¬ä»£ç å¹¶å¼•ç”¨ã€‚è¿™æ ·æ’ä»¶åœ¨æ„å»ºè„šæœ¬ä¹‹å¤–ä¸å¯è§ï¼Œåªèƒ½åœ¨æ­¤æ¨¡å—ä¸­ä½¿ç”¨è„šæœ¬æ’ä»¶ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol&gt;
&lt;li&gt;ç®€å•ç¼–å†™è„šæœ¬&lt;br&gt;
build.gradle:&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight groovy&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;GreetingPlugin&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;implements&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;Plugin&lt;/span&gt;&amp;lt;&lt;span class=&#34;title&#34;&gt;Project&lt;/span&gt;&amp;gt; &amp;#123;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; apply(Project project) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        project.task(&lt;span class=&#34;string&#34;&gt;&amp;#x27;hello&amp;#x27;&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            doLast &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                println &lt;span class=&#34;string&#34;&gt;&amp;#x27;Hello from the GreetingPlugin&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// Apply the plugin&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;apply &lt;span class=&#34;attr&#34;&gt;plugin:&lt;/span&gt; GreetingPlugin&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;è·Ÿä¸Šé¢ä¸€æ ·ï¼Œåªä¸è¿‡é‡‡ç”¨æ–°ç‰ˆktsé£æ ¼&lt;br&gt;
build.gradle.kts&lt;/p&gt;
&lt;figure class=&#34;highlight kotlin&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;GreetingPlugin&lt;/span&gt; : &lt;span class=&#34;type&#34;&gt;Plugin&lt;/span&gt;&amp;lt;&lt;span class=&#34;type&#34;&gt;Project&lt;/span&gt;&amp;gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;override&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;apply&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(project: &lt;span class=&#34;type&#34;&gt;Project&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        project.task(&lt;span class=&#34;string&#34;&gt;&amp;quot;hello&amp;quot;&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            doLast &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                println(&lt;span class=&#34;string&#34;&gt;&amp;quot;Hello from the GreetingPlugin&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// Apply the plugin&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;apply&amp;lt;GreetingPlugin&amp;gt;()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;è¿è¡Œ&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&amp;gt; gradle -q hello&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Hello from the GreetingPlugin&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;buildsrc-é¡¹ç›®&#34;&gt;buildSrc é¡¹ç›®&lt;a title=&#34;#buildsrc-é¡¹ç›®&#34; href=&#34;#buildsrc-é¡¹ç›®&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;å°†æ’ä»¶çš„æºä»£ç æ”¾åœ¨rootProjectDir/buildSrc/src/main/groovyç›®å½•ä¸­ï¼ŒGradleå°†è´Ÿè´£ç¼–è¯‘å’Œæµ‹è¯•æ’ä»¶ï¼Œå¹¶ä½¿å…¶åœ¨æ„å»ºè„šæœ¬çš„ç±»è·¯å¾„ä¸­å¯ç”¨ã€‚è¯¥æ’ä»¶æ¯ä¸ªæ„å»ºè„šæœ¬éƒ½æ˜¯å¯è§çš„ã€‚ä½†æ˜¯å®ƒåœ¨æ„å»ºå¤–éƒ¨ä¸å¯è§å³åœ¨å½“å‰å·¥ç¨‹çš„å„ä¸ªæ¨¡å—éƒ½å¯è§ï¼Œä½†æ˜¯é¡¹ç›®ä¹‹å¤–ä¸å¯è§&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;buildSrcæ˜¯androidä¸­ä¸€ä¸ªä¿ç•™åï¼Œæ˜¯ä¸€ä¸ªä¸“é—¨ç”¨æ¥åšgradleæ’ä»¶çš„moduleï¼Œæ‰€ä»¥è¿™ä¸ªmoduleçš„åå­—å¿…é¡»æ˜¯buildSrcï¼Œæ­¤æ¨¡å—ä¸‹é¢æœ‰ä¸€ä¸ªå›ºå®šçš„ç›®å½•ç»“æ„src/main/groovyï¼Œè¿™ä¸ªæ˜¯ç”¨æ¥å­˜æ”¾çœŸæ­£çš„è„šæœ¬æ–‡ä»¶çš„ã€‚å…¶ä»–çš„è‡ªå®šä¹‰ç±»å¯ä»¥æ”¾åœ¨è¿™ä¸ªç›®å½•ä¸‹ï¼Œä¹Ÿå¯ä»¥æ”¾åœ¨è‡ªå»ºçš„å…¶ä»–ç›®å½•ä¸‹ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åˆ›å»º&lt;code&gt;buildSrc&lt;/code&gt;Module,å¯ä»¥ç›´æ¥åˆ›å»ºç›®å½•
&lt;ul&gt;
&lt;li&gt;åœ¨å·¥ç¨‹æ ¹ç›®å½•ä¸‹åˆ›å»ºç›®å½•&lt;code&gt;buildSrc&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;åœ¨buildSrcä¸‹åˆ›å»ºç›®å½•ç»“æ„ &lt;code&gt;src/main/groovy&lt;/code&gt;æˆ–è€…&lt;code&gt;src/main/java&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;åœ¨buildSrcæ ¹ç›®å½•ä¸‹åˆ›å»º&lt;code&gt; build.gradle&lt;/code&gt;æˆ–è€…&lt;code&gt; build.gradle.kts&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;build.gradle.kts:&lt;/p&gt;
&lt;figure class=&#34;highlight kotlin&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; org.jetbrains.kotlin.gradle.tasks.KotlinCompile&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plugins &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    `kotlin-dsl`&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    kotlin(&lt;span class=&#34;string&#34;&gt;&amp;quot;jvm&amp;quot;&lt;/span&gt;) version &lt;span class=&#34;string&#34;&gt;&amp;quot;1.4.32&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;val&lt;/span&gt; compileKotlin: KotlinCompile &lt;span class=&#34;keyword&#34;&gt;by&lt;/span&gt; tasks&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;val&lt;/span&gt; compileTestKotlin: KotlinCompile &lt;span class=&#34;keyword&#34;&gt;by&lt;/span&gt; tasks&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;compileKotlin.kotlinOptions &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    jvmTarget = &lt;span class=&#34;string&#34;&gt;&amp;quot;1.8&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;compileTestKotlin.kotlinOptions &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    jvmTarget = &lt;span class=&#34;string&#34;&gt;&amp;quot;1.8&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;repositories &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    google()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    mavenCentral()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;dependencies &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    implementation(&lt;span class=&#34;string&#34;&gt;&amp;quot;com.android.tools.build:gradle:4.1.1&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    compileOnly(&lt;span class=&#34;string&#34;&gt;&amp;quot;commons-io:commons-io:2.6&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    compileOnly(&lt;span class=&#34;string&#34;&gt;&amp;quot;commons-codec:commons-codec:1.15&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    compileOnly(&lt;span class=&#34;string&#34;&gt;&amp;quot;org.ow2.asm:asm-commons:9.2&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    compileOnly(&lt;span class=&#34;string&#34;&gt;&amp;quot;org.ow2.asm:asm-tree:9.2&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;build.gradle&lt;/p&gt;
&lt;figure class=&#34;highlight groovy&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;apply &lt;span class=&#34;attr&#34;&gt;plugin:&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;#x27;groovy&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;dependencies &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// gradleæ’ä»¶å¿…é¡»çš„å¼•ç”¨&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    implementation gradleApi()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    implementation localGroovy()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    implementation &lt;span class=&#34;string&#34;&gt;&amp;#x27;com.android.tools.build:gradle:4.1.1&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// asmä¾èµ–&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    implementation &lt;span class=&#34;string&#34;&gt;&amp;#x27;org.ow2.asm:asm:9.2&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    implementation &lt;span class=&#34;string&#34;&gt;&amp;#x27;org.ow2.asm:asm-util:9.2&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    implementation &lt;span class=&#34;string&#34;&gt;&amp;#x27;org.ow2.asm:asm-commons:9.2&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;repositories &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    mavenCentral()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    jcenter()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    google()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// æŒ‡å®šç¼–è¯‘çš„ç¼–ç  ä¸ç„¶æœ‰ä¸­æ–‡çš„è¯ä¼šå‡ºç°  â€™ç¼–ç GBKçš„ä¸å¯æ˜ å°„å­—ç¬¦â€˜&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;tasks.withType(JavaCompile) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    options.encoding = &lt;span class=&#34;string&#34;&gt;&amp;quot;UTF-8&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    println(&lt;span class=&#34;string&#34;&gt;&amp;#x27;ä½¿ç”¨utf8ç¼–è¯‘&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;åˆ›å»ºæ’ä»¶å…¥å£TestPlugin&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight kotlin&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;package&lt;/span&gt; com.onion.plugin.plugin&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;TestPlugin&lt;/span&gt;: &lt;span class=&#34;type&#34;&gt;Plugin&lt;/span&gt;&amp;lt;&lt;span class=&#34;type&#34;&gt;Project&lt;/span&gt;&amp;gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;override&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;apply&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(target: &lt;span class=&#34;type&#34;&gt;Project&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        println(&lt;span class=&#34;string&#34;&gt;&amp;quot;Test Plugin : target = [&lt;span class=&#34;subst&#34;&gt;$&amp;#123;target&amp;#125;&lt;/span&gt;]&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;åœ¨App Module ä¸­å¼•å…¥,ç„¶åProject Build&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight groovy&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; com.onion.plugin.plugin.TestPlugin&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;apply &lt;span class=&#34;attr&#34;&gt;plugin:&lt;/span&gt; TestPlugin &lt;span class=&#34;comment&#34;&gt;// æ’æ¡©æµ‹è¯•&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;æ’ä»¶å‘å¸ƒé¢å¤–å­¦ä¹ &#34;&gt;æ’ä»¶å‘å¸ƒé¢å¤–å­¦ä¹ &lt;a title=&#34;#æ’ä»¶å‘å¸ƒé¢å¤–å­¦ä¹ &#34; href=&#34;#æ’ä»¶å‘å¸ƒé¢å¤–å­¦ä¹ &#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://juejin.cn/post/6887581345384497165&#34; title=&#34;https://juejin.cn/post/6887581345384497165&#34; target=&#34;_blank&#34;&gt;Android Gradle æ’ä»¶å¼€å‘å…¥é—¨æŒ‡å—ï¼ˆä¸€ï¼‰&lt;/a&gt;ï¼Œè®²è§£Gradle Pluginå¼€å‘çš„å®Œæ•´æµç¨‹&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://juejin.cn/post/6887583351348133895&#34; title=&#34;https://juejin.cn/post/6887583351348133895&#34; target=&#34;_blank&#34;&gt;Android Gradle æ’ä»¶å¼€å‘å…¥é—¨æŒ‡å—ï¼ˆäºŒï¼‰&lt;/a&gt;ï¼Œé’ˆå¯¹Androidçš„Gradle Pluginå¼€å‘å®è·µ&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://juejin.cn/post/6890544619856068616&#34; title=&#34;https://juejin.cn/post/6890544619856068616&#34; target=&#34;_blank&#34;&gt;Android Gradle æ’ä»¶å¼€å‘å…¥é—¨æŒ‡å—ï¼ˆä¸‰ï¼‰&lt;/a&gt;ï¼Œå¦‚ä½•å°†æ’ä»¶å‘å¸ƒåˆ°jcenter&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;refer&#34;&gt;Refer&lt;a title=&#34;#refer&#34; href=&#34;#refer&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;http://quinnchen.cn/2018/09/13/2018-09-13-asm-transform/&#34; target=&#34;_blank&#34;&gt;ä¸€èµ·ç©è½¬Androidé¡¹ç›®ä¸­çš„å­—èŠ‚ç  | Quinn Note (quinnchen.cn)&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://www.jianshu.com/p/92a75a18cbc1&#34; target=&#34;_blank&#34;&gt;Java ByteCode&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://blog.csdn.net/qq_23992393/article/details/103696976&#34; target=&#34;_blank&#34;&gt;ASM + Transform åœ¨androidä¸­çš„ä½¿ç”¨&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://www.jianshu.com/p/a1e6b3abd789&#34; target=&#34;_blank&#34;&gt;ASM&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://juejin.cn/post/6893917892061413389#heading-3&#34; target=&#34;_blank&#34;&gt;ç™½è¯ Android AOP (ä¸€) &lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://mp.weixin.qq.com/s/YFi6-DrV22X_VVfFbKHNEg&#34; target=&#34;_blank&#34;&gt;Android gradle Transform åˆ†æ&lt;/a&gt;&lt;/p&gt;
</content>
        <category term="AOP" />
        <updated>2022-03-12T09:45:36.000Z</updated>
    </entry>
    <entry>
        <id>https://onion99.github.io/2022/03/11/3Bhw0wOwpYCE6F8V/</id>
        <title>Android AOP - AspectJ</title>
        <link rel="alternate" href="https://onion99.github.io/2022/03/11/3Bhw0wOwpYCE6F8V/"/>
        <content type="html">&lt;blockquote&gt;
&lt;p&gt;AspectJé€šè¿‡æ³¨è§£çš„å½¢å¼æ¥æ ‡æ³¨åˆ‡å…¥ç‚¹ã€åˆ‡å…¥å¯¹è±¡ç­‰ï¼Œç„¶ååœ¨ä»£ç ç¼–è¯‘æœŸé—´å°†ä»£ç ç»‡å…¥åˆ°javaçš„å­—èŠ‚ç ä¸­&lt;/p&gt;
&lt;/blockquote&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;p&gt;Androidå¼€æºæ–¹æ¡ˆï¼š&lt;a href=&#34;https://github.com/HujiangTechnology/gradle_plugin_android_aspectjx&#34; target=&#34;_blank&#34;&gt;AspectJX&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;å¼•å…¥ä¾èµ–&#34;&gt;å¼•å…¥ä¾èµ–&lt;a title=&#34;#å¼•å…¥ä¾èµ–&#34; href=&#34;#å¼•å…¥ä¾èµ–&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;gradleå¼•å…¥ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight groovy&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;buildscript &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    dependencies &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        classpath &lt;span class=&#34;string&#34;&gt;&amp;#x27;com.hujiang.aspectjx:gradle-android-plugin-aspectjx:2.0.4&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;åº”ç”¨pluginï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight groovy&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;apply &lt;span class=&#34;attr&#34;&gt;plugin:&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;#x27;android-aspectjx&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;AspectJXé…ç½®ï¼š&lt;/p&gt;
&lt;p&gt;AspectJXé»˜è®¤ä¼šå¤„ç†æ‰€æœ‰çš„äºŒè¿›åˆ¶ä»£ç æ–‡ä»¶å’Œåº“ï¼Œä¸ºäº†æå‡ç¼–è¯‘æ•ˆç‡åŠè§„é¿éƒ¨åˆ†ç¬¬ä¸‰æ–¹åº“å‡ºç°çš„ç¼–è¯‘å…¼å®¹æ€§é—®é¢˜ï¼ŒAspectJXæä¾›&lt;code&gt;include&lt;/code&gt;,&lt;code&gt;exclude&lt;/code&gt;å‘½ä»¤æ¥è¿‡æ»¤éœ€è¦å¤„ç†çš„æ–‡ä»¶åŠæ’é™¤æŸäº›æ–‡ä»¶(åŒ…æ‹¬classæ–‡ä»¶åŠjaræ–‡ä»¶)ã€‚&lt;/p&gt;
&lt;figure class=&#34;highlight groovy&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;aspectjx &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//æ’é™¤æ‰€æœ‰packageè·¯å¾„ä¸­åŒ…å«`android.support`çš„classæ–‡ä»¶åŠåº“ï¼ˆjaræ–‡ä»¶ï¼‰&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	exclude &lt;span class=&#34;string&#34;&gt;&amp;#x27;android.support&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å¼€å…³é…ç½®ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight groovy&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;aspectjx &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//å…³é—­AspectJXåŠŸèƒ½&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	enabled &lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;ç®€å•ä½¿ç”¨&#34;&gt;ç®€å•ä½¿ç”¨&lt;a title=&#34;#ç®€å•ä½¿ç”¨&#34; href=&#34;#ç®€å•ä½¿ç”¨&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;å‡†å¤‡åˆ‡å…¥çš„ç±»&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;Animal&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;fly&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        Log.e(TAG, &lt;span class=&#34;string&#34;&gt;&amp;quot;animal fly method:&amp;quot;&lt;/span&gt; + &lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;.toString() + &lt;span class=&#34;string&#34;&gt;&amp;quot;#fly&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;ç¼–å†™å¯¹åº”çš„åˆ‡é¢ç±»ï¼Œç”¨@Aspectæ³¨è§£&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Aspect&lt;/span&gt;  &lt;span class=&#34;comment&#34;&gt;//â‘ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;MethodAspect&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// æ ‡æ³¨åˆ‡å…¥çš„æ–¹æ³•ï¼Œçœ‹åˆ°æ²¡æœ‰è¿™é‡Œç”¨çš„Poincutçš„ call&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Pointcut(&amp;quot;call(* com.wandering.sample.aspectj.Animal.fly(..))&amp;quot;)&lt;/span&gt;&lt;span class=&#34;comment&#34;&gt;//â‘¡&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;callMethod&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// æ ‡æ³¨å‡½æ•°æ‰§è¡Œå‰å¤„ç†&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Before(&amp;quot;callMethod()&amp;quot;)&lt;/span&gt;&lt;span class=&#34;comment&#34;&gt;//â‘¢&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;beforeMethodCall&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(JoinPoint joinPoint)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        Log.e(TAG, &lt;span class=&#34;string&#34;&gt;&amp;quot;before-&amp;gt;&amp;quot;&lt;/span&gt; + joinPoint.getTarget().toString()); &lt;span class=&#34;comment&#34;&gt;//â‘£&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;ç¼–è¯‘åå°±å¯ä»¥çœ‹åˆ°ç±»çš„æ–¹æ³•åœ¨æ‰§è¡Œå‰æœ‰ä»£ç æ’å…¥äº†&lt;br&gt;
&lt;img src=&#34;https://s1.ax1x.com/2022/03/10/bhAMh8.png&#34; alt=&#34;bhAMh8.png&#34; loading=&#34;lazy&#34;&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;è¯­æ³•&#34;&gt;è¯­æ³•&lt;a title=&#34;#è¯­æ³•&#34; href=&#34;#è¯­æ³•&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;div class=&#34;Ï†bq&#34;&gt;&lt;div class=&#34;Ï†bs&#34;&gt;&lt;table&gt;&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left&#34;&gt;JPoint&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;è¯´æ˜&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;Pointcutè¯­æ³•&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;method call&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å‡½æ•°è°ƒç”¨&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;call(MethodSignature)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;method execution&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å‡½æ•°å†…éƒ¨æ‰§è¡Œ&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;execution(MethodSignatureï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;method execution&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ„é€ å‡½æ•°è°ƒç”¨&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;call(ConstructorSignatureï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;constructor execution&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ„é€ å‡½æ•°å†…éƒ¨æ‰§è¡Œ&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;execution(ConstructorSignatureï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;field get&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;è¯»å˜é‡&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;get(FieldSignatureï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;field set&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å†™å˜é‡&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;set(FieldSignatureï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;static initialization&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;é™æ€ä»£ç å—åˆå§‹åŒ–&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;staticinitialization(TypeSignatureï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;handler&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å¼‚å¸¸å¤„ç†&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;handler(TypeSignature),åªèƒ½ä¸@Before()é…ç½®ä½¿ç”¨&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;&lt;/div&gt;&lt;/div&gt;&lt;br/&gt;
&lt;div class=&#34;Ï†bq&#34;&gt;&lt;div class=&#34;Ï†bs&#34;&gt;&lt;table&gt;&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left&#34;&gt;Advice&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;@Before(Pointcut)&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ‰§è¡ŒJpointä¹‹å‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;@After(Pointcut)&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ‰§è¡ŒJpointä¹‹å&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;@Around(Pointcut)&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ›¿æ¢åŸç†çš„ä»£ç &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;&lt;/div&gt;&lt;/div&gt;&lt;p&gt;å®Œæ•´è¯­æ³•çœ‹è¿™&lt;a href=&#34;https://github.com/hyvenzhu/Android-Demos/blob/master/AspectJDemo/AspectJ.pdf&#34; target=&#34;_blank&#34;&gt;AspectJ&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;æ³¨æ„ç‚¹&#34;&gt;æ³¨æ„ç‚¹&lt;a title=&#34;#æ³¨æ„ç‚¹&#34; href=&#34;#æ³¨æ„ç‚¹&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;æ ‡æ³¨&lt;code&gt;call&lt;/code&gt;å’Œ&lt;code&gt;execution&lt;/code&gt;æ‰§è¡Œçš„æ—¶å€™ï¼ŒThiså’ŒTargetä¸åŒçš„&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Aspect&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;MethodAspect&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Pointcut(&amp;quot;call(* com.wandering.sample.aspectj.Animal.fly(..))&amp;quot;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;callMethod&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        Log.e(TAG, &lt;span class=&#34;string&#34;&gt;&amp;quot;callMethod-&amp;gt;&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Before(&amp;quot;callMethod()&amp;quot;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;beforeMethodCall&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(JoinPoint joinPoint)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        Log.e(TAG, &lt;span class=&#34;string&#34;&gt;&amp;quot;getTarget-&amp;gt;&amp;quot;&lt;/span&gt; + joinPoint.getTarget());&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        Log.e(TAG, &lt;span class=&#34;string&#34;&gt;&amp;quot;getThis-&amp;gt;&amp;quot;&lt;/span&gt; + joinPoint.getThis());&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;åˆ‡å…¥æ–¹ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;protected void onCreate(@Nullable Bundle savedInstanceState) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    super.onCreate(savedInstanceState);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    Animal animal = new Animal();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    animal.fly();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;è¿è¡Œç»“æœå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight groovy&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;getTarget-&amp;gt;com.wandering.sample.aspectj.Animal@&lt;span class=&#34;number&#34;&gt;509&lt;/span&gt;ddfd&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;getThis-&amp;gt;com.wandering.sample.aspectj.MainActivity@&lt;span class=&#34;number&#34;&gt;98&lt;/span&gt;c38bf&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;è¯´æ˜targetæŒ‡ä»£çš„æ˜¯åˆ‡å…¥ç‚¹æ–¹æ³•çš„æ‰€æœ‰è€…ï¼Œè€ŒthisæŒ‡ä»£çš„æ˜¯è¢«ç»‡å…¥ä»£ç æ‰€å±ç±»çš„å®ä¾‹å¯¹è±¡ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å°†åˆ‡ç‚¹çš„&lt;code&gt;call&lt;/code&gt;æ”¹ä¸º&lt;code&gt;execution&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight groovy&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;getTarget-&amp;gt;com.wandering.sample.aspectj.Animal@&lt;span class=&#34;number&#34;&gt;509&lt;/span&gt;ddfd&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;getThis-&amp;gt;com.wandering.sample.aspectj.Animal@&lt;span class=&#34;number&#34;&gt;509&lt;/span&gt;ddfd&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;ç¼ºç‚¹&#34;&gt;ç¼ºç‚¹&lt;a title=&#34;#ç¼ºç‚¹&#34; href=&#34;#ç¼ºç‚¹&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚æœç›¸åº”çš„classæ²¡æœ‰å®ç°ç›¸åº”çš„å¯¹ç‚¹æ–¹æ³•å°†æ— æ³•ç»‡å…¥ï¼Œå¦‚Activityæ²¡æœ‰å®ç°onResumeæ–¹æ³•çš„è¯ï¼Œå°†æ— æ³•ç»‡å…¥ä»£ç ã€‚&lt;/li&gt;
&lt;li&gt;æ— æ³•å¤„ç†Lambdaè¯­æ³•&lt;/li&gt;
&lt;li&gt;ä¼šæœ‰ä¸€ç³»åˆ—å…¼å®¹æ€§é—®é¢˜ï¼Œå¦‚R8ã€gradleç‰ˆæœ¬ä¸åŒç­‰&lt;/li&gt;
&lt;li&gt;æ€§èƒ½è¾ƒå·®ï¼ŒAPPé¡¹ç›®æ¯”è¾ƒå¤§æ—¶ç¼–è¯‘æ—¶é—´æ˜æ˜¾åŠ é•¿&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;refer&#34;&gt;Refer&lt;a title=&#34;#refer&#34; href=&#34;#refer&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/hyvenzhu/Android-Demos/blob/master/AspectJDemo/AspectJ.pdf&#34; target=&#34;_blank&#34;&gt;Android-Demos/AspectJ.pdf&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://juejin.cn/post/6888548726424469511&#34; target=&#34;_blank&#34;&gt;Android AOPæ–¹æ¡ˆ(ä¸€)â€”â€”AspectJ&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://www.jianshu.com/p/28aa352af7fb&#34; target=&#34;_blank&#34;&gt;Android AOP - ç®€ä¹¦&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://www.jianshu.com/p/d07c996ea13c&#34; target=&#34;_blank&#34;&gt;Android AspectJ&lt;/a&gt;&lt;/p&gt;
</content>
        <category term="AOP" />
        <updated>2022-03-11T09:40:38.000Z</updated>
    </entry>
    <entry>
        <id>https://onion99.github.io/2022/03/11/qyGiQE7cKbQOfEKm/</id>
        <title>Android AOP - JDKåŠ¨æ€ä»£ç†</title>
        <link rel="alternate" href="https://onion99.github.io/2022/03/11/qyGiQE7cKbQOfEKm/"/>
        <content type="html">&lt;p&gt;JDKçš„åŠ¨æ€ä»£ç†åº•å±‚æ˜¯é€šè¿‡Javaåå°„æœºåˆ¶å®ç°çš„ï¼Œå¹¶ä¸”éœ€è¦ç›®æ ‡å¯¹è±¡ç»§æ‰¿è‡ªä¸€ä¸ªæ¥å£æ‰èƒ½ç”Ÿæˆå®ƒçš„ä»£ç†ç±»&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;h4 id=&#34;javaåŠ¨æ€ä»£ç†&#34;&gt;JavaåŠ¨æ€ä»£ç†&lt;a title=&#34;#javaåŠ¨æ€ä»£ç†&#34; href=&#34;#javaåŠ¨æ€ä»£ç†&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;JDK è¿è¡ŒæœŸé—´ï¼ŒåŠ¨æ€åˆ›å»º class å­—èŠ‚ç å¹¶åŠ è½½åˆ° JVM&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol&gt;
&lt;li&gt;JDKçš„åŠ¨æ€ä»£ç†éœ€è¦å®ç°ä¸€ä¸ªå¤„ç†æ–¹æ³•è°ƒç”¨çš„Handlerï¼Œç”¨äºå®ç°ä»£ç†æ–¹æ³•çš„å†…éƒ¨é€»è¾‘ï¼Œå®ç°InvocationHandleræ¥å£&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;JdkProxyHandler&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;implements&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;InvocationHandler&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; Object target;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;JdkProxyHandler&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(Object target)&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;.target = target;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// proxyï¼šç”Ÿæˆçš„ä»£ç†å¯¹è±¡, objï¼šç›®æ ‡æ–¹æ³•, argsï¼šç›®æ ‡æ–¹æ³•å‚æ•°&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; Object &lt;span class=&#34;title&#34;&gt;invoke&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(Object proxy, Method method, Object[] args)&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;throws&lt;/span&gt; Throwable &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        System.out.println(&lt;span class=&#34;string&#34;&gt;&amp;quot;å¤„ç†å‰&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        Object result = method.invoke(target,args);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        System.out.println(&lt;span class=&#34;string&#34;&gt;&amp;quot;å¤„ç†å&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; result;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;ä»£ç†&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//2-1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;interface&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;ISender&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;send&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//2-2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;SmsSender&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;implements&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;ISender&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;send&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        System.out.println(&lt;span class=&#34;string&#34;&gt;&amp;quot;sending msg&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//2-3&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Test&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;testJdkProxy&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ISender sender = (ISender) Proxy.newProxyInstance(ClassLoader.getSystemClassLoader(),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; Class[]&amp;#123;ISender.class&amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; JdkProxyHandler(&lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; SmsSender()));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; result = sender.send();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    System.out.println(&lt;span class=&#34;string&#34;&gt;&amp;quot;ä»£ç†å¯¹è±¡ï¼š&amp;quot;&lt;/span&gt; + sender.getClass().getName());&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    System.out.println(&lt;span class=&#34;string&#34;&gt;&amp;quot;è¾“å‡ºç»“æœï¼š&amp;quot;&lt;/span&gt; + result);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;é€š è¿‡ JDK çš„ java.lang.reflect.Proxy ç±»å®ç°åŠ¨æ€ä»£ç† ï¼Œ ä¼šä½¿ç”¨å…¶é™æ€æ–¹æ³•newProxyInstance()ï¼Œä¾æ®ç›®æ ‡å¯¹è±¡ã€ä¸šåŠ¡æ¥å£åŠè°ƒç”¨å¤„ç†å™¨ä¸‰è€…ï¼Œè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªåŠ¨æ€ä»£ç†å¯¹è±¡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;public static newProxyInstance ( ClassLoader loader, Class&amp;lt;?&amp;gt;[] interfaces, InvocationHandler handler)&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;loaderï¼šç›®æ ‡ç±»çš„ç±»åŠ è½½å™¨ï¼Œé€šè¿‡ç›®æ ‡å¯¹è±¡çš„åå°„å¯è·å–&lt;/li&gt;
&lt;li&gt;interfacesï¼šç›®æ ‡ç±»å®ç°çš„æ¥å£æ•°ç»„ï¼Œé€šè¿‡ç›®æ ‡å¯¹è±¡çš„åå°„å¯è·å–&lt;/li&gt;
&lt;li&gt;handlerï¼šè°ƒç”¨å¤„ç†å™¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h5 id=&#34;åŸç†&#34;&gt;åŸç†&lt;a title=&#34;#åŸç†&#34; href=&#34;#åŸç†&#34;&gt;&lt;/a&gt;&lt;/h5&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;static&lt;/span&gt; Object &lt;span class=&#34;title&#34;&gt;newProxyInstance&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(ClassLoader loader,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;                                          Class&amp;lt;?&amp;gt;[] interfaces,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;                                          InvocationHandler h)&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;throws&lt;/span&gt; IllegalArgumentException &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//1.æ£€æŸ¥&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    Objects.requireNonNull(h);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; Class&amp;lt;?&amp;gt;[] intfs = interfaces.clone();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; SecurityManager sm = System.getSecurityManager();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (sm != &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        checkProxyAccess(Reflection.getCallerClass(), loader, intfs);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//æŸ¥æ‰¾æˆ–ç”ŸæˆæŒ‡å®šçš„ä»£ç†ç±»&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    Class&amp;lt;?&amp;gt; cl = getProxyClass0(loader, intfs);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;try&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (sm != &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            checkNewProxyPermission(Reflection.getCallerClass(), cl);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//é€šè¿‡åå°„åˆ›å»ºä»£ç†å¯¹è±¡&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; Constructor&amp;lt;?&amp;gt; cons = cl.getConstructor(constructorParams);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; InvocationHandler ih = h;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!Modifier.isPublic(cl.getModifiers())) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            AccessController.doPrivileged(&lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; PrivilegedAction&amp;lt;Void&amp;gt;() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; Void &lt;span class=&#34;title&#34;&gt;run&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    cons.setAccessible(&lt;span class=&#34;keyword&#34;&gt;true&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; cons.newInstance(&lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; Object[]&amp;#123;h&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;span class=&#34;keyword&#34;&gt;catch&lt;/span&gt; (IllegalAccessException|InstantiationException e) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;throw&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; InternalError(e.toString(), e);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;span class=&#34;keyword&#34;&gt;catch&lt;/span&gt; (InvocationTargetException e) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        Throwable t = e.getCause();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (t &lt;span class=&#34;keyword&#34;&gt;instanceof&lt;/span&gt; RuntimeException) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;throw&lt;/span&gt; (RuntimeException) t;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;throw&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; InternalError(t.toString(), t);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;span class=&#34;keyword&#34;&gt;catch&lt;/span&gt; (NoSuchMethodException e) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;throw&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; InternalError(e.toString(), e);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;å±€é™æ€§&#34;&gt;å±€é™æ€§&lt;a title=&#34;#å±€é™æ€§&#34; href=&#34;#å±€é™æ€§&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;åªèƒ½ä»£ç†æ¥å£ï¼Œå¹¶ä¸”åªèƒ½ä¿®æ”¹æ¥å£å£°æ˜çš„æ–¹æ³•&lt;/p&gt;
&lt;h3 id=&#34;refer&#34;&gt;Refer&lt;a title=&#34;#refer&#34; href=&#34;#refer&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.jb51.net/article/209607.htm&#34; target=&#34;_blank&#34;&gt;JavaåŠ¨æ€ä»£ç†å››ç§å®ç°æ–¹å¼è¯¦è§£&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://www.cnblogs.com/wkfvawl/p/15030814.html&#34; target=&#34;_blank&#34;&gt;Java åŠ¨æ€ä»£ç† - ç‹é™¸&lt;/a&gt;&lt;/p&gt;
</content>
        <category term="AOP" />
        <updated>2022-03-10T21:25:00.000Z</updated>
    </entry>
    <entry>
        <id>https://onion99.github.io/2022/03/10/9rnRdFk7xf4rnvds/</id>
        <title>Android AOP - æ¦‚è®º</title>
        <link rel="alternate" href="https://onion99.github.io/2022/03/10/9rnRdFk7xf4rnvds/"/>
        <content type="html">&lt;h3 id=&#34;ç¼–ç¨‹æ¶æ„æ€æƒ³&#34;&gt;ç¼–ç¨‹æ¶æ„æ€æƒ³&lt;a title=&#34;#ç¼–ç¨‹æ¶æ„æ€æƒ³&#34; href=&#34;#ç¼–ç¨‹æ¶æ„æ€æƒ³&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;é¢å‘å¯¹è±¡(Object Oriented Programming)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é¢å‘è¿‡ç¨‹(Procedure Oriented Programming)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é¢å‘åˆ‡é¢(Aspect Oriented Programming)&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;p&gt;AOP æ„ä¸ºé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œé€šè¿‡é¢„ç¼–è¯‘æ–¹å¼å’Œè¿è¡ŒæœŸåŠ¨æ€ä»£ç†å®ç°ç¨‹åºåŠŸèƒ½ç»Ÿä¸€ç»´æŠ¤çš„ä¸€ç§æŠ€æœ¯ï¼Œå’Œ OOP ä»¥å¯¹è±¡ä¸ºæ ¸å¿ƒä¸åŒï¼ŒAOPæ˜¯é’ˆå¯¹ä¸šåŠ¡å¤„ç†è¿‡ç¨‹ä¸­çš„ç±»ä¼¼çš„ä»£ç é€»è¾‘è¿›è¡Œåˆ‡å…¥ï¼Œç„¶åç»Ÿä¸€å¤„ç†ã€‚&lt;/p&gt;
&lt;p&gt;AOPå…¶å®æ˜¯OOPçš„è¡¥å……ï¼ŒOOPä»æ¨ªå‘ä¸ŠåŒºåˆ†å‡ºä¸€ä¸ªä¸ªçš„ç±»æ¥ï¼Œè€ŒAOPåˆ™ä»çºµå‘ä¸Šå‘å¯¹è±¡ä¸­åŠ å…¥ç‰¹å®šçš„ä»£ç ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://s1.ax1x.com/2022/03/10/bfRiDK.png&#34; alt=&#34;bfRiDK.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;å¸¸è§æ¦‚å¿µ&#34;&gt;å¸¸è§æ¦‚å¿µ&lt;a title=&#34;#å¸¸è§æ¦‚å¿µ&#34; href=&#34;#å¸¸è§æ¦‚å¿µ&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;è¿æ¥ç‚¹(&lt;em&gt;Joinpoint&lt;/em&gt;)
&lt;ul&gt;
&lt;li&gt;ç¨‹åºä¸­å¯èƒ½ä½œä¸ºä»£ç æ³¨å…¥ç›®æ ‡çš„ç‰¹å®šçš„ç‚¹ï¼Œä¾‹å¦‚ä¸€ä¸ªæ–¹æ³•è°ƒç”¨æˆ–è€…æ–¹æ³•å…¥å£ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;åˆ‡ç‚¹ï¼ˆ&lt;em&gt;Pointcut&lt;/em&gt;ï¼‰
&lt;ul&gt;
&lt;li&gt;å‘Šè¯‰ä»£ç æ³¨å…¥å·¥å…·ï¼Œåœ¨ä»»ä½•æ³¨å…¥ä¸€æ®µç‰¹å®šä»£ç çš„è¡¨è¾¾å¼ã€‚ä¾‹å¦‚ï¼Œåœ¨å“ªäº›joint pointsåº”ç”¨ä¸€ä¸ªç‰¹å®šçš„Adviceã€‚&lt;/li&gt;
&lt;li&gt;åˆ‡å…¥ç‚¹å¯ä»¥é€‰æ‹©å”¯ä¸€ä¸€ä¸ªï¼Œæ¯”å¦‚æ‰§è¡ŒæŸä¸€ä¸ªæ–¹æ³•ï¼Œä¹Ÿå¯ä»¥æœ‰å¤šä¸ªé€‰æ‹©ï¼Œæ¯”å¦‚ï¼Œæ ‡è®°äº†ä¸€ä¸ªå®šä¹‰æˆ@DebugLogçš„è‡ªå®šä¹‰æ³¨è§£çš„æ‰€æœ‰æ–¹æ³•ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å¢å¼ºï¼ˆ&lt;em&gt;Advice&lt;/em&gt;ï¼‰
&lt;ul&gt;
&lt;li&gt;æ³¨å…¥åˆ°classæ–‡ä»¶ä¸­çš„ä»£ç ã€‚&lt;/li&gt;
&lt;li&gt;å…¸å‹çš„Adviceç±»å‹æœ‰beforeã€afterå’Œaroundï¼Œåˆ†åˆ«è¡¨ç¤ºåœ¨ç›®æ ‡æ–¹æ³•æ‰§è¡Œä¹‹å‰ã€æ‰§è¡Œåå’Œå®Œå…¨ä»£æ›¿ç›®æ ‡æ–¹æ³•æ‰§è¡Œçš„ä»£ç ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç›®æ ‡å¯¹è±¡ (&lt;em&gt;Target&lt;/em&gt;)&lt;/li&gt;
&lt;li&gt;å¼•ä»‹(&lt;em&gt;Introduction&lt;/em&gt;)&lt;/li&gt;
&lt;li&gt;ç»‡å…¥ï¼ˆ&lt;em&gt;Weaving&lt;/em&gt;ï¼‰
&lt;ul&gt;
&lt;li&gt;æ³¨å…¥ä»£ç ï¼ˆadvicesï¼‰åˆ°ç›®æ ‡ä½ç½®ï¼ˆjoint pointsï¼‰çš„è¿‡ç¨‹&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä»£ç†ï¼ˆ&lt;em&gt;Proxy&lt;/em&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;åˆ‡é¢ï¼ˆ&lt;em&gt;Aspect&lt;/em&gt;ï¼‰
&lt;ul&gt;
&lt;li&gt;Pointcutå’ŒAdviceçš„ç»„åˆçœ‹åšåˆ‡é¢ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬åœ¨åº”ç”¨ä¸­é€šè¿‡å®šä¹‰ä¸€ä¸ªPointcutå’Œç»™å®šæ°å½“çš„Adviceï¼Œæ·»åŠ ä¸€ä¸ªæ—¥å¿—åˆ‡é¢&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;åˆ†ç±»&#34;&gt;åˆ†ç±»&lt;a title=&#34;#åˆ†ç±»&#34; href=&#34;#åˆ†ç±»&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸€ç±»æ˜¯ï¼Œä¾‹å¦‚Javaçš„åŠ¨æ€ä»£ç†ï¼›å¦ä¸€ç±»å¯ä»¥å½’ç»“ä¸ºï¼Œä¾‹å¦‚ç»å¸¸å¬è¯´çš„ï¼ŒAspecJç­‰æ¡†æ¶&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;è¿è¡ŒæœŸçš„AOP
&lt;ul&gt;
&lt;li&gt;Javaçš„åŠ¨æ€ä»£ç†&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç¼–è¯‘æœŸçš„AOP
&lt;ul&gt;
&lt;li&gt;ASM&lt;/li&gt;
&lt;li&gt;AspecJ&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;åº”ç”¨&#34;&gt;åº”ç”¨&lt;a title=&#34;#åº”ç”¨&#34; href=&#34;#åº”ç”¨&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Hot Fix
&lt;ul&gt;
&lt;li&gt;åŸºäºAOPæŠ€æœ¯ï¼Œç¼–è¯‘æœŸä¿®æ”¹Javaå­—èŠ‚ç ï¼Œå¯¹æ¯ä¸€ä¸ªæ–¹æ³•è¿›è¡Œæ’æ¡©æ“ä½œï¼Œä»¥ä¾¿äºhookæ¯ä¸€ä¸ªæ–¹æ³•ï¼Œåšåˆ°æ–¹æ³•çº§åˆ«çš„çƒ­ä¿®å¤&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç›‘æµ‹æ–¹æ³•è€—æ—¶&lt;/li&gt;
&lt;li&gt;æ—¥å¿—è®°å½•&lt;/li&gt;
&lt;li&gt;ç»Ÿä¸€å¤„ç†ç‚¹å‡»æŠ–åŠ¨&lt;/li&gt;
&lt;li&gt;å…¶ä»–çš„ç›‘æ§æ–¹é¢&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;aopä¸aptåŒºåˆ«&#34;&gt;AOPä¸APTåŒºåˆ«&lt;a title=&#34;#aopä¸aptåŒºåˆ«&#34; href=&#34;#aopä¸aptåŒºåˆ«&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;APT(Annotation Processing Tool)å³æ³¨è§£å¤„ç†å™¨ï¼Œæ˜¯ä¸€ç§å¤„ç†æ³¨è§£çš„å·¥å…·ï¼Œç¡®åˆ‡çš„è¯´å®ƒæ˜¯javacçš„ä¸€ä¸ªå·¥å…·ï¼Œå®ƒç”¨æ¥åœ¨ç¼–è¯‘æ—¶æ‰«æå’Œå¤„ç†æ³¨è§£ã€‚æ³¨è§£å¤„ç†å™¨ä»¥Javaä»£ç (æˆ–è€…ç¼–è¯‘è¿‡çš„å­—èŠ‚ç )ä½œä¸ºè¾“å…¥ï¼Œç”Ÿæˆ&lt;code&gt;.javaæ–‡ä»¶&lt;/code&gt;ä½œä¸ºè¾“å‡ºã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;APTæ˜¯åœ¨ç¼–è¯‘æœŸï¼Œé€šè¿‡æ³¨è§£ç”Ÿæˆ&lt;code&gt;java&lt;/code&gt;æ–‡ä»¶ï¼Œç„¶å.javaæ–‡ä»¶ä»ç„¶éœ€è¦è¿›ä¸€æ­¥ç¼–è¯‘ç”Ÿæˆ&lt;code&gt;.class&lt;/code&gt;æ–‡ä»¶&lt;/li&gt;
&lt;li&gt;AOPæ˜¯åœ¨ç¼–è¯‘å®Œæˆåç›´æ¥é€šè¿‡ä¿®æ”¹&lt;code&gt;.class&lt;/code&gt;æ–‡ä»¶ï¼Œæ·»åŠ æˆ–è€…ä¿®æ”¹ä»£ç é€»è¾‘&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;refer&#34;&gt;Refer&lt;a title=&#34;#refer&#34; href=&#34;#refer&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://mp.weixin.qq.com/s?__biz=MzUxODg0MzU2OQ==&amp;amp;mid=2247483887&amp;amp;idx=1&amp;amp;sn=d54e3f210a4f31f477dba06c3dcd352e&amp;amp;scene=21#wechat_redirect&#34; target=&#34;_blank&#34;&gt;AOPæŠ€æœ¯åœ¨å®¢æˆ·ç«¯çš„åº”ç”¨ä¸å®è·µ&lt;/a&gt;&lt;/p&gt;
</content>
        <category term="AOP" />
        <updated>2022-03-10T09:26:27.000Z</updated>
    </entry>
</feed>
