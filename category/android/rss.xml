<?xml version="1.0"?>
<rss version="2.0">
    <channel>
        <title>Stay hungry , Stay foolish â€¢ Posts by &#34;android&#34; category</title>
        <link>https://onion99.github.io</link>
        <description>å·´æ‹‰å·´æ‹‰</description>
        <language>zh-Hans</language>
        <pubDate>Sun, 13 Mar 2022 17:49:49 +0800</pubDate>
        <lastBuildDate>Sun, 13 Mar 2022 17:49:49 +0800</lastBuildDate>
        <category>æºç è§£æ</category>
        <category>AOP</category>
        <category>æ€§èƒ½ä¼˜åŒ–</category>
        <category>å¹¶å‘</category>
        <category>å›¾å½¢ç»˜åˆ¶</category>
        <category>è®¡ç®—æœºåŸºç¡€</category>
        <category>å®‰å…¨</category>
        <category>ç½‘ç»œ</category>
        <category>ç†è®ºå­¦ä¹ </category>
        <category>é»‘ç§‘æŠ€</category>
        <item>
            <guid isPermalink="true">https://onion99.github.io/2022/03/13/XJTlmsU39F0XEnje/</guid>
            <title>Android - å¤šæ¸ é“æ‰“åŒ…</title>
            <link>https://onion99.github.io/2022/03/13/XJTlmsU39F0XEnje/</link>
            <pubDate>Sun, 13 Mar 2022 17:49:49 +0800</pubDate>
            <description><![CDATA[ &lt;blockquote&gt;
&lt;p&gt;æœ¬è´¨å°±æ˜¯ç»™APKæ·»åŠ ç‰¹å®šçš„æ ‡ç­¾ä¿¡æ¯&lt;/p&gt;
&lt;/blockquote&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;h3 id=&#34;æ™®é€šå¤šæ¸ é“æ‰“åŒ…æ–¹æ¡ˆ&#34;&gt;æ™®é€šå¤šæ¸ é“æ‰“åŒ…æ–¹æ¡ˆ&lt;a title=&#34;#æ™®é€šå¤šæ¸ é“æ‰“åŒ…æ–¹æ¡ˆ&#34; href=&#34;#æ™®é€šå¤šæ¸ é“æ‰“åŒ…æ–¹æ¡ˆ&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;h4 id=&#34;android-gradle-plugin&#34;&gt;Android Gradle Plugin&lt;a title=&#34;#android-gradle-plugin&#34; href=&#34;#android-gradle-plugin&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;é¦–å…ˆï¼Œåœ¨AndroidManifest.xmlä¸­æ·»åŠ æ¸ é“ä¿¡æ¯å ä½ç¬¦ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight xml&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;meta-data&lt;/span&gt; &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&lt;span class=&#34;attr&#34;&gt;android:name&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;InstallChannel&amp;quot;&lt;/span&gt; &lt;span class=&#34;attr&#34;&gt;android:value&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;$&amp;#123;InstallChannel&amp;#125;&amp;quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;é€šè¿‡Gradle Pluginæä¾›çš„&lt;code&gt;productFlavors&lt;/code&gt;æ ‡ç­¾ï¼Œæ·»åŠ æ¸ é“ä¿¡æ¯ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight groovy&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;productFlavors&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;string&#34;&gt;&amp;quot;YingYongBao&amp;quot;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        manifestPlaceholders = [&lt;span class=&#34;attr&#34;&gt;InstallChannel :&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;YingYongBao&amp;quot;&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;string&#34;&gt;&amp;quot;360&amp;quot;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        manifestPlaceholders = [&lt;span class=&#34;attr&#34;&gt;InstallChannel :&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;360&amp;quot;&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;apktool&#34;&gt;ApkTool&lt;a title=&#34;#apktool&#34; href=&#34;#apktool&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;ApkToolæ˜¯ä¸€ä¸ªé€†å‘åˆ†æå·¥å…·ï¼Œå¯ä»¥æŠŠAPKè§£å¼€ï¼Œæ·»åŠ ä»£ç åï¼Œé‡æ–°æ‰“åŒ…æˆAPK&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;å¤åˆ¶ä¸€ä»½æ–°çš„APK&lt;/li&gt;
&lt;li&gt;é€šè¿‡ApkToolå·¥å…·ï¼Œè§£å‹APKï¼ˆapktool d origin.apkï¼‰&lt;/li&gt;
&lt;li&gt;åˆ é™¤å·²æœ‰ç­¾åä¿¡æ¯&lt;/li&gt;
&lt;li&gt;æ·»åŠ æ¸ é“ä¿¡æ¯ï¼ˆå¯ä»¥åœ¨APKçš„ä»»ä½•æ–‡ä»¶æ·»åŠ æ¸ é“ä¿¡æ¯ï¼‰&lt;/li&gt;
&lt;li&gt;é€šè¿‡ApkToolå·¥å…·ï¼Œé‡æ–°æ‰“åŒ…ç”Ÿæˆæ–°APKï¼ˆapktool b newApkDirï¼‰&lt;/li&gt;
&lt;li&gt;é‡æ–°ç­¾å&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href=&#34;https://ibotpeaches.github.io/Apktool/&#34; target=&#34;_blank&#34;&gt;Apktool - A tool for reverse engineering 3rd party, closed, binary Android apps&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;æ·»åŠ commentså¤šæ¸ é“æ‰“åŒ…&#34;&gt;æ·»åŠ commentså¤šæ¸ é“æ‰“åŒ…&lt;a title=&#34;#æ·»åŠ commentså¤šæ¸ é“æ‰“åŒ…&#34; href=&#34;#æ·»åŠ commentså¤šæ¸ é“æ‰“åŒ…&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;åˆ©ç”¨çš„æ˜¯Zipæ–‡ä»¶â€œå¯ä»¥æ·»åŠ commentï¼ˆæ‘˜è¦ï¼‰â€çš„æ•°æ®ç»“æ„ç‰¹ç‚¹ï¼Œåœ¨æ–‡ä»¶çš„æœ«å°¾å†™å…¥ä»»æ„æ•°æ®ï¼Œè€Œä¸ç”¨é‡æ–°è§£å‹zipæ–‡ä»¶ï¼ˆapkæ–‡ä»¶å°±æ˜¯zipæ–‡ä»¶æ ¼å¼ï¼‰&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¼€æºå®ç°:&lt;a href=&#34;https://github.com/seven456/MultiChannelPackageTool&#34; target=&#34;_blank&#34;&gt;seven456/MultiChannelPackageTool: Android Multi channel package tool ï¼ˆå®‰å“å¤šæ¸ é“æ‰“åŒ…å·¥å…·ï¼‰&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä½†ç”±äºAndroid7.0ä¹‹åæ–°å¢äº†V2ç­¾åï¼Œè¯¥ç­¾åä¼šæ ¡éªŒæ•´ä¸ªAPKçš„æ•°æ®æ‘˜è¦ï¼Œå¯¼è‡´ä¸Šè¿°æ¸ é“æ‰“åŒ…æ–¹æ¡ˆå¤±æ•ˆã€‚æ‰€ä»¥å¦‚æœæƒ³ç»§ç»­ä½¿ç”¨ä¸Šè¿°æ–¹æ¡ˆï¼Œéœ€è¦å…³é—­Gradle Pluginä¸­çš„V2ç­¾åé€‰é¡¹ï¼Œç¦ç”¨V2ç­¾åã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç¾å›¢çš„androidå¤šæ¸ é“æ‰“åŒ…&#34;&gt;ç¾å›¢çš„Androidå¤šæ¸ é“æ‰“åŒ…&lt;a title=&#34;#ç¾å›¢çš„androidå¤šæ¸ é“æ‰“åŒ…&#34; href=&#34;#ç¾å›¢çš„androidå¤šæ¸ é“æ‰“åŒ…&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;é€šè¿‡å¯æ‰©å±•çš„APK Signature Scheme v2 Block,æ·»åŠ æ¸ é“ä¿¡æ¯&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¼€æºå®ç°: &lt;a href=&#34;https://github.com/Meituan-Dianping/walle&#34; target=&#34;_blank&#34;&gt;Meituan-Dianping/walle: Android Signature V2 Schemeç­¾åä¸‹çš„æ–°ä¸€ä»£æ¸ é“åŒ…æ‰“åŒ…ç¥å™¨&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;åŸç†:&lt;a href=&#34;https://tech.meituan.com/2017/01/13/android-apk-v2-signature-scheme.html&#34; target=&#34;_blank&#34;&gt;æ–°ä¸€ä»£å¼€æºAndroidæ¸ é“åŒ…ç”Ÿæˆå·¥å…·Walle - ç¾å›¢æŠ€æœ¯å›¢é˜Ÿ (meituan.com)&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;è±Œè±†èšandroidå¤šæ¸ é“æ‰“åŒ…&#34;&gt;è±Œè±†èšAndroidå¤šæ¸ é“æ‰“åŒ…&lt;a title=&#34;#è±Œè±†èšandroidå¤šæ¸ é“æ‰“åŒ…&#34; href=&#34;#è±Œè±†èšandroidå¤šæ¸ é“æ‰“åŒ…&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;æŠŠä¸€ä¸ªAndroidåº”ç”¨åŒ…å½“ä½œzipæ–‡ä»¶åŒ…è¿›è¡Œè§£å‹ï¼Œç„¶åå‘ç°åœ¨ç­¾åç”Ÿæˆçš„ç›®å½•ä¸‹æ·»åŠ ä¸€ä¸ªç©ºæ–‡ä»¶ä¸éœ€è¦é‡æ–°ç­¾åã€‚åˆ©ç”¨è¿™ä¸ªæœºåˆ¶ï¼Œè¯¥æ–‡ä»¶çš„æ–‡ä»¶åå°±æ˜¯æ¸ é“åã€‚ä½†ç”±äºv2ç­¾åçš„æ ¡éªŒæœºåˆ¶,æ·»åŠ äº†ä¸€ä¸ªéç©ºæ–‡ä»¶å°±ä¼šç ´åç­¾åæ ¡éªŒï¼Œéœ€è¦é‡æ–°ç­¾åã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;!--more--&gt;
&lt;p&gt;æå‰æ„å»ºä¸€ä¸ªæ²¡æœ‰æ¸ é“çš„APKï¼Œè¾“å…¥åŸå§‹APKæ–‡ä»¶å’Œæ¸ é“å·ï¼Œäº§å‡ºåŒ…å«æ¸ é“å·æ ‡è®°çš„APK.&lt;/p&gt;
&lt;p&gt;1.ä½¿ç”¨AAPTæ·»åŠ æ¸ é“æ–‡ä»¶ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;aapt add base.apk asserts/channel.txt&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;2.ä½¿ç”¨zipalignå·¥å…·å°†APKè¿›è¡Œå­—èŠ‚å¯¹é½&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;zipalign -f 4 base.apk  app_zipalign.apk&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;3.ä½¿ç”¨apksignerå¯¹apké‡æ–°ç­¾å&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;java -jar apksigner sign --v1-signer-name CERT -ks $&amp;#123;mStore&amp;#125; --ks-key-alias $&amp;#123;mAlias&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;apkæ‰“åŒ…æµç¨‹&#34;&gt;APKæ‰“åŒ…æµç¨‹&lt;a title=&#34;#apkæ‰“åŒ…æµç¨‹&#34; href=&#34;#apkæ‰“åŒ…æµç¨‹&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://s1.ax1x.com/2022/03/09/bWKCWV.png&#34; alt=&#34;bWKCWV.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ‰“åŒ…èµ„æºæ–‡ä»¶ï¼Œç”Ÿæˆ R.java æ–‡ä»¶
&lt;ul&gt;
&lt;li&gt;aapt å·¥å…·ï¼ˆaapt.exeï¼‰ -&amp;gt; AndroidManifest.xml å’Œ å¸ƒå±€æ–‡ä»¶ XMl éƒ½ä¼šç¼–è¯‘ -&amp;gt; R.java -&amp;gt; AndroidManifest.xml ä¼šè¢« aapt ç¼–è¯‘æˆäºŒè¿›åˆ¶&lt;/li&gt;
&lt;li&gt;res ç›®å½•ä¸‹èµ„æº -&amp;gt; ç¼–è¯‘ï¼Œå˜æˆäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œç”Ÿæˆ resource id -&amp;gt; æœ€åç”Ÿæˆ resouce.arscï¼ˆæ–‡ä»¶ç´¢å¼•è¡¨ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å¤„ç† aidl æ–‡ä»¶ï¼Œç”Ÿæˆç›¸åº”çš„ Java æ–‡ä»¶
&lt;ul&gt;
&lt;li&gt;aidl å·¥å…·ï¼ˆaidl.exeï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç¼–è¯‘é¡¹ç›®æºä»£ç ï¼Œç”Ÿæˆ class æ–‡ä»¶&lt;/li&gt;
&lt;li&gt;è½¬æ¢æ‰€æœ‰ class æ–‡ä»¶ï¼Œç”Ÿæˆ classes.dex æ–‡ä»¶
&lt;ul&gt;
&lt;li&gt;dx.bat&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ‰“åŒ…ç”Ÿæˆ APK æ–‡ä»¶
&lt;ul&gt;
&lt;li&gt;apkbuilder å·¥å…·æ‰“åŒ…åˆ°æœ€ç»ˆçš„ .apk æ–‡ä»¶ä¸­&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å¯¹APKæ–‡ä»¶è¿›è¡Œç­¾å&lt;/li&gt;
&lt;li&gt;å¯¹ç­¾ååçš„ APK æ–‡ä»¶è¿›è¡Œå¯¹é½å¤„ç†ï¼ˆæ­£å¼åŒ…ï¼‰&lt;/li&gt;
&lt;li&gt;å¯¹ APK è¿›è¡Œå¯¹é½å¤„ç†ï¼Œç”¨åˆ°çš„å·¥å…·æ˜¯ zipalign&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;apk-ç­¾å&#34;&gt;APK ç­¾å&lt;a title=&#34;#apk-ç­¾å&#34; href=&#34;#apk-ç­¾å&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;äº†è§£ HTTPS é€šä¿¡çš„åŒå­¦éƒ½çŸ¥é“ï¼Œåœ¨æ¶ˆæ¯é€šä¿¡æ—¶ï¼Œå¿…é¡»è‡³å°‘è§£å†³ä¸¤ä¸ªé—®é¢˜ï¼šä¸€æ˜¯ç¡®ä¿æ¶ˆæ¯æ¥æºçš„çœŸå®æ€§ï¼ŒäºŒæ˜¯ç¡®ä¿æ¶ˆæ¯ä¸ä¼šè¢«ç¬¬ä¸‰æ–¹ç¯¡æ”¹ã€‚&lt;br&gt;
åŒç†ï¼Œåœ¨å®‰è£… apk æ—¶ï¼ŒåŒæ ·ä¹Ÿéœ€è¦ç¡®ä¿ apk æ¥æºçš„çœŸå®æ€§ï¼Œä»¥åŠ apk æ²¡æœ‰è¢«ç¬¬ä¸‰æ–¹ç¯¡æ”¹&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç­¾åæœºåˆ¶ä¸»è¦æœ‰ä¸¤ç§ç”¨é€”ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨ç‰¹æ®Šçš„ key ç­¾åå¯ä»¥è·å–åˆ°ä¸€äº›ä¸åŒçš„æƒé™&lt;/li&gt;
&lt;li&gt;éªŒè¯æ•°æ®ä¿è¯ä¸è¢«ç¯¡æ”¹ï¼Œé˜²æ­¢åº”ç”¨è¢«æ¶æ„çš„ç¬¬ä¸‰æ–¹è¦†ç›–&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç­¾åå·¥å…·&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;jarsignerï¼šjdk è‡ªå¸¦çš„ç­¾åå·¥å…·ï¼Œå¯¹ jar è¿›è¡Œç­¾åã€‚ä½¿ç”¨ keystore æ–‡ä»¶è¿›è¡Œç­¾åï¼Œç”Ÿæˆçš„ç­¾åæ–‡ä»¶é»˜è®¤ä½¿ç”¨ keystore çš„åˆ«åå‘½åã€‚&lt;/li&gt;
&lt;li&gt;apksignerï¼šAndroid sdk æä¾›çš„ä¸“é—¨ç”¨äº Android åº”ç”¨çš„ç­¾åå·¥å…·ã€‚ä½¿ç”¨ pk8ã€x509.pem æ–‡ä»¶è¿›è¡Œç­¾åã€‚ pk8 æ˜¯ç§é’¥æ–‡ä»¶ï¼Œx509.pem æ˜¯å«æœ‰å…¬é’¥çš„æ–‡ä»¶ã€‚ç”Ÿæˆçš„ç­¾åæ–‡ä»¶ç»Ÿä¸€ä½¿ç”¨â€œCERTâ€å‘½åã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;v1-ç­¾å&#34;&gt;V1 ç­¾å&lt;a title=&#34;#v1-ç­¾å&#34; href=&#34;#v1-ç­¾å&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;åŸºäº JAR ç­¾å&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h5 id=&#34;ç­¾å&#34;&gt;ç­¾å&lt;a title=&#34;#ç­¾å&#34; href=&#34;#ç­¾å&#34;&gt;&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;&lt;img src=&#34;https://s1.ax1x.com/2022/03/09/bWMbDg.png&#34; alt=&#34;bWMbDg.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;h5 id=&#34;æ ¡éªŒ&#34;&gt;æ ¡éªŒ&lt;a title=&#34;#æ ¡éªŒ&#34; href=&#34;#æ ¡éªŒ&#34;&gt;&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;&lt;img src=&#34;https://s1.ax1x.com/2022/03/09/bWQS2V.png&#34; alt=&#34;bWQS2V.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ£€æŸ¥ APK ä¸­åŒ…å«çš„æ‰€æœ‰æ–‡ä»¶ï¼Œå¯¹åº”çš„æ‘˜è¦å€¼ä¸ MANIFEST.MF æ–‡ä»¶ä¸­è®°å½•çš„å€¼ä¸€è‡´ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨è¯ä¹¦æ–‡ä»¶ï¼ˆRSA æ–‡ä»¶ï¼‰æ£€éªŒç­¾åæ–‡ä»¶ï¼ˆSF æ–‡ä»¶ï¼‰æ²¡æœ‰è¢«ä¿®æ”¹è¿‡ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ç­¾åæ–‡ä»¶ï¼ˆSF æ–‡ä»¶ï¼‰æ£€éªŒ MF æ–‡ä»¶æ²¡æœ‰è¢«ä¿®æ”¹è¿‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h5 id=&#34;v1-å¼Šç«¯&#34;&gt;v1 å¼Šç«¯&lt;a title=&#34;#v1-å¼Šç«¯&#34; href=&#34;#v1-å¼Šç«¯&#34;&gt;&lt;/a&gt;&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;ç­¾åæ£€éªŒé€Ÿåº¦æ…¢ï¼šå¯¹æ‰€æœ‰æ–‡ä»¶è¿›è¡Œæ‘˜è¦ç»©ï¼Œå¦‚æœ Android æœºå™¨å·®ï¼Œå®‰è£…é€Ÿåº¦æ…¢ã€‚&lt;/li&gt;
&lt;li&gt;å®Œæ•´æ€§ä¿éšœä¸å¤Ÿï¼šMETA-INF ç›®å½•ç”¨æ¥å­˜æ”¾ç­¾åï¼Œä½†å¯ä»¥éšæ„æ·»åŠ æ–‡ä»¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;v2-ç­¾å&#34;&gt;v2 ç­¾å&lt;a title=&#34;#v2-ç­¾å&#34; href=&#34;#v2-ç­¾å&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸€ç§å…¨æ–‡ä»¶ç­¾åæ–¹æ¡ˆï¼Œèƒ½å¤Ÿå‘ç°å¯¹ APK çš„å—ä¿æŠ¤éƒ¨åˆ†è¿›è¡Œçš„æ‰€æœ‰æ›´æ”¹ï¼Œä»è€Œæœ‰åŠ©äºåŠ å¿«éªŒè¯é€Ÿåº¦å¹¶å¢å¼ºå®Œæ•´æ€§ä¿è¯ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;éªŒè¯å½’æ¡£ä¸­çš„æ‰€æœ‰å­—èŠ‚ï¼Œè€Œä¸æ˜¯å•ä¸ª ZIP æ¡ç›®ï¼Œå› æ­¤ï¼Œåœ¨ç­¾ç½²åæ— æ³•å†è¿è¡Œ ZIPalignï¼ˆå¿…é¡»åœ¨ç­¾åä¹‹å‰æ‰§è¡Œï¼‰&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;v2 ä¼šåœ¨åŸå…ˆ APK å—ä¸­å¢åŠ äº†ä¸€ä¸ªSigning Blockï¼ˆç­¾åå—ï¼‰ï¼Œæ–°çš„å—å­˜å‚¨äº†ç­¾åã€æ‘˜è¦ã€ç­¾åç®—æ³•ã€è¯ä¹¦é“¾å’Œé¢å¤–å±æ€§ç­‰ä¿¡æ¯ã€‚æœ€ç»ˆçš„ç­¾åAPKæœ‰å››å—ï¼šå¤´æ–‡ä»¶åŒºã€V2ç­¾åå—ã€ä¸­å¤®ç›®å½•ã€å°¾éƒ¨ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å„ç‰ˆæœ¬ç­¾åç»„æˆ:&lt;br&gt;
&lt;img src=&#34;https://s1.ax1x.com/2022/03/09/bWl9JI.png&#34; alt=&#34;bWl9JI.png&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;v3-ç­¾å&#34;&gt;v3 ç­¾å&lt;a title=&#34;#v3-ç­¾å&#34; href=&#34;#v3-ç­¾å&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;åœ¨v2çš„åŸºç¡€ä¸ŠåŠ å…¥äº†è¯ä¹¦çš„æ—‹è½¬æ ¡éªŒï¼Œå³å¯ä»¥åœ¨ä¸€æ¬¡çš„å‡çº§å®‰è£…ä¸­ä½¿ç”¨æ–°çš„è¯ä¹¦ï¼Œæ–°çš„ç§é’¥æ¥ç­¾åAPKã€‚å½“ç„¶è¿™ä¸ªæ–°çš„è¯ä¹¦æ˜¯éœ€è¦è€è¯ä¹¦æ¥ä¿è¯çš„ï¼Œç±»ä¼¼ä¸€ä¸ªè¯ä¹¦é“¾ã€‚&lt;/p&gt;
&lt;h4 id=&#34;ç­¾åç‰ˆæœ¬åŒºåˆ«&#34;&gt;ç­¾åç‰ˆæœ¬åŒºåˆ«&lt;a title=&#34;#ç­¾åç‰ˆæœ¬åŒºåˆ«&#34; href=&#34;#ç­¾åç‰ˆæœ¬åŒºåˆ«&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;div class=&#34;Ï†bq&#34;&gt;&lt;div class=&#34;Ï†bs&#34;&gt;&lt;table&gt;&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;ç‰ˆæœ¬&lt;/th&gt;
&lt;th&gt;ç®€ä»‹&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;v1&lt;/td&gt;
&lt;td&gt;åŸºäºJAR ç­¾å,ç­¾åä»¥æ–‡ä»¶çš„å½¢å¼å­˜åœ¨äºapkåŒ…ä¸­ï¼Œè¿™ä¸ªç‰ˆæœ¬çš„apkåŒ…å°±æ˜¯ä¸€ä¸ªæ ‡å‡†çš„zipåŒ…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;v2&lt;/td&gt;
&lt;td&gt;åœ¨ Android 7.0 å¼•å…¥,ç­¾åä¿¡æ¯è¢«å¡åˆ°äº†apkæ–‡ä»¶æœ¬èº«ä¸­ï¼Œè¿™æ—¶apkå·²ç»ä¸ç¬¦åˆä¸€ä¸ªæ ‡å‡†çš„zipå‹ç¼©åŒ…çš„æ–‡ä»¶ç»“æ„&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;v3&lt;/td&gt;
&lt;td&gt;åœ¨ Android 9.0 å¼•å…¥,æ·»åŠ äº†ä¸€ç§æ›´æ–°è¯ä¹¦çš„æ–¹å¼ï¼Œè¿™éƒ¨åˆ†æ›´æ–°è¯ä¹¦çš„æ•°æ®åŒæ ·è¢«æ”¾åœ¨äº†ç­¾åä¿¡æ¯ä¸­&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;&lt;/div&gt;&lt;/div&gt;&lt;h3 id=&#34;refer&#34;&gt;Refer&lt;a title=&#34;#refer&#34; href=&#34;#refer&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.jianshu.com/p/5baea0e1cd1e&#34; target=&#34;_blank&#34;&gt;Androidå¤šæ¸ é“æ‰“åŒ…ï¼ˆVasDollyå®ç°åŸç†ï¼‰ - ç®€ä¹¦ (jianshu.com)&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://www.jb51.net/article/174939.htm&#34; target=&#34;_blank&#34;&gt;è¯¦è§£Android v1ã€v2ã€v3ç­¾å(å°ç»“ï¼‰_&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://blog.csdn.net/bobby_fu/article/details/103843038&#34; target=&#34;_blank&#34;&gt;Android P v3ç­¾åæ–°ç‰¹æ€§&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://github.com/yoyiyi/SoleilNotes/blob/master/Android/v1%E3%80%81v2%E3%80%81v3%E7%AD%BE%E5%90%8D%E5%8C%BA%E5%88%AB.md&#34; target=&#34;_blank&#34;&gt;SoleilNotes/v1ã€v2ã€v3ç­¾ååŒºåˆ«&lt;/a&gt;&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://onion99.github.io/2022/03/12/Kt2Wobik8Fv12ZRY/</guid>
            <title>Android AOP - ASM+Transform</title>
            <link>https://onion99.github.io/2022/03/12/Kt2Wobik8Fv12ZRY/</link>
            <category>AOP</category>
            <pubDate>Sat, 12 Mar 2022 17:45:36 +0800</pubDate>
            <description><![CDATA[ &lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;p&gt;&lt;img src=&#34;https://s1.ax1x.com/2022/03/10/bhoW8O.png&#34; alt=&#34;bhoW8O.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;transform&#34;&gt;Transform&lt;a title=&#34;#transform&#34; href=&#34;#transform&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;Android Gradle Plugin ä» 1.5.0 å¼€å§‹æ”¯æŒ Transform APIï¼Œä»¥å…è®¸ç¬¬ä¸‰æ–¹æ’ä»¶åœ¨ç»è¿‡ç¼–è¯‘çš„ .class æ–‡ä»¶è½¬æ¢ä¸º .dex æ–‡ä»¶ä¹‹å‰å¯¹å…¶è¿›è¡Œæ“çºµã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ™®é€šç¼–è¯‘è¿‡ç¨‹ï¼š&lt;br&gt;
&lt;img src=&#34;https://s1.ax1x.com/2022/03/11/bINI8f.png&#34; alt=&#34;bINI8f.png&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
å¯ä»¥çœ‹åˆ°Android æ„å»ºæµç¨‹æ˜¯ä¸€å¥—æµæ°´çº¿çš„å·¥ä½œæœºåˆ¶ï¼Œæ¯ä¸€ä¸ªçš„æ„å»ºå•å…ƒæ¥æ”¶ä¸Šä¸€ä¸ªæ„å»ºå•å…ƒçš„è¾“å‡ºï¼Œä½œä¸ºè¾“å…¥ï¼Œå†å°†äº§å“è¿›è¡Œè¾“å‡ºï¼Œ&lt;code&gt;com.android.build&lt;/code&gt;åº“æä¾›äº†&lt;code&gt;Transform&lt;/code&gt;çš„æœºåˆ¶ï¼Œè€Œè¿™ä¸ªæœºåˆ¶æ˜¯Android æ„å»ºç³»ç»Ÿä¸ºäº†ç»™å¤–éƒ¨æä¾›ä¸€ä¸ªå¯ä»¥åŠ å…¥è‡ªå®šä¹‰æ„å»ºå•å…ƒï¼Œå¦‚æ‹¦æˆªæŸä¸ªæ„å»ºå•å…ƒçš„è¾“å‡ºï¼Œæˆ–è€…åŠ å…¥ä¸€äº›è¾“å‡ºç­‰ã€‚è€Œè¿™äº›Transformæ˜¯åœ¨javaæºç ç¼–è¯‘å®Œæˆä¹‹åï¼Œpackageä¹‹å‰è¿›è¡Œçš„ã€‚&lt;br&gt;
&lt;img src=&#34;https://s1.ax1x.com/2022/03/11/bIZBy8.md.png&#34; alt=&#34;bIZBy8.md.png&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;åœ¨Android Gradleæ„å»ºç³»ç»Ÿä¸­ï¼Œå¯ä»¥é€šè¿‡&lt;code&gt;AppExtension &lt;/code&gt;å°†&lt;code&gt;transform&lt;/code&gt;æ³¨å†Œåˆ°æ„å»ºç³»ç»Ÿä¸­:&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;CustomPlugin&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;implements&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;Plugin&lt;/span&gt;&amp;lt;&lt;span class=&#34;title&#34;&gt;Project&lt;/span&gt;&amp;gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;apply&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(Project project)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        AppExtension appExtension = (AppExtension)project.getProperties().get(&lt;span class=&#34;string&#34;&gt;&amp;quot;android&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// ç»™Appç¼–è¯‘è¿‡ç¨‹æ³¨å†Œtransform&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        appExtension.registerTransform(&lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; CustomTransform(), Collections.EMPTY_LIST);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;asm&#34;&gt;ASM&lt;a title=&#34;#asm&#34; href=&#34;#asm&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&#34;https://asm.ow2.io/&#34; target=&#34;_blank&#34;&gt;ASM&lt;/a&gt;æ˜¯ä¸€ç§é€šç”¨&lt;strong&gt;Javaå­—èŠ‚ç &lt;/strong&gt;æ“ä½œå’Œåˆ†ææ¡†æ¶ã€‚å®ƒå¯ä»¥ç”¨æ¥ä¿®æ”¹ç°æœ‰çš„ç±»ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä»¥äºŒè¿›åˆ¶å½¢å¼åŠ¨æ€ç”Ÿæˆç±»ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&#34;https://s1.ax1x.com/2022/03/11/bI0iSx.png&#34; alt=&#34;bI0iSx.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;p&gt;ASMè®¾è®¡äº†ä¸¤ç§APIç±»å‹è§£ææ–‡ä»¶ç»“æ„ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Tree API&lt;/li&gt;
&lt;li&gt;åŸºäºVisitor API(visitor pattern)ï¼Œ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è®©æˆ‘ä»¬ä»¥ä¸åŒçš„æ–¹å¼å¤„ç†ä¸‹å§ğŸ¤¤ğŸ¤¤ğŸ¤¤&lt;/p&gt;
&lt;h4 id=&#34;tree-api&#34;&gt;Tree API&lt;a title=&#34;#tree-api&#34; href=&#34;#tree-api&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Tree APIå°†classçš„ç»“æ„è¯»å–åˆ°å†…å­˜ï¼Œæ„å»ºä¸€ä¸ªæ ‘å½¢ç»“æ„ï¼Œç„¶åéœ€è¦å¤„ç†Methodã€Fieldç­‰å…ƒç´ æ—¶ï¼Œåˆ°æ ‘å½¢ç»“æ„ä¸­å®šä½åˆ°æŸä¸ªå…ƒç´ ï¼Œè¿›è¡Œæ“ä½œï¼Œç„¶åæŠŠæ“ä½œå†å†™å…¥æ–°çš„classæ–‡ä»¶ã€‚&lt;/p&gt;
&lt;figure class=&#34;highlight kotlin&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;TestPlugin&lt;/span&gt; : &lt;span class=&#34;type&#34;&gt;Plugin&lt;/span&gt;&amp;lt;&lt;span class=&#34;type&#34;&gt;Project&lt;/span&gt;&amp;gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;override&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;apply&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(target: &lt;span class=&#34;type&#34;&gt;Project&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        println(&lt;span class=&#34;string&#34;&gt;&amp;quot;Test Plugin : target = [&lt;span class=&#34;subst&#34;&gt;$&amp;#123;target&amp;#125;&lt;/span&gt;]&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;val&lt;/span&gt; appExtension: AppExtension = target.extensions.getByType()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        appExtension.registerTransform(TestTransform())&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;TestTransform&lt;/span&gt; : &lt;span class=&#34;type&#34;&gt;BaseTransform&lt;/span&gt;&lt;/span&gt;()&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;companion&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;object&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; isPrint = &lt;span class=&#34;literal&#34;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; isChange = &lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;override&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;modifyClass&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(byteArray: &lt;span class=&#34;type&#34;&gt;ByteArray&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;: ByteArray &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;val&lt;/span&gt; classReader = ClassReader(byteArray)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;val&lt;/span&gt; classNode = ClassNode()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// é€šè¿‡ä¼ é€’ ClassReader è§£æå¯¹åº” ClassFile ç”Ÿæˆ ClassNode&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        classReader.accept(classNode, ClassReader.EXPAND_FRAMES)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// æ‰“å°æµ‹è¯•&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(isPrint)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            isPrint = &lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            Log.log(classNode.toString())&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; (methodNode &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; classNode.methods) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                Log.log(&lt;span class=&#34;string&#34;&gt;&amp;quot;&lt;span class=&#34;subst&#34;&gt;$&amp;#123;classNode.name&amp;#125;&lt;/span&gt; ------&amp;gt;&amp;gt;&amp;gt; &lt;span class=&#34;variable&#34;&gt;$methodNode&lt;/span&gt;&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// å¦‚æœæ–‡ä»¶å¯¹classNodeæœ‰ä¿®æ”¹çš„æƒ…å†µä¸‹ï¼Œéœ€è¦è¿™æ ·å¤„ç†&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(isChange)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;val&lt;/span&gt; classWriter = ClassWriter(ClassWriter.COMPUTE_MAXS)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            classNode.accept(classWriter)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; classWriter.toByteArray()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// è¿”å›ä¿®æ”¹å†…å®¹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; byteArray&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;override&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;getInputTypes&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;: MutableSet&amp;lt;QualifiedContent.ContentType&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; TransformManager.CONTENT_CLASS&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;override&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;getScopes&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;: MutableSet&amp;lt;&lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; QualifiedContent.Scope&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; mutableSetOf(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            QualifiedContent.Scope.PROJECT&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        )&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°ç¼–è¯‘çš„ç±»æ­£è¢«æˆ‘ä»¬æ‰“å°å‡ºæ¥ï¼š&lt;br&gt;
&lt;img src=&#34;https://s1.ax1x.com/2022/03/11/bIq3id.png&#34; alt=&#34;bIq3id.png&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;visitor-api&#34;&gt;Visitor API&lt;a title=&#34;#visitor-api&#34; href=&#34;#visitor-api&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Visitor APIåˆ™å°†é€šè¿‡æ¥å£çš„æ–¹å¼ï¼Œåˆ†ç¦»è¯»classå’Œå†™classçš„é€»è¾‘ï¼Œä¸€èˆ¬é€šè¿‡ä¸€ä¸ªClassReaderè´Ÿè´£è¯»å–classå­—èŠ‚ç ï¼Œç„¶åClassReaderé€šè¿‡ä¸€ä¸ªClassVisitoræ¥å£ï¼Œå°†å­—èŠ‚ç çš„æ¯ä¸ªç»†èŠ‚æŒ‰é¡ºåºé€šè¿‡æ¥å£çš„æ–¹å¼ï¼Œä¼ é€’ç»™ClassVisitorï¼ˆä½ ä¼šå‘ç°ClassVisitorä¸­æœ‰å¤šä¸ªvisitXXXXæ¥å£ï¼‰ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±åƒClassReaderå¸¦ç€ClassVisitoræ¸¸è§ˆäº†classå­—èŠ‚ç çš„æ¯ä¸€ä¸ªæŒ‡ä»¤ã€‚&lt;/p&gt;
&lt;figure class=&#34;highlight kotlin&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;TestPlugin&lt;/span&gt; : &lt;span class=&#34;type&#34;&gt;Plugin&lt;/span&gt;&amp;lt;&lt;span class=&#34;type&#34;&gt;Project&lt;/span&gt;&amp;gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;override&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;apply&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(target: &lt;span class=&#34;type&#34;&gt;Project&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        println(&lt;span class=&#34;string&#34;&gt;&amp;quot;Test Plugin : target = [&lt;span class=&#34;subst&#34;&gt;$&amp;#123;target&amp;#125;&lt;/span&gt;]&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;val&lt;/span&gt; appExtension: AppExtension = target.extensions.getByType()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        appExtension.registerTransform(TestVisitorTransform())&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;TestClassVisitor&lt;/span&gt;&lt;/span&gt;(visitor: ClassVisitor):ClassVisitor(Opcodes.ASM4,visitor)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;TestVisitorTransform&lt;/span&gt; : &lt;span class=&#34;type&#34;&gt;BaseTransform&lt;/span&gt;&lt;/span&gt;()&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;companion&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;object&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; isPrint = &lt;span class=&#34;literal&#34;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; isChange = &lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;override&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;modifyClass&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(byteArray: &lt;span class=&#34;type&#34;&gt;ByteArray&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;: ByteArray &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// è§£æclassæ–‡ä»¶&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;val&lt;/span&gt; classReader = ClassReader(byteArray)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// å°†classæ–‡ä»¶å†…å®¹å†™å…¥åˆ°ClassWriterä¸­&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;val&lt;/span&gt; classWriter = ClassWriter(classReader,ClassWriter.COMPUTE_MAXS)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// èµ‹äºˆå¯¹åº”çš„ClassVisitorè¯»å†™èƒ½åŠ›&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;val&lt;/span&gt; classVisitor = TestClassVisitor(classWriter)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        classReader.accept(classVisitor, ClassReader.EXPAND_FRAMES)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// æ‰“å°æµ‹è¯•&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(isPrint)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            isPrint = &lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            Log.log(classVisitor.toString())&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// å¦‚æœæ–‡ä»¶å¯¹classNodeæœ‰ä¿®æ”¹çš„æƒ…å†µä¸‹ï¼Œéœ€è¦è¿™æ ·å¤„ç†&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(isChange)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; classWriter.toByteArray()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// è¿”å›ä¿®æ”¹å†…å®¹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; byteArray&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;override&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;getInputTypes&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;: MutableSet&amp;lt;QualifiedContent.ContentType&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; TransformManager.CONTENT_CLASS&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;override&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;getScopes&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;: MutableSet&amp;lt;&lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; QualifiedContent.Scope&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; mutableSetOf(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            QualifiedContent.Scope.PROJECT&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        )&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;åŒæ ·å¯ä»¥çœ‹åˆ°ç¼–è¯‘çš„ç±»æ­£è¢«æˆ‘ä»¬æ‰“å°å‡ºæ¥ï¼š&lt;br&gt;
&lt;img src=&#34;https://s1.ax1x.com/2022/03/11/bIvebV.png&#34; alt=&#34;bIvebV.png&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ClassReaderï¼šè´Ÿè´£å¯¹ .class æ–‡ä»¶è¿›è¡Œè¯»å–&lt;/li&gt;
&lt;li&gt;ClassVisitorï¼š è´Ÿè´£è®¿é—® .class æ–‡ä»¶ä¸­å„ä¸ªå…ƒç´ &lt;/li&gt;
&lt;li&gt;ClassWriterï¼š è´Ÿè´£å¯¹ .class æ–‡ä»¶è¿›è¡Œå†™å…¥ï¼Œå°†å­—èŠ‚ç è¾“å‡ºä¸º byte æ•°ç»„ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;å­—èŠ‚ç äº†è§£&#34;&gt;å­—èŠ‚ç äº†è§£&lt;a title=&#34;#å­—èŠ‚ç äº†è§£&#34; href=&#34;#å­—èŠ‚ç äº†è§£&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://plugins.jetbrains.com/plugin/14860-asm-bytecode-viewer-support-kotlin&#34; target=&#34;_blank&#34;&gt;Android Studio è¾…åŠ©ç±»è½¬å­—èŠ‚ç æ’ä»¶ï¼šASM Bytecode Viewer Support Kotlin&lt;/a&gt;&lt;br&gt;
&lt;img src=&#34;https://pic1.zhimg.com/v2-fdd5caeb51dbfb819539611fa9ccbcd4_r.jpg&#34; alt=&#34;preview&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://juejin.cn/post/6944517233674551304#heading-5&#34; target=&#34;_blank&#34;&gt;å­—èŠ‚ç ç»“æ„åˆ†æ - æ˜é‡‘ (juejin.cn)&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://www.jianshu.com/p/92a75a18cbc1&#34; target=&#34;_blank&#34;&gt;Java ByteCode - ç®€ä¹¦ (jianshu.com)&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://zhuanlan.zhihu.com/p/94498015&#34; target=&#34;_blank&#34;&gt;å²ä¸Šæœ€é€šä¿—æ˜“æ‡‚çš„ASMæ•™ç¨‹ - çŸ¥ä¹ (zhihu.com)&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;è‡ªå®šä¹‰gradleæ’ä»¶&#34;&gt;è‡ªå®šä¹‰gradleæ’ä»¶&lt;a title=&#34;#è‡ªå®šä¹‰gradleæ’ä»¶&#34; href=&#34;#è‡ªå®šä¹‰gradleæ’ä»¶&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;Transformå’ŒAsmçš„ç»“åˆä½¿ç”¨éœ€è¦ç”¨åˆ°Gradleæ’ä»¶&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è‡ªå®šä¹‰æ’ä»¶æ–¹å¼ï¼šè¯¦çœ‹&lt;a href=&#34;https://docs.gradle.org/current/userguide/custom_plugins.html#example_a_build_for_a_custom_plugin&#34; target=&#34;_blank&#34;&gt;Developing Custom Gradle Plugins&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Build script&lt;/li&gt;
&lt;li&gt;&lt;code&gt;buildSrc&lt;/code&gt; é¡¹ç›®&lt;/li&gt;
&lt;li&gt;ç‹¬ç«‹é¡¹ç›®ï¼ˆStandalone projectï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;build-script&#34;&gt;Build script&lt;a title=&#34;#build-script&#34; href=&#34;#build-script&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;ç›´æ¥åœ¨é¡¹ç›®çš„build.gradleä¸­æ·»åŠ groovyè„šæœ¬ä»£ç å¹¶å¼•ç”¨ã€‚è¿™æ ·æ’ä»¶åœ¨æ„å»ºè„šæœ¬ä¹‹å¤–ä¸å¯è§ï¼Œåªèƒ½åœ¨æ­¤æ¨¡å—ä¸­ä½¿ç”¨è„šæœ¬æ’ä»¶ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol&gt;
&lt;li&gt;ç®€å•ç¼–å†™è„šæœ¬&lt;br&gt;
build.gradle:&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight groovy&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;GreetingPlugin&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;implements&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;Plugin&lt;/span&gt;&amp;lt;&lt;span class=&#34;title&#34;&gt;Project&lt;/span&gt;&amp;gt; &amp;#123;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; apply(Project project) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        project.task(&lt;span class=&#34;string&#34;&gt;&amp;#x27;hello&amp;#x27;&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            doLast &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                println &lt;span class=&#34;string&#34;&gt;&amp;#x27;Hello from the GreetingPlugin&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// Apply the plugin&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;apply &lt;span class=&#34;attr&#34;&gt;plugin:&lt;/span&gt; GreetingPlugin&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;è·Ÿä¸Šé¢ä¸€æ ·ï¼Œåªä¸è¿‡é‡‡ç”¨æ–°ç‰ˆktsé£æ ¼&lt;br&gt;
build.gradle.kts&lt;/p&gt;
&lt;figure class=&#34;highlight kotlin&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;GreetingPlugin&lt;/span&gt; : &lt;span class=&#34;type&#34;&gt;Plugin&lt;/span&gt;&amp;lt;&lt;span class=&#34;type&#34;&gt;Project&lt;/span&gt;&amp;gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;override&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;apply&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(project: &lt;span class=&#34;type&#34;&gt;Project&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        project.task(&lt;span class=&#34;string&#34;&gt;&amp;quot;hello&amp;quot;&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            doLast &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                println(&lt;span class=&#34;string&#34;&gt;&amp;quot;Hello from the GreetingPlugin&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// Apply the plugin&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;apply&amp;lt;GreetingPlugin&amp;gt;()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;è¿è¡Œ&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&amp;gt; gradle -q hello&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Hello from the GreetingPlugin&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;buildsrc-é¡¹ç›®&#34;&gt;buildSrc é¡¹ç›®&lt;a title=&#34;#buildsrc-é¡¹ç›®&#34; href=&#34;#buildsrc-é¡¹ç›®&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;å°†æ’ä»¶çš„æºä»£ç æ”¾åœ¨rootProjectDir/buildSrc/src/main/groovyç›®å½•ä¸­ï¼ŒGradleå°†è´Ÿè´£ç¼–è¯‘å’Œæµ‹è¯•æ’ä»¶ï¼Œå¹¶ä½¿å…¶åœ¨æ„å»ºè„šæœ¬çš„ç±»è·¯å¾„ä¸­å¯ç”¨ã€‚è¯¥æ’ä»¶æ¯ä¸ªæ„å»ºè„šæœ¬éƒ½æ˜¯å¯è§çš„ã€‚ä½†æ˜¯å®ƒåœ¨æ„å»ºå¤–éƒ¨ä¸å¯è§å³åœ¨å½“å‰å·¥ç¨‹çš„å„ä¸ªæ¨¡å—éƒ½å¯è§ï¼Œä½†æ˜¯é¡¹ç›®ä¹‹å¤–ä¸å¯è§&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;buildSrcæ˜¯androidä¸­ä¸€ä¸ªä¿ç•™åï¼Œæ˜¯ä¸€ä¸ªä¸“é—¨ç”¨æ¥åšgradleæ’ä»¶çš„moduleï¼Œæ‰€ä»¥è¿™ä¸ªmoduleçš„åå­—å¿…é¡»æ˜¯buildSrcï¼Œæ­¤æ¨¡å—ä¸‹é¢æœ‰ä¸€ä¸ªå›ºå®šçš„ç›®å½•ç»“æ„src/main/groovyï¼Œè¿™ä¸ªæ˜¯ç”¨æ¥å­˜æ”¾çœŸæ­£çš„è„šæœ¬æ–‡ä»¶çš„ã€‚å…¶ä»–çš„è‡ªå®šä¹‰ç±»å¯ä»¥æ”¾åœ¨è¿™ä¸ªç›®å½•ä¸‹ï¼Œä¹Ÿå¯ä»¥æ”¾åœ¨è‡ªå»ºçš„å…¶ä»–ç›®å½•ä¸‹ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åˆ›å»º&lt;code&gt;buildSrc&lt;/code&gt;Module,å¯ä»¥ç›´æ¥åˆ›å»ºç›®å½•
&lt;ul&gt;
&lt;li&gt;åœ¨å·¥ç¨‹æ ¹ç›®å½•ä¸‹åˆ›å»ºç›®å½•&lt;code&gt;buildSrc&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;åœ¨buildSrcä¸‹åˆ›å»ºç›®å½•ç»“æ„ &lt;code&gt;src/main/groovy&lt;/code&gt;æˆ–è€…&lt;code&gt;src/main/java&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;åœ¨buildSrcæ ¹ç›®å½•ä¸‹åˆ›å»º&lt;code&gt; build.gradle&lt;/code&gt;æˆ–è€…&lt;code&gt; build.gradle.kts&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;build.gradle.kts:&lt;/p&gt;
&lt;figure class=&#34;highlight kotlin&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; org.jetbrains.kotlin.gradle.tasks.KotlinCompile&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plugins &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    `kotlin-dsl`&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    kotlin(&lt;span class=&#34;string&#34;&gt;&amp;quot;jvm&amp;quot;&lt;/span&gt;) version &lt;span class=&#34;string&#34;&gt;&amp;quot;1.4.32&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;val&lt;/span&gt; compileKotlin: KotlinCompile &lt;span class=&#34;keyword&#34;&gt;by&lt;/span&gt; tasks&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;val&lt;/span&gt; compileTestKotlin: KotlinCompile &lt;span class=&#34;keyword&#34;&gt;by&lt;/span&gt; tasks&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;compileKotlin.kotlinOptions &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    jvmTarget = &lt;span class=&#34;string&#34;&gt;&amp;quot;1.8&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;compileTestKotlin.kotlinOptions &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    jvmTarget = &lt;span class=&#34;string&#34;&gt;&amp;quot;1.8&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;repositories &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    google()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    mavenCentral()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;dependencies &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    implementation(&lt;span class=&#34;string&#34;&gt;&amp;quot;com.android.tools.build:gradle:4.1.1&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    compileOnly(&lt;span class=&#34;string&#34;&gt;&amp;quot;commons-io:commons-io:2.6&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    compileOnly(&lt;span class=&#34;string&#34;&gt;&amp;quot;commons-codec:commons-codec:1.15&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    compileOnly(&lt;span class=&#34;string&#34;&gt;&amp;quot;org.ow2.asm:asm-commons:9.2&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    compileOnly(&lt;span class=&#34;string&#34;&gt;&amp;quot;org.ow2.asm:asm-tree:9.2&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;build.gradle&lt;/p&gt;
&lt;figure class=&#34;highlight groovy&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;apply &lt;span class=&#34;attr&#34;&gt;plugin:&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;#x27;groovy&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;dependencies &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// gradleæ’ä»¶å¿…é¡»çš„å¼•ç”¨&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    implementation gradleApi()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    implementation localGroovy()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    implementation &lt;span class=&#34;string&#34;&gt;&amp;#x27;com.android.tools.build:gradle:4.1.1&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// asmä¾èµ–&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    implementation &lt;span class=&#34;string&#34;&gt;&amp;#x27;org.ow2.asm:asm:9.2&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    implementation &lt;span class=&#34;string&#34;&gt;&amp;#x27;org.ow2.asm:asm-util:9.2&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    implementation &lt;span class=&#34;string&#34;&gt;&amp;#x27;org.ow2.asm:asm-commons:9.2&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;repositories &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    mavenCentral()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    jcenter()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    google()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// æŒ‡å®šç¼–è¯‘çš„ç¼–ç  ä¸ç„¶æœ‰ä¸­æ–‡çš„è¯ä¼šå‡ºç°  â€™ç¼–ç GBKçš„ä¸å¯æ˜ å°„å­—ç¬¦â€˜&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;tasks.withType(JavaCompile) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    options.encoding = &lt;span class=&#34;string&#34;&gt;&amp;quot;UTF-8&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    println(&lt;span class=&#34;string&#34;&gt;&amp;#x27;ä½¿ç”¨utf8ç¼–è¯‘&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;åˆ›å»ºæ’ä»¶å…¥å£TestPlugin&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight kotlin&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;package&lt;/span&gt; com.onion.plugin.plugin&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;TestPlugin&lt;/span&gt;: &lt;span class=&#34;type&#34;&gt;Plugin&lt;/span&gt;&amp;lt;&lt;span class=&#34;type&#34;&gt;Project&lt;/span&gt;&amp;gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;override&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;apply&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(target: &lt;span class=&#34;type&#34;&gt;Project&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        println(&lt;span class=&#34;string&#34;&gt;&amp;quot;Test Plugin : target = [&lt;span class=&#34;subst&#34;&gt;$&amp;#123;target&amp;#125;&lt;/span&gt;]&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;åœ¨App Module ä¸­å¼•å…¥,ç„¶åProject Build&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight groovy&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; com.onion.plugin.plugin.TestPlugin&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;apply &lt;span class=&#34;attr&#34;&gt;plugin:&lt;/span&gt; TestPlugin &lt;span class=&#34;comment&#34;&gt;// æ’æ¡©æµ‹è¯•&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;æ’ä»¶å‘å¸ƒé¢å¤–å­¦ä¹ &#34;&gt;æ’ä»¶å‘å¸ƒé¢å¤–å­¦ä¹ &lt;a title=&#34;#æ’ä»¶å‘å¸ƒé¢å¤–å­¦ä¹ &#34; href=&#34;#æ’ä»¶å‘å¸ƒé¢å¤–å­¦ä¹ &#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://juejin.cn/post/6887581345384497165&#34; title=&#34;https://juejin.cn/post/6887581345384497165&#34; target=&#34;_blank&#34;&gt;Android Gradle æ’ä»¶å¼€å‘å…¥é—¨æŒ‡å—ï¼ˆä¸€ï¼‰&lt;/a&gt;ï¼Œè®²è§£Gradle Pluginå¼€å‘çš„å®Œæ•´æµç¨‹&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://juejin.cn/post/6887583351348133895&#34; title=&#34;https://juejin.cn/post/6887583351348133895&#34; target=&#34;_blank&#34;&gt;Android Gradle æ’ä»¶å¼€å‘å…¥é—¨æŒ‡å—ï¼ˆäºŒï¼‰&lt;/a&gt;ï¼Œé’ˆå¯¹Androidçš„Gradle Pluginå¼€å‘å®è·µ&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://juejin.cn/post/6890544619856068616&#34; title=&#34;https://juejin.cn/post/6890544619856068616&#34; target=&#34;_blank&#34;&gt;Android Gradle æ’ä»¶å¼€å‘å…¥é—¨æŒ‡å—ï¼ˆä¸‰ï¼‰&lt;/a&gt;ï¼Œå¦‚ä½•å°†æ’ä»¶å‘å¸ƒåˆ°jcenter&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;refer&#34;&gt;Refer&lt;a title=&#34;#refer&#34; href=&#34;#refer&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;http://quinnchen.cn/2018/09/13/2018-09-13-asm-transform/&#34; target=&#34;_blank&#34;&gt;ä¸€èµ·ç©è½¬Androidé¡¹ç›®ä¸­çš„å­—èŠ‚ç  | Quinn Note (quinnchen.cn)&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://www.jianshu.com/p/92a75a18cbc1&#34; target=&#34;_blank&#34;&gt;Java ByteCode&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://blog.csdn.net/qq_23992393/article/details/103696976&#34; target=&#34;_blank&#34;&gt;ASM + Transform åœ¨androidä¸­çš„ä½¿ç”¨&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://www.jianshu.com/p/a1e6b3abd789&#34; target=&#34;_blank&#34;&gt;ASM&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://juejin.cn/post/6893917892061413389#heading-3&#34; target=&#34;_blank&#34;&gt;ç™½è¯ Android AOP (ä¸€) &lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://mp.weixin.qq.com/s/YFi6-DrV22X_VVfFbKHNEg&#34; target=&#34;_blank&#34;&gt;Android gradle Transform åˆ†æ&lt;/a&gt;&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://onion99.github.io/2022/03/11/3Bhw0wOwpYCE6F8V/</guid>
            <title>Android AOP - AspectJ</title>
            <link>https://onion99.github.io/2022/03/11/3Bhw0wOwpYCE6F8V/</link>
            <category>AOP</category>
            <pubDate>Fri, 11 Mar 2022 17:40:38 +0800</pubDate>
            <description><![CDATA[ &lt;blockquote&gt;
&lt;p&gt;AspectJé€šè¿‡æ³¨è§£çš„å½¢å¼æ¥æ ‡æ³¨åˆ‡å…¥ç‚¹ã€åˆ‡å…¥å¯¹è±¡ç­‰ï¼Œç„¶ååœ¨ä»£ç ç¼–è¯‘æœŸé—´å°†ä»£ç ç»‡å…¥åˆ°javaçš„å­—èŠ‚ç ä¸­&lt;/p&gt;
&lt;/blockquote&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;p&gt;Androidå¼€æºæ–¹æ¡ˆï¼š&lt;a href=&#34;https://github.com/HujiangTechnology/gradle_plugin_android_aspectjx&#34; target=&#34;_blank&#34;&gt;AspectJX&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;å¼•å…¥ä¾èµ–&#34;&gt;å¼•å…¥ä¾èµ–&lt;a title=&#34;#å¼•å…¥ä¾èµ–&#34; href=&#34;#å¼•å…¥ä¾èµ–&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;gradleå¼•å…¥ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight groovy&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;buildscript &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    dependencies &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        classpath &lt;span class=&#34;string&#34;&gt;&amp;#x27;com.hujiang.aspectjx:gradle-android-plugin-aspectjx:2.0.4&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;åº”ç”¨pluginï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight groovy&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;apply &lt;span class=&#34;attr&#34;&gt;plugin:&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;#x27;android-aspectjx&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;AspectJXé…ç½®ï¼š&lt;/p&gt;
&lt;p&gt;AspectJXé»˜è®¤ä¼šå¤„ç†æ‰€æœ‰çš„äºŒè¿›åˆ¶ä»£ç æ–‡ä»¶å’Œåº“ï¼Œä¸ºäº†æå‡ç¼–è¯‘æ•ˆç‡åŠè§„é¿éƒ¨åˆ†ç¬¬ä¸‰æ–¹åº“å‡ºç°çš„ç¼–è¯‘å…¼å®¹æ€§é—®é¢˜ï¼ŒAspectJXæä¾›&lt;code&gt;include&lt;/code&gt;,&lt;code&gt;exclude&lt;/code&gt;å‘½ä»¤æ¥è¿‡æ»¤éœ€è¦å¤„ç†çš„æ–‡ä»¶åŠæ’é™¤æŸäº›æ–‡ä»¶(åŒ…æ‹¬classæ–‡ä»¶åŠjaræ–‡ä»¶)ã€‚&lt;/p&gt;
&lt;figure class=&#34;highlight groovy&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;aspectjx &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//æ’é™¤æ‰€æœ‰packageè·¯å¾„ä¸­åŒ…å«`android.support`çš„classæ–‡ä»¶åŠåº“ï¼ˆjaræ–‡ä»¶ï¼‰&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	exclude &lt;span class=&#34;string&#34;&gt;&amp;#x27;android.support&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å¼€å…³é…ç½®ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight groovy&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;aspectjx &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//å…³é—­AspectJXåŠŸèƒ½&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	enabled &lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;ç®€å•ä½¿ç”¨&#34;&gt;ç®€å•ä½¿ç”¨&lt;a title=&#34;#ç®€å•ä½¿ç”¨&#34; href=&#34;#ç®€å•ä½¿ç”¨&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;å‡†å¤‡åˆ‡å…¥çš„ç±»&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;Animal&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;fly&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        Log.e(TAG, &lt;span class=&#34;string&#34;&gt;&amp;quot;animal fly method:&amp;quot;&lt;/span&gt; + &lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;.toString() + &lt;span class=&#34;string&#34;&gt;&amp;quot;#fly&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;ç¼–å†™å¯¹åº”çš„åˆ‡é¢ç±»ï¼Œç”¨@Aspectæ³¨è§£&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Aspect&lt;/span&gt;  &lt;span class=&#34;comment&#34;&gt;//â‘ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;MethodAspect&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// æ ‡æ³¨åˆ‡å…¥çš„æ–¹æ³•ï¼Œçœ‹åˆ°æ²¡æœ‰è¿™é‡Œç”¨çš„Poincutçš„ call&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Pointcut(&amp;quot;call(* com.wandering.sample.aspectj.Animal.fly(..))&amp;quot;)&lt;/span&gt;&lt;span class=&#34;comment&#34;&gt;//â‘¡&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;callMethod&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// æ ‡æ³¨å‡½æ•°æ‰§è¡Œå‰å¤„ç†&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Before(&amp;quot;callMethod()&amp;quot;)&lt;/span&gt;&lt;span class=&#34;comment&#34;&gt;//â‘¢&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;beforeMethodCall&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(JoinPoint joinPoint)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        Log.e(TAG, &lt;span class=&#34;string&#34;&gt;&amp;quot;before-&amp;gt;&amp;quot;&lt;/span&gt; + joinPoint.getTarget().toString()); &lt;span class=&#34;comment&#34;&gt;//â‘£&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;ç¼–è¯‘åå°±å¯ä»¥çœ‹åˆ°ç±»çš„æ–¹æ³•åœ¨æ‰§è¡Œå‰æœ‰ä»£ç æ’å…¥äº†&lt;br&gt;
&lt;img src=&#34;https://s1.ax1x.com/2022/03/10/bhAMh8.png&#34; alt=&#34;bhAMh8.png&#34; loading=&#34;lazy&#34;&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;è¯­æ³•&#34;&gt;è¯­æ³•&lt;a title=&#34;#è¯­æ³•&#34; href=&#34;#è¯­æ³•&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;div class=&#34;Ï†bq&#34;&gt;&lt;div class=&#34;Ï†bs&#34;&gt;&lt;table&gt;&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left&#34;&gt;JPoint&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;è¯´æ˜&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;Pointcutè¯­æ³•&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;method call&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å‡½æ•°è°ƒç”¨&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;call(MethodSignature)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;method execution&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å‡½æ•°å†…éƒ¨æ‰§è¡Œ&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;execution(MethodSignatureï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;method execution&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ„é€ å‡½æ•°è°ƒç”¨&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;call(ConstructorSignatureï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;constructor execution&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ„é€ å‡½æ•°å†…éƒ¨æ‰§è¡Œ&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;execution(ConstructorSignatureï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;field get&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;è¯»å˜é‡&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;get(FieldSignatureï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;field set&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å†™å˜é‡&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;set(FieldSignatureï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;static initialization&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;é™æ€ä»£ç å—åˆå§‹åŒ–&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;staticinitialization(TypeSignatureï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;handler&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å¼‚å¸¸å¤„ç†&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;handler(TypeSignature),åªèƒ½ä¸@Before()é…ç½®ä½¿ç”¨&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;&lt;/div&gt;&lt;/div&gt;&lt;br/&gt;
&lt;div class=&#34;Ï†bq&#34;&gt;&lt;div class=&#34;Ï†bs&#34;&gt;&lt;table&gt;&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left&#34;&gt;Advice&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;@Before(Pointcut)&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ‰§è¡ŒJpointä¹‹å‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;@After(Pointcut)&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ‰§è¡ŒJpointä¹‹å&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;@Around(Pointcut)&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ›¿æ¢åŸç†çš„ä»£ç &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;&lt;/div&gt;&lt;/div&gt;&lt;p&gt;å®Œæ•´è¯­æ³•çœ‹è¿™&lt;a href=&#34;https://github.com/hyvenzhu/Android-Demos/blob/master/AspectJDemo/AspectJ.pdf&#34; target=&#34;_blank&#34;&gt;AspectJ&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;æ³¨æ„ç‚¹&#34;&gt;æ³¨æ„ç‚¹&lt;a title=&#34;#æ³¨æ„ç‚¹&#34; href=&#34;#æ³¨æ„ç‚¹&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;æ ‡æ³¨&lt;code&gt;call&lt;/code&gt;å’Œ&lt;code&gt;execution&lt;/code&gt;æ‰§è¡Œçš„æ—¶å€™ï¼ŒThiså’ŒTargetä¸åŒçš„&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Aspect&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;MethodAspect&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Pointcut(&amp;quot;call(* com.wandering.sample.aspectj.Animal.fly(..))&amp;quot;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;callMethod&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        Log.e(TAG, &lt;span class=&#34;string&#34;&gt;&amp;quot;callMethod-&amp;gt;&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Before(&amp;quot;callMethod()&amp;quot;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;beforeMethodCall&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(JoinPoint joinPoint)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        Log.e(TAG, &lt;span class=&#34;string&#34;&gt;&amp;quot;getTarget-&amp;gt;&amp;quot;&lt;/span&gt; + joinPoint.getTarget());&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        Log.e(TAG, &lt;span class=&#34;string&#34;&gt;&amp;quot;getThis-&amp;gt;&amp;quot;&lt;/span&gt; + joinPoint.getThis());&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;åˆ‡å…¥æ–¹ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;protected void onCreate(@Nullable Bundle savedInstanceState) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    super.onCreate(savedInstanceState);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    Animal animal = new Animal();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    animal.fly();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;è¿è¡Œç»“æœå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight groovy&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;getTarget-&amp;gt;com.wandering.sample.aspectj.Animal@&lt;span class=&#34;number&#34;&gt;509&lt;/span&gt;ddfd&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;getThis-&amp;gt;com.wandering.sample.aspectj.MainActivity@&lt;span class=&#34;number&#34;&gt;98&lt;/span&gt;c38bf&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;è¯´æ˜targetæŒ‡ä»£çš„æ˜¯åˆ‡å…¥ç‚¹æ–¹æ³•çš„æ‰€æœ‰è€…ï¼Œè€ŒthisæŒ‡ä»£çš„æ˜¯è¢«ç»‡å…¥ä»£ç æ‰€å±ç±»çš„å®ä¾‹å¯¹è±¡ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å°†åˆ‡ç‚¹çš„&lt;code&gt;call&lt;/code&gt;æ”¹ä¸º&lt;code&gt;execution&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight groovy&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;getTarget-&amp;gt;com.wandering.sample.aspectj.Animal@&lt;span class=&#34;number&#34;&gt;509&lt;/span&gt;ddfd&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;getThis-&amp;gt;com.wandering.sample.aspectj.Animal@&lt;span class=&#34;number&#34;&gt;509&lt;/span&gt;ddfd&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;ç¼ºç‚¹&#34;&gt;ç¼ºç‚¹&lt;a title=&#34;#ç¼ºç‚¹&#34; href=&#34;#ç¼ºç‚¹&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚æœç›¸åº”çš„classæ²¡æœ‰å®ç°ç›¸åº”çš„å¯¹ç‚¹æ–¹æ³•å°†æ— æ³•ç»‡å…¥ï¼Œå¦‚Activityæ²¡æœ‰å®ç°onResumeæ–¹æ³•çš„è¯ï¼Œå°†æ— æ³•ç»‡å…¥ä»£ç ã€‚&lt;/li&gt;
&lt;li&gt;æ— æ³•å¤„ç†Lambdaè¯­æ³•&lt;/li&gt;
&lt;li&gt;ä¼šæœ‰ä¸€ç³»åˆ—å…¼å®¹æ€§é—®é¢˜ï¼Œå¦‚R8ã€gradleç‰ˆæœ¬ä¸åŒç­‰&lt;/li&gt;
&lt;li&gt;æ€§èƒ½è¾ƒå·®ï¼ŒAPPé¡¹ç›®æ¯”è¾ƒå¤§æ—¶ç¼–è¯‘æ—¶é—´æ˜æ˜¾åŠ é•¿&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;refer&#34;&gt;Refer&lt;a title=&#34;#refer&#34; href=&#34;#refer&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/hyvenzhu/Android-Demos/blob/master/AspectJDemo/AspectJ.pdf&#34; target=&#34;_blank&#34;&gt;Android-Demos/AspectJ.pdf&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://juejin.cn/post/6888548726424469511&#34; target=&#34;_blank&#34;&gt;Android AOPæ–¹æ¡ˆ(ä¸€)â€”â€”AspectJ&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://www.jianshu.com/p/28aa352af7fb&#34; target=&#34;_blank&#34;&gt;Android AOP - ç®€ä¹¦&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://www.jianshu.com/p/d07c996ea13c&#34; target=&#34;_blank&#34;&gt;Android AspectJ&lt;/a&gt;&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://onion99.github.io/2022/03/11/qyGiQE7cKbQOfEKm/</guid>
            <title>Android AOP - JDKåŠ¨æ€ä»£ç†</title>
            <link>https://onion99.github.io/2022/03/11/qyGiQE7cKbQOfEKm/</link>
            <category>AOP</category>
            <pubDate>Fri, 11 Mar 2022 05:25:00 +0800</pubDate>
            <description><![CDATA[ &lt;p&gt;JDKçš„åŠ¨æ€ä»£ç†åº•å±‚æ˜¯é€šè¿‡Javaåå°„æœºåˆ¶å®ç°çš„ï¼Œå¹¶ä¸”éœ€è¦ç›®æ ‡å¯¹è±¡ç»§æ‰¿è‡ªä¸€ä¸ªæ¥å£æ‰èƒ½ç”Ÿæˆå®ƒçš„ä»£ç†ç±»&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;h4 id=&#34;javaåŠ¨æ€ä»£ç†&#34;&gt;JavaåŠ¨æ€ä»£ç†&lt;a title=&#34;#javaåŠ¨æ€ä»£ç†&#34; href=&#34;#javaåŠ¨æ€ä»£ç†&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;JDK è¿è¡ŒæœŸé—´ï¼ŒåŠ¨æ€åˆ›å»º class å­—èŠ‚ç å¹¶åŠ è½½åˆ° JVM&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol&gt;
&lt;li&gt;JDKçš„åŠ¨æ€ä»£ç†éœ€è¦å®ç°ä¸€ä¸ªå¤„ç†æ–¹æ³•è°ƒç”¨çš„Handlerï¼Œç”¨äºå®ç°ä»£ç†æ–¹æ³•çš„å†…éƒ¨é€»è¾‘ï¼Œå®ç°InvocationHandleræ¥å£&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;JdkProxyHandler&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;implements&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;InvocationHandler&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; Object target;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;JdkProxyHandler&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(Object target)&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;.target = target;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// proxyï¼šç”Ÿæˆçš„ä»£ç†å¯¹è±¡, objï¼šç›®æ ‡æ–¹æ³•, argsï¼šç›®æ ‡æ–¹æ³•å‚æ•°&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; Object &lt;span class=&#34;title&#34;&gt;invoke&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(Object proxy, Method method, Object[] args)&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;throws&lt;/span&gt; Throwable &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        System.out.println(&lt;span class=&#34;string&#34;&gt;&amp;quot;å¤„ç†å‰&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        Object result = method.invoke(target,args);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        System.out.println(&lt;span class=&#34;string&#34;&gt;&amp;quot;å¤„ç†å&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; result;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;ä»£ç†&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//2-1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;interface&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;ISender&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;send&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//2-2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;SmsSender&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;implements&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;ISender&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;send&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        System.out.println(&lt;span class=&#34;string&#34;&gt;&amp;quot;sending msg&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//2-3&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Test&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;testJdkProxy&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ISender sender = (ISender) Proxy.newProxyInstance(ClassLoader.getSystemClassLoader(),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; Class[]&amp;#123;ISender.class&amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; JdkProxyHandler(&lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; SmsSender()));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; result = sender.send();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    System.out.println(&lt;span class=&#34;string&#34;&gt;&amp;quot;ä»£ç†å¯¹è±¡ï¼š&amp;quot;&lt;/span&gt; + sender.getClass().getName());&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    System.out.println(&lt;span class=&#34;string&#34;&gt;&amp;quot;è¾“å‡ºç»“æœï¼š&amp;quot;&lt;/span&gt; + result);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;é€š è¿‡ JDK çš„ java.lang.reflect.Proxy ç±»å®ç°åŠ¨æ€ä»£ç† ï¼Œ ä¼šä½¿ç”¨å…¶é™æ€æ–¹æ³•newProxyInstance()ï¼Œä¾æ®ç›®æ ‡å¯¹è±¡ã€ä¸šåŠ¡æ¥å£åŠè°ƒç”¨å¤„ç†å™¨ä¸‰è€…ï¼Œè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªåŠ¨æ€ä»£ç†å¯¹è±¡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;public static newProxyInstance ( ClassLoader loader, Class&amp;lt;?&amp;gt;[] interfaces, InvocationHandler handler)&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;loaderï¼šç›®æ ‡ç±»çš„ç±»åŠ è½½å™¨ï¼Œé€šè¿‡ç›®æ ‡å¯¹è±¡çš„åå°„å¯è·å–&lt;/li&gt;
&lt;li&gt;interfacesï¼šç›®æ ‡ç±»å®ç°çš„æ¥å£æ•°ç»„ï¼Œé€šè¿‡ç›®æ ‡å¯¹è±¡çš„åå°„å¯è·å–&lt;/li&gt;
&lt;li&gt;handlerï¼šè°ƒç”¨å¤„ç†å™¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h5 id=&#34;åŸç†&#34;&gt;åŸç†&lt;a title=&#34;#åŸç†&#34; href=&#34;#åŸç†&#34;&gt;&lt;/a&gt;&lt;/h5&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;static&lt;/span&gt; Object &lt;span class=&#34;title&#34;&gt;newProxyInstance&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(ClassLoader loader,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;                                          Class&amp;lt;?&amp;gt;[] interfaces,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;                                          InvocationHandler h)&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;throws&lt;/span&gt; IllegalArgumentException &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//1.æ£€æŸ¥&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    Objects.requireNonNull(h);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; Class&amp;lt;?&amp;gt;[] intfs = interfaces.clone();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; SecurityManager sm = System.getSecurityManager();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (sm != &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        checkProxyAccess(Reflection.getCallerClass(), loader, intfs);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//æŸ¥æ‰¾æˆ–ç”ŸæˆæŒ‡å®šçš„ä»£ç†ç±»&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    Class&amp;lt;?&amp;gt; cl = getProxyClass0(loader, intfs);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;try&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (sm != &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            checkNewProxyPermission(Reflection.getCallerClass(), cl);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//é€šè¿‡åå°„åˆ›å»ºä»£ç†å¯¹è±¡&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; Constructor&amp;lt;?&amp;gt; cons = cl.getConstructor(constructorParams);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; InvocationHandler ih = h;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!Modifier.isPublic(cl.getModifiers())) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            AccessController.doPrivileged(&lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; PrivilegedAction&amp;lt;Void&amp;gt;() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; Void &lt;span class=&#34;title&#34;&gt;run&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    cons.setAccessible(&lt;span class=&#34;keyword&#34;&gt;true&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; cons.newInstance(&lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; Object[]&amp;#123;h&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;span class=&#34;keyword&#34;&gt;catch&lt;/span&gt; (IllegalAccessException|InstantiationException e) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;throw&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; InternalError(e.toString(), e);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;span class=&#34;keyword&#34;&gt;catch&lt;/span&gt; (InvocationTargetException e) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        Throwable t = e.getCause();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (t &lt;span class=&#34;keyword&#34;&gt;instanceof&lt;/span&gt; RuntimeException) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;throw&lt;/span&gt; (RuntimeException) t;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;throw&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; InternalError(t.toString(), t);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;span class=&#34;keyword&#34;&gt;catch&lt;/span&gt; (NoSuchMethodException e) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;throw&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; InternalError(e.toString(), e);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;å±€é™æ€§&#34;&gt;å±€é™æ€§&lt;a title=&#34;#å±€é™æ€§&#34; href=&#34;#å±€é™æ€§&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;åªèƒ½ä»£ç†æ¥å£ï¼Œå¹¶ä¸”åªèƒ½ä¿®æ”¹æ¥å£å£°æ˜çš„æ–¹æ³•&lt;/p&gt;
&lt;h3 id=&#34;refer&#34;&gt;Refer&lt;a title=&#34;#refer&#34; href=&#34;#refer&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.jb51.net/article/209607.htm&#34; target=&#34;_blank&#34;&gt;JavaåŠ¨æ€ä»£ç†å››ç§å®ç°æ–¹å¼è¯¦è§£&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://www.cnblogs.com/wkfvawl/p/15030814.html&#34; target=&#34;_blank&#34;&gt;Java åŠ¨æ€ä»£ç† - ç‹é™¸&lt;/a&gt;&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://onion99.github.io/2022/03/10/9rnRdFk7xf4rnvds/</guid>
            <title>Android AOP - æ¦‚è®º</title>
            <link>https://onion99.github.io/2022/03/10/9rnRdFk7xf4rnvds/</link>
            <category>AOP</category>
            <pubDate>Thu, 10 Mar 2022 17:26:27 +0800</pubDate>
            <description><![CDATA[ &lt;h3 id=&#34;ç¼–ç¨‹æ¶æ„æ€æƒ³&#34;&gt;ç¼–ç¨‹æ¶æ„æ€æƒ³&lt;a title=&#34;#ç¼–ç¨‹æ¶æ„æ€æƒ³&#34; href=&#34;#ç¼–ç¨‹æ¶æ„æ€æƒ³&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;é¢å‘å¯¹è±¡(Object Oriented Programming)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é¢å‘è¿‡ç¨‹(Procedure Oriented Programming)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é¢å‘åˆ‡é¢(Aspect Oriented Programming)&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;p&gt;AOP æ„ä¸ºé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œé€šè¿‡é¢„ç¼–è¯‘æ–¹å¼å’Œè¿è¡ŒæœŸåŠ¨æ€ä»£ç†å®ç°ç¨‹åºåŠŸèƒ½ç»Ÿä¸€ç»´æŠ¤çš„ä¸€ç§æŠ€æœ¯ï¼Œå’Œ OOP ä»¥å¯¹è±¡ä¸ºæ ¸å¿ƒä¸åŒï¼ŒAOPæ˜¯é’ˆå¯¹ä¸šåŠ¡å¤„ç†è¿‡ç¨‹ä¸­çš„ç±»ä¼¼çš„ä»£ç é€»è¾‘è¿›è¡Œåˆ‡å…¥ï¼Œç„¶åç»Ÿä¸€å¤„ç†ã€‚&lt;/p&gt;
&lt;p&gt;AOPå…¶å®æ˜¯OOPçš„è¡¥å……ï¼ŒOOPä»æ¨ªå‘ä¸ŠåŒºåˆ†å‡ºä¸€ä¸ªä¸ªçš„ç±»æ¥ï¼Œè€ŒAOPåˆ™ä»çºµå‘ä¸Šå‘å¯¹è±¡ä¸­åŠ å…¥ç‰¹å®šçš„ä»£ç ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://s1.ax1x.com/2022/03/10/bfRiDK.png&#34; alt=&#34;bfRiDK.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;å¸¸è§æ¦‚å¿µ&#34;&gt;å¸¸è§æ¦‚å¿µ&lt;a title=&#34;#å¸¸è§æ¦‚å¿µ&#34; href=&#34;#å¸¸è§æ¦‚å¿µ&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;è¿æ¥ç‚¹(&lt;em&gt;Joinpoint&lt;/em&gt;)
&lt;ul&gt;
&lt;li&gt;ç¨‹åºä¸­å¯èƒ½ä½œä¸ºä»£ç æ³¨å…¥ç›®æ ‡çš„ç‰¹å®šçš„ç‚¹ï¼Œä¾‹å¦‚ä¸€ä¸ªæ–¹æ³•è°ƒç”¨æˆ–è€…æ–¹æ³•å…¥å£ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;åˆ‡ç‚¹ï¼ˆ&lt;em&gt;Pointcut&lt;/em&gt;ï¼‰
&lt;ul&gt;
&lt;li&gt;å‘Šè¯‰ä»£ç æ³¨å…¥å·¥å…·ï¼Œåœ¨ä»»ä½•æ³¨å…¥ä¸€æ®µç‰¹å®šä»£ç çš„è¡¨è¾¾å¼ã€‚ä¾‹å¦‚ï¼Œåœ¨å“ªäº›joint pointsåº”ç”¨ä¸€ä¸ªç‰¹å®šçš„Adviceã€‚&lt;/li&gt;
&lt;li&gt;åˆ‡å…¥ç‚¹å¯ä»¥é€‰æ‹©å”¯ä¸€ä¸€ä¸ªï¼Œæ¯”å¦‚æ‰§è¡ŒæŸä¸€ä¸ªæ–¹æ³•ï¼Œä¹Ÿå¯ä»¥æœ‰å¤šä¸ªé€‰æ‹©ï¼Œæ¯”å¦‚ï¼Œæ ‡è®°äº†ä¸€ä¸ªå®šä¹‰æˆ@DebugLogçš„è‡ªå®šä¹‰æ³¨è§£çš„æ‰€æœ‰æ–¹æ³•ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å¢å¼ºï¼ˆ&lt;em&gt;Advice&lt;/em&gt;ï¼‰
&lt;ul&gt;
&lt;li&gt;æ³¨å…¥åˆ°classæ–‡ä»¶ä¸­çš„ä»£ç ã€‚&lt;/li&gt;
&lt;li&gt;å…¸å‹çš„Adviceç±»å‹æœ‰beforeã€afterå’Œaroundï¼Œåˆ†åˆ«è¡¨ç¤ºåœ¨ç›®æ ‡æ–¹æ³•æ‰§è¡Œä¹‹å‰ã€æ‰§è¡Œåå’Œå®Œå…¨ä»£æ›¿ç›®æ ‡æ–¹æ³•æ‰§è¡Œçš„ä»£ç ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç›®æ ‡å¯¹è±¡ (&lt;em&gt;Target&lt;/em&gt;)&lt;/li&gt;
&lt;li&gt;å¼•ä»‹(&lt;em&gt;Introduction&lt;/em&gt;)&lt;/li&gt;
&lt;li&gt;ç»‡å…¥ï¼ˆ&lt;em&gt;Weaving&lt;/em&gt;ï¼‰
&lt;ul&gt;
&lt;li&gt;æ³¨å…¥ä»£ç ï¼ˆadvicesï¼‰åˆ°ç›®æ ‡ä½ç½®ï¼ˆjoint pointsï¼‰çš„è¿‡ç¨‹&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä»£ç†ï¼ˆ&lt;em&gt;Proxy&lt;/em&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;åˆ‡é¢ï¼ˆ&lt;em&gt;Aspect&lt;/em&gt;ï¼‰
&lt;ul&gt;
&lt;li&gt;Pointcutå’ŒAdviceçš„ç»„åˆçœ‹åšåˆ‡é¢ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬åœ¨åº”ç”¨ä¸­é€šè¿‡å®šä¹‰ä¸€ä¸ªPointcutå’Œç»™å®šæ°å½“çš„Adviceï¼Œæ·»åŠ ä¸€ä¸ªæ—¥å¿—åˆ‡é¢&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;åˆ†ç±»&#34;&gt;åˆ†ç±»&lt;a title=&#34;#åˆ†ç±»&#34; href=&#34;#åˆ†ç±»&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸€ç±»æ˜¯ï¼Œä¾‹å¦‚Javaçš„åŠ¨æ€ä»£ç†ï¼›å¦ä¸€ç±»å¯ä»¥å½’ç»“ä¸ºï¼Œä¾‹å¦‚ç»å¸¸å¬è¯´çš„ï¼ŒAspecJç­‰æ¡†æ¶&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;è¿è¡ŒæœŸçš„AOP
&lt;ul&gt;
&lt;li&gt;Javaçš„åŠ¨æ€ä»£ç†&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç¼–è¯‘æœŸçš„AOP
&lt;ul&gt;
&lt;li&gt;ASM&lt;/li&gt;
&lt;li&gt;AspecJ&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;åº”ç”¨&#34;&gt;åº”ç”¨&lt;a title=&#34;#åº”ç”¨&#34; href=&#34;#åº”ç”¨&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Hot Fix
&lt;ul&gt;
&lt;li&gt;åŸºäºAOPæŠ€æœ¯ï¼Œç¼–è¯‘æœŸä¿®æ”¹Javaå­—èŠ‚ç ï¼Œå¯¹æ¯ä¸€ä¸ªæ–¹æ³•è¿›è¡Œæ’æ¡©æ“ä½œï¼Œä»¥ä¾¿äºhookæ¯ä¸€ä¸ªæ–¹æ³•ï¼Œåšåˆ°æ–¹æ³•çº§åˆ«çš„çƒ­ä¿®å¤&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç›‘æµ‹æ–¹æ³•è€—æ—¶&lt;/li&gt;
&lt;li&gt;æ—¥å¿—è®°å½•&lt;/li&gt;
&lt;li&gt;ç»Ÿä¸€å¤„ç†ç‚¹å‡»æŠ–åŠ¨&lt;/li&gt;
&lt;li&gt;å…¶ä»–çš„ç›‘æ§æ–¹é¢&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;aopä¸aptåŒºåˆ«&#34;&gt;AOPä¸APTåŒºåˆ«&lt;a title=&#34;#aopä¸aptåŒºåˆ«&#34; href=&#34;#aopä¸aptåŒºåˆ«&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;APT(Annotation Processing Tool)å³æ³¨è§£å¤„ç†å™¨ï¼Œæ˜¯ä¸€ç§å¤„ç†æ³¨è§£çš„å·¥å…·ï¼Œç¡®åˆ‡çš„è¯´å®ƒæ˜¯javacçš„ä¸€ä¸ªå·¥å…·ï¼Œå®ƒç”¨æ¥åœ¨ç¼–è¯‘æ—¶æ‰«æå’Œå¤„ç†æ³¨è§£ã€‚æ³¨è§£å¤„ç†å™¨ä»¥Javaä»£ç (æˆ–è€…ç¼–è¯‘è¿‡çš„å­—èŠ‚ç )ä½œä¸ºè¾“å…¥ï¼Œç”Ÿæˆ&lt;code&gt;.javaæ–‡ä»¶&lt;/code&gt;ä½œä¸ºè¾“å‡ºã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;APTæ˜¯åœ¨ç¼–è¯‘æœŸï¼Œé€šè¿‡æ³¨è§£ç”Ÿæˆ&lt;code&gt;java&lt;/code&gt;æ–‡ä»¶ï¼Œç„¶å.javaæ–‡ä»¶ä»ç„¶éœ€è¦è¿›ä¸€æ­¥ç¼–è¯‘ç”Ÿæˆ&lt;code&gt;.class&lt;/code&gt;æ–‡ä»¶&lt;/li&gt;
&lt;li&gt;AOPæ˜¯åœ¨ç¼–è¯‘å®Œæˆåç›´æ¥é€šè¿‡ä¿®æ”¹&lt;code&gt;.class&lt;/code&gt;æ–‡ä»¶ï¼Œæ·»åŠ æˆ–è€…ä¿®æ”¹ä»£ç é€»è¾‘&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;refer&#34;&gt;Refer&lt;a title=&#34;#refer&#34; href=&#34;#refer&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://mp.weixin.qq.com/s?__biz=MzUxODg0MzU2OQ==&amp;amp;mid=2247483887&amp;amp;idx=1&amp;amp;sn=d54e3f210a4f31f477dba06c3dcd352e&amp;amp;scene=21#wechat_redirect&#34; target=&#34;_blank&#34;&gt;AOPæŠ€æœ¯åœ¨å®¢æˆ·ç«¯çš„åº”ç”¨ä¸å®è·µ&lt;/a&gt;&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://onion99.github.io/2022/03/09/wkROkqAosRBXidma/</guid>
            <title>Android-åŠ¨æ€åŒ–æ–¹æ¡ˆæ¢ç´¢</title>
            <link>https://onion99.github.io/2022/03/09/wkROkqAosRBXidma/</link>
            <pubDate>Wed, 09 Mar 2022 17:21:31 +0800</pubDate>
            <description><![CDATA[ &lt;p&gt;&lt;img src=&#34;https://pic3.zhimg.com/80/v2-7179de6b1bfe62fa7aa3c93d5948509a_720w.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¼€æºæ–¹æ¡ˆï¼š&lt;br&gt;
&lt;a href=&#34;https://github.com/alibaba/vlayout&#34; target=&#34;_blank&#34;&gt;alibaba/vlayout: Project vlayout is a powerfull LayoutManager extension for RecyclerView, it provides a group of layouts for RecyclerView. Make it able to handle a complicate situation when grid, list and other layouts in the same recyclerview&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/alibaba/tangram-android&#34; target=&#34;_blank&#34;&gt;alibaba/Tangram-Android: Tangram is a modular UI solution for building native page dynamically including Tangram for Android, Tangram for iOS and even backend CMS. This project provides the sdk on Android&lt;/a&gt;&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://onion99.github.io/2022/03/08/r2WB7zoGFwDaiwmB/</guid>
            <title>Android - ç»„ä»¶åŒ–</title>
            <link>https://onion99.github.io/2022/03/08/r2WB7zoGFwDaiwmB/</link>
            <pubDate>Tue, 08 Mar 2022 17:17:11 +0800</pubDate>
            <description><![CDATA[ &lt;blockquote&gt;
&lt;p&gt;ç»„ä»¶æ˜¯å¯æ‹†é™¤çš„å°±è¡¨ç¤ºç»„ä»¶ä¸ç»„ä»¶ä¹‹é—´æ˜¯ä¸ä¼šè€¦åˆçš„ã€‚ ç»„ä»¶åŒ–å°±æ˜¯éœ€è¦å»æ‹†åˆ†å‡ºç»„ä»¶å’Œå®ç°ç»„ä»¶ä¹‹é—´é€šä¿¡çš„è¿‡ç¨‹&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;é¡¹ç›®å‘å±•åˆ°ä¸€å®šç¨‹åº¦ï¼Œéšç€äººå‘˜çš„å¢å¤šï¼Œä»£ç è¶Šæ¥è¶Šè‡ƒè‚¿ï¼Œè¿™æ—¶å€™å°±å¿…é¡»è¿›è¡Œæ¨¡å—åŒ–çš„æ‹†åˆ†ã€‚æ¨¡å—åŒ–æ˜¯ä¸€ç§æŒ‡å¯¼ç†å¿µï¼Œå…¶æ ¸å¿ƒæ€æƒ³å°±æ˜¯åˆ†è€Œæ²»ä¹‹ã€é™ä½è€¦åˆæœ€ç»ˆç›®çš„æ–¹ä¾¿é¡¹ç›®å¼€å‘æ›´åŠ æµç•…ï¼Œåˆ†å·¥æ›´åŠ æ˜ç¡®ã€‚åŒæ—¶ä¸šåŠ¡çº¿åªéœ€è¦ä¾èµ–è‡ªå·±çš„æ¨¡å—æ— éœ€å¼•å…¥å…¶ä»–ä¸šåŠ¡æ¨¡å—ä»è€Œå¯ä»¥åŠ å¿«ç¼–è¯‘é€Ÿåº¦&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;h3 id=&#34;ç»„ä»¶æ‹†åˆ†&#34;&gt;ç»„ä»¶æ‹†åˆ†&lt;a title=&#34;#ç»„ä»¶æ‹†åˆ†&#34; href=&#34;#ç»„ä»¶æ‹†åˆ†&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://s1.ax1x.com/2022/03/09/bWG2b8.png&#34; alt=&#34;bWG2b8.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;å®ç°ç»„ä»¶åŒ–&#34;&gt;å®ç°ç»„ä»¶åŒ–&lt;a title=&#34;#å®ç°ç»„ä»¶åŒ–&#34; href=&#34;#å®ç°ç»„ä»¶åŒ–&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;æ ¸å¿ƒå³æ˜¯&lt;strong&gt;è·¯ç”±&lt;/strong&gt;ï¼Œ&lt;strong&gt;åå°„&lt;/strong&gt;ï¼Œ&lt;strong&gt;é€šä¿¡åè®®&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç»„ä»¶ä¹‹é—´æ²¡æœ‰ä¾èµ–å…³ç³»æ‰€ä»¥ç»„ä»¶å‘å¤–æš´éœ²çš„æ–¹æ³•è¦è¿›è¡Œæ³¨å†Œï¼Œæˆ‘ä»¬é€šè¿‡æˆ‘ä»¬èµ·çš„åˆ«åå»å¯»æ‰¾ä»–ï¼Œè¿™å°±æ˜¯è·¯ç”±çš„è¿‡ ç¨‹ï¼Œç„¶åé€šè¿‡åå°„å»å®ä¾‹åŒ–ï¼Œé€šè¿‡é€šä¿¡åè®®ä¸ç»„ä»¶äº¤äº’ã€‚&lt;/p&gt;
&lt;p&gt;ç»„ä»¶åŒ–é€šä¿¡ä¸€å®šè¦æœ‰ç»Ÿä¸€çš„åè®®å»çº¦æŸï¼Œä¸ç„¶å³ä½¿æ‰¾åˆ°äº†ç›®æ ‡å¯¹è±¡ä½†æ˜¯ä¸çŸ¥é“å¦‚ä½•ä½¿ç”¨ä¹Ÿæ˜¯æ— æµäºäº‹çš„ã€‚ æˆ‘ä»¬éœ€è¦æ˜ç¡®ä¸€ç‚¹ç»„ä»¶éœ€è¦å‘å¤–æš´éœ²ä»€ä¹ˆä¸œè¥¿å‘¢?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸€ä¸ªæ˜¯ç»„ä»¶æä¾›çš„Activity/Fragmentè·¯ç”±&lt;/li&gt;
&lt;li&gt;ä¸€ä¸ªæ˜¯ç»„ä»¶æä¾›çš„ä¸€äº›æœåŠ¡æ–¹æ³•ï¼Œå¦‚å®šä½åº“æä¾›å®šä½ä¿¡æ¯è·å–&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¼€æºæ–¹æ¡ˆï¼š&lt;a href=&#34;https://github.com/alibaba/ARouter&#34; target=&#34;_blank&#34;&gt;alibaba/ARouter: ğŸ’ª A framework for assisting in the renovation of Android componentization (å¸®åŠ© Android App è¿›è¡Œç»„ä»¶åŒ–æ”¹é€ çš„è·¯ç”±æ¡†æ¶)&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;æ–‡ç« æ¥æº&#34;&gt;æ–‡ç« æ¥æº&lt;a title=&#34;#æ–‡ç« æ¥æº&#34; href=&#34;#æ–‡ç« æ¥æº&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://zhuanlan.zhihu.com/p/365501317&#34; target=&#34;_blank&#34;&gt;è€ç”Ÿå¸¸è°ˆï¼šç»„ä»¶åŒ– - çŸ¥ä¹ (zhihu.com)&lt;/a&gt;&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://onion99.github.io/2022/03/08/yriIudTcpjYyMHli/</guid>
            <title>Androidé»‘ç§‘æŠ€ - æ’ä»¶åŒ–</title>
            <link>https://onion99.github.io/2022/03/08/yriIudTcpjYyMHli/</link>
            <category>é»‘ç§‘æŠ€</category>
            <pubDate>Tue, 08 Mar 2022 06:46:11 +0800</pubDate>
            <description><![CDATA[ &lt;p&gt;æ’ä»¶åŒ–æŠ€æœ¯æœ€åˆæºäºå…å®‰è£…è¿è¡Œapkçš„æƒ³æ³•ï¼Œè¿™ä¸ªå…å®‰è£…çš„apkå¯ä»¥ç†è§£ä¸ºæ’ä»¶ã€‚æ”¯æŒæ’ä»¶åŒ–çš„appå¯ä»¥åœ¨è¿è¡Œæ—¶åŠ è½½å’Œè¿è¡Œæ’ä»¶ï¼Œè¿™æ ·ä¾¿å¯ä»¥å°†appä¸­ä¸€äº›ä¸å¸¸ç”¨çš„åŠŸèƒ½æ¨¡å—åšæˆæ’ä»¶ï¼Œä¸€æ–¹é¢å‡å°äº†å®‰è£…åŒ…çš„å¤§å°ï¼Œå¦ä¸€æ–¹é¢å¯ä»¥å®ç°appåŠŸèƒ½çš„åŠ¨æ€æ‰©å±•ã€‚&lt;/p&gt;
&lt;p&gt;æƒ³è¦å®ç°æ’ä»¶åŒ–ï¼Œä¸»è¦æ˜¯è§£å†³ä¸‹é¢ä¸‰ä¸ªé—®é¢˜ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ’ä»¶ä¸­ä»£ç çš„åŠ è½½å’Œä¸ä¸»å·¥ç¨‹çš„äº’ç›¸è°ƒç”¨&lt;/li&gt;
&lt;li&gt;æ’ä»¶ä¸­èµ„æºçš„åŠ è½½å’Œä¸ä¸»å·¥ç¨‹çš„äº’ç›¸è®¿é—®&lt;/li&gt;
&lt;li&gt;å››å¤§ç»„ä»¶ç”Ÿå‘½å‘¨æœŸçš„ç®¡ç†&lt;/li&gt;
&lt;/ul&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;h3 id=&#34;æ’ä»¶åŒ–å‘å±•&#34;&gt;æ’ä»¶åŒ–å‘å±•&lt;a title=&#34;#æ’ä»¶åŒ–å‘å±•&#34; href=&#34;#æ’ä»¶åŒ–å‘å±•&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://s1.ax1x.com/2022/03/07/byn21s.png&#34; alt=&#34;byn21s.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç¬¬ä¸€ä»£&lt;/strong&gt;ï¼šdynamic-load-apkæœ€æ—©ä½¿ç”¨ProxyActivityè¿™ç§é™æ€ä»£ç†æŠ€æœ¯ï¼Œç”±ProxyActivityå»æ§åˆ¶æ’ä»¶ä¸­PluginActivityçš„ç”Ÿå‘½å‘¨æœŸã€‚è¯¥ç§æ–¹å¼ç¼ºç‚¹æ˜æ˜¾ï¼Œæ’ä»¶ä¸­çš„activityå¿…é¡»ç»§æ‰¿PluginActivityï¼Œå¼€å‘æ—¶è¦å°å¿ƒå¤„ç†contextã€‚è€ŒDroidPluginé€šè¿‡Hookç³»ç»ŸæœåŠ¡çš„æ–¹å¼å¯åŠ¨æ’ä»¶ä¸­çš„Activityï¼Œä½¿å¾—å¼€å‘æ’ä»¶çš„è¿‡ç¨‹å’Œå¼€å‘æ™®é€šçš„appæ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œä½†æ˜¯ç”±äºhookè¿‡å¤šç³»ç»ŸæœåŠ¡ï¼Œå¼‚å¸¸å¤æ‚ä¸”ä¸å¤Ÿç¨³å®šã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç¬¬äºŒä»£&lt;/strong&gt;ï¼šä¸ºäº†åŒæ—¶è¾¾åˆ°æ’ä»¶å¼€å‘çš„ä½ä¾µå…¥æ€§ï¼ˆåƒå¼€å‘æ™®é€šappä¸€æ ·å¼€å‘æ’ä»¶ï¼‰å’Œæ¡†æ¶çš„ç¨³å®šæ€§ï¼Œåœ¨å®ç°åŸç†ä¸Šéƒ½æ˜¯è¶‹è¿‘äºé€‰æ‹©å°½é‡å°‘çš„hookï¼Œå¹¶é€šè¿‡åœ¨manifestä¸­é¢„åŸ‹ä¸€äº›ç»„ä»¶å®ç°å¯¹å››å¤§ç»„ä»¶çš„æ’ä»¶åŒ–ã€‚å¦å¤–å„ä¸ªæ¡†æ¶æ ¹æ®å…¶è®¾è®¡æ€æƒ³éƒ½åšäº†ä¸åŒç¨‹åº¦çš„æ‰©å±•ï¼Œå…¶ä¸­Smallæ›´æ˜¯åšæˆäº†ä¸€ä¸ªè·¨å¹³å°ï¼Œç»„ä»¶åŒ–çš„å¼€å‘æ¡†æ¶ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç¬¬ä¸‰ä»£&lt;/strong&gt;ï¼šVirtualAppæ¯”è¾ƒå‰å®³ï¼Œèƒ½å¤Ÿå®Œå…¨æ¨¡æ‹Ÿappçš„è¿è¡Œç¯å¢ƒï¼Œèƒ½å¤Ÿå®ç°appçš„å…å®‰è£…è¿è¡Œå’ŒåŒå¼€æŠ€æœ¯ã€‚Atlasæ˜¯é˜¿é‡Œä»Šå¹´å¼€æºå‡ºæ¥çš„ä¸€ä¸ªç»“åˆç»„ä»¶åŒ–å’Œçƒ­ä¿®å¤æŠ€æœ¯çš„ä¸€ä¸ªappåŸºç¡€æ¡†æ¶ï¼Œå…¶å¹¿æ³›çš„åº”ç”¨ä¸é˜¿é‡Œç³»çš„å„ä¸ªappï¼Œå…¶å·ç§°æ˜¯ä¸€ä¸ªå®¹å™¨åŒ–æ¡†æ¶&lt;/p&gt;
&lt;h3 id=&#34;æ’ä»¶åŒ–æ–¹æ¡ˆ&#34;&gt;æ’ä»¶åŒ–æ–¹æ¡ˆ&lt;a title=&#34;#æ’ä»¶åŒ–æ–¹æ¡ˆ&#34; href=&#34;#æ’ä»¶åŒ–æ–¹æ¡ˆ&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;h4 id=&#34;é™æ€æ–¹æ¡ˆ-é€šè¿‡proxyactivityç»Ÿä¸€åŠ è½½æ’ä»¶ä¸­çš„æ‰€æœ‰activityï¼Œä»¥thatæ¡†æ¶ä¸ºä»£è¡¨&#34;&gt;é™æ€æ–¹æ¡ˆ-é€šè¿‡ProxyActivityç»Ÿä¸€åŠ è½½æ’ä»¶ä¸­çš„æ‰€æœ‰Activityï¼Œä»¥thatæ¡†æ¶ä¸ºä»£è¡¨&lt;a title=&#34;#é™æ€æ–¹æ¡ˆ-é€šè¿‡proxyactivityç»Ÿä¸€åŠ è½½æ’ä»¶ä¸­çš„æ‰€æœ‰activityï¼Œä»¥thatæ¡†æ¶ä¸ºä»£è¡¨&#34; href=&#34;#é™æ€æ–¹æ¡ˆ-é€šè¿‡proxyactivityç»Ÿä¸€åŠ è½½æ’ä»¶ä¸­çš„æ‰€æœ‰activityï¼Œä»¥thatæ¡†æ¶ä¸ºä»£è¡¨&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;ProxyActivityä»£ç†çš„æ–¹å¼æœ€æ—©æ˜¯ç”±dynamic-load-apkæå‡ºçš„ï¼Œå…¶æ€æƒ³å¾ˆç®€å•ï¼Œåœ¨ä¸»å·¥ç¨‹ä¸­æ”¾ä¸€ä¸ªProxyActivyï¼Œå¯åŠ¨æ’ä»¶ä¸­çš„Activityæ—¶ä¼šå…ˆå¯åŠ¨ProxyActivityï¼Œåœ¨ProxyActivityä¸­åˆ›å»ºæ’ä»¶Activityï¼Œå¹¶åŒæ­¥ç”Ÿå‘½å‘¨æœŸ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&#34;https://s1.ax1x.com/2022/03/07/byKLex.png&#34; alt=&#34;byKLex.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;h5 id=&#34;æµç¨‹:&#34;&gt;æµç¨‹:&lt;a title=&#34;#æµç¨‹:&#34; href=&#34;#æµç¨‹:&#34;&gt;&lt;/a&gt;&lt;/h5&gt;
&lt;ol&gt;
&lt;li&gt;é¦–å…ˆéœ€è¦é€šè¿‡ç»Ÿä¸€çš„å…¥å£ï¼ˆå¦‚å›¾ä¸­çš„PluginManagerï¼‰å¯åŠ¨æ’ä»¶Activityï¼Œå…¶å†…éƒ¨ä¼šå°†å¯åŠ¨çš„æ’ä»¶Activityä¿¡æ¯ä¿å­˜ä¸‹æ¥ï¼Œå¹¶å°†intentæ›¿æ¢ä¸ºå¯åŠ¨ProxyActivityçš„intentã€‚&lt;/li&gt;
&lt;li&gt;ProxyActivityæ ¹æ®æ’ä»¶çš„ä¿¡æ¯æ‹¿åˆ°è¯¥æ’ä»¶çš„ClassLoaderå’ŒResourceï¼Œé€šè¿‡åå°„åˆ›å»ºPluginActivityå¹¶è°ƒç”¨å…¶onCreateæ–¹æ³•ã€‚&lt;/li&gt;
&lt;li&gt;PluginActivtyè°ƒç”¨çš„setContentViewè¢«é‡å†™äº†ï¼Œä¼šå»è°ƒç”¨ProxyActivtyçš„setContentViewã€‚ç”±äºProxyActivityé‡å†™äº†getResourceè¿”å›çš„æ˜¯æ’ä»¶çš„Resourceï¼Œæ‰€ä»¥setContentViewèƒ½å¤Ÿè®¿é—®åˆ°æ’ä»¶ä¸­çš„èµ„æºã€‚åŒæ ·findViewByIdä¹Ÿæ˜¯è°ƒç”¨ProxyActivityçš„ã€‚&lt;/li&gt;
&lt;li&gt;ProxyActivityä¸­çš„å…¶ä»–ç”Ÿå‘½å‘¨æœŸå›è°ƒå‡½æ•°ä¸­è°ƒç”¨ç›¸åº”PluginActivityçš„ç”Ÿå‘½å‘¨æœŸ&lt;/li&gt;
&lt;/ol&gt;
&lt;h5 id=&#34;å®ç°&#34;&gt;å®ç°&lt;a title=&#34;#å®ç°&#34; href=&#34;#å®ç°&#34;&gt;&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;æ¨¡æ‹ŸActivtyåŸºæœ¬å®ç°:&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;interface&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;ProxyActivityInterface&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//ç”Ÿå‘½å‘¨æœŸçš„activity&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;attach&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(Activity proxyActivity)&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onCreate&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(Bundle savedInstanceState)&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onStart&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onResume&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onPause&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onStop&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onDestroy&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onSaveInstanceState&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(Bundle outState)&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onTouchEvent&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(MotionEvent event)&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onBackPressed&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æ’ä»¶BaseActivtyç±»:&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;92&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// è¿™æ˜¯æ’ä»¶çš„åŸºç±»ï¼Œæ‰€æœ‰çš„activityéƒ½è¦ç»§æ‰¿è¿™ä¸ªç±»ï¼Œ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;BaseActivity&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;Activity&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;implements&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;ProxyActivityInterface&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; Activity that;&lt;span class=&#34;comment&#34;&gt;//è¿™é‡Œçš„that æŒ‡çš„æ˜¯æˆ‘ä»¬çš„å®¿ä¸»appï¼Œå› ä¸ºæ’ä»¶æ˜¯æ²¡æœ‰å®‰è£…çš„ æ˜¯æ²¡æœ‰ä¸Šä¸‹æ–‡çš„&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;attach&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(Activity proxyActivity)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        that = proxyActivity;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;setContentView&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(View view)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//å¯ä»¥çœ‹åˆ°,æœ€ç»ˆè°ƒç”¨ä¸»App(å®¿ä¸»)çš„activity å‡½æ•°&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (that != &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            that.setContentView(view);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;super&lt;/span&gt;.setContentView(view);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;setContentView&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; layoutResID)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        that.setContentView(layoutResID);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; View &lt;span class=&#34;title&#34;&gt;findViewById&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; id)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; that.findViewById(id);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; Intent &lt;span class=&#34;title&#34;&gt;getIntent&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (that != &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; that.getIntent();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;super&lt;/span&gt;.getIntent();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; ClassLoader &lt;span class=&#34;title&#34;&gt;getClassLoader&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; that.getClassLoader();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; LayoutInflater &lt;span class=&#34;title&#34;&gt;getLayoutInflater&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; that.getLayoutInflater();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; ApplicationInfo &lt;span class=&#34;title&#34;&gt;getApplicationInfo&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; that.getApplicationInfo();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; Window &lt;span class=&#34;title&#34;&gt;getWindow&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; that.getWindow();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; WindowManager &lt;span class=&#34;title&#34;&gt;getWindowManager&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; that.getWindowManager();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;startActivity&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(Intent intent)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//        ProxyActivity ---&amp;gt;className&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        Intent m = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; Intent();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        m.putExtra(&lt;span class=&#34;string&#34;&gt;&amp;quot;ClassName&amp;quot;&lt;/span&gt;, intent.getComponent().getClassName());&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        that.startActivity(m);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onCreate&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(Bundle savedInstanceState)&lt;/span&gt; &lt;/span&gt;&amp;#123;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onStart&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onResume&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onPause&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onStop&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onDestroy&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onSaveInstanceState&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(Bundle outState)&lt;/span&gt; &lt;/span&gt;&amp;#123;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æ’ä»¶ProxyActivity(): ä¸»è¦é€šè¿‡è¿™ä¸ªå» New ä¸€ä¸ªActivity æ¥æ¨¡æ‹ŸåŸç”ŸActivityç®¡ç†&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æ’ä»¶å†…éƒ¨çš„è·³è½¬å…¶å®ä¹Ÿå°±æ˜¯åœ¨å¼€åŒä¸€ä¸ªactivity&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;70&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;ProxyActivity&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;AppCompatActivity&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; ProxyActivityInterface pluginObj;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onCreate&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(Bundle savedInstanceState)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;super&lt;/span&gt;.onCreate(savedInstanceState);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//åœ¨è¿™é‡Œæ‹¿åˆ°äº†çœŸå®è·³è½¬çš„activity æ‹¿å‡ºæ¥ å†å»å¯åŠ¨çœŸå®çš„activity&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        String className = getIntent().getStringExtra(&lt;span class=&#34;string&#34;&gt;&amp;quot;ClassName&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//é€šè¿‡åå°„åœ¨å»å¯åŠ¨ä¸€ä¸ªçœŸå®çš„activity æ‹¿åˆ°Classå¯¹è±¡&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;try&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            Class&amp;lt;?&amp;gt; plugClass = getClassLoader().loadClass(className);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            Constructor&amp;lt;?&amp;gt; pluginConstructor = plugClass.getConstructor(&lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; Class[]&amp;#123;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;//å› ä¸ºæ’ä»¶çš„activityå®ç°äº†æˆ‘ä»¬çš„æ ‡å‡†&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            pluginObj = (ProxyActivityInterface) pluginConstructor.newInstance(&lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; Object[]&amp;#123;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            pluginObj.attach(&lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;);&lt;span class=&#34;comment&#34;&gt;//æ³¨å…¥ä¸Šä¸‹æ–‡&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            pluginObj.onCreate(&lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; Bundle());&lt;span class=&#34;comment&#34;&gt;//ä¸€å®šè¦è°ƒç”¨onCreate &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;catch&lt;/span&gt; (Exception e) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (e.getClass().getSimpleName() .equals(&lt;span class=&#34;string&#34;&gt;&amp;quot;ClassCastException&amp;quot;&lt;/span&gt;))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;comment&#34;&gt;//æˆ‘è¿™é‡Œæ˜¯ç›´æ¥æ‹¿åˆ°å¼‚å¸¸åˆ¤æ–­çš„ ï¼Œä¹Ÿå¯çš„ æ‹¿åˆ°ä¸Šé¢çš„plugClasså¯¹è±¡åˆ¤æ–­æœ‰æ²¡æœ‰å®ç°æˆ‘ä»¬çš„æ¥å£&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                finish();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                Toast.makeText(&lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;éæ³•é¡µé¢&amp;quot;&lt;/span&gt;,Toast.LENGTH_LONG).show();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            e.printStackTrace();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//ä¸ºä»€ä¹ˆè¦é‡å†™è¿™ä¸ªå‘¢ å› ä¸ºè¿™ä¸ªæ˜¯æ’ä»¶å†…éƒ¨startactivityè°ƒç”¨çš„ å°†çœŸæ­£è¦å¼€å¯çš„activityçš„ç±»åç©¿è¿‡æ¥&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//ç„¶åå–å‡ºæ¥ï¼Œå¯åŠ¨æˆ‘ä»¬çš„å å‘çš„activity åœ¨æˆ‘ä»¬çœŸæ­£è¦å¯åŠ¨çš„èµ›è¿›å»&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;startActivity&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(Intent intent)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        String className1=intent.getStringExtra(&lt;span class=&#34;string&#34;&gt;&amp;quot;ClassName&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        Intent intent1 = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; Intent(&lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;, ProxyActivity.class);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        intent1.putExtra(&lt;span class=&#34;string&#34;&gt;&amp;quot;ClassName&amp;quot;&lt;/span&gt;, className1);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;super&lt;/span&gt;.startActivity(intent1);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//é‡å†™classLoader&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; ClassLoader &lt;span class=&#34;title&#34;&gt;getClassLoader&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; HookManager.getInstance().getClassLoader();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//é‡å†™Resource&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; Resources &lt;span class=&#34;title&#34;&gt;getResources&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; HookManager.getInstance().getResource();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onStart&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;super&lt;/span&gt;.onStart();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        pluginObj.onStart();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onDestroy&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;super&lt;/span&gt;.onDestroy();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        pluginObj.onDestroy();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onPause&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;super&lt;/span&gt;.onPause();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        pluginObj.onPause();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æ’ä»¶apkå’Œèµ„æºåŠ è½½å¤„ç†-Hookmanager:&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;97&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;HookManager&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; HookManager ourInstance = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; HookManager();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; Resources resources;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; DexClassLoader loader;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; PackageInfo packageInfo;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;static&lt;/span&gt; HookManager &lt;span class=&#34;title&#34;&gt;getInstance&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; ourInstance;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;HookManager&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// å¤åˆ¶æ’ä»¶åˆ°ç¼“å­˜ç›®å½•,æ–¹ä¾¿åŠ è½½&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;loadPlugin&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(Activity activity)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// å‡å¦‚è¿™é‡Œæ˜¯ä»ç½‘ç»œè·å–çš„æ’ä»¶ æˆ‘ä»¬ç›´æ¥ä»sdå¡è·å– ç„¶åè¯»å–åˆ°æˆ‘ä»¬çš„cacheç›®å½•&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        String pluginName = &lt;span class=&#34;string&#34;&gt;&amp;quot;plugin.apk&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        File filesDir = activity.getDir(&lt;span class=&#34;string&#34;&gt;&amp;quot;plugin&amp;quot;&lt;/span&gt;, activity.MODE_PRIVATE);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        String filePath = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; File(filesDir, pluginName).getAbsolutePath();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        File file = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; File(filePath);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (file.exists()) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            file.delete();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        FileInputStream is = &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        FileOutputStream os = &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//è¯»å–çš„ç›®å½•&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;try&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            is = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; FileInputStream(&lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; File(Environment.getExternalStorageDirectory(), pluginName));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;//è¦è¾“å…¥çš„ç›®å½•&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            os = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; FileOutputStream(filePath);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;catch&lt;/span&gt; (FileNotFoundException e) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            e.printStackTrace();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;try&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; len = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;byte&lt;/span&gt;[] buffer = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;byte&lt;/span&gt;[&lt;span class=&#34;number&#34;&gt;1024&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;while&lt;/span&gt; ((len = is.read(buffer)) != -&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                os.write(buffer, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, len);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            File f = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; File(filePath);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (f.exists()) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                Toast.makeText(activity, &lt;span class=&#34;string&#34;&gt;&amp;quot;dex overwrite&amp;quot;&lt;/span&gt;, Toast.LENGTH_SHORT).show();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            loadPathToPlugin(activity);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;catch&lt;/span&gt; (IOException e) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;// TODO Auto-generated catch block&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            e.printStackTrace();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;finally&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;try&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                os.close();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                is.close();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125; &lt;span class=&#34;keyword&#34;&gt;catch&lt;/span&gt; (IOException e) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;comment&#34;&gt;// TODO Auto-generated catch block&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                e.printStackTrace();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;loadPathToPlugin&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(Activity activity)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        File filesDir = activity.getDir(&lt;span class=&#34;string&#34;&gt;&amp;quot;plugin&amp;quot;&lt;/span&gt;, activity.MODE_PRIVATE);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        String name = &lt;span class=&#34;string&#34;&gt;&amp;quot;plugin.apk&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        String path = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; File(filesDir, name).getAbsolutePath();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//ç„¶åæˆ‘ä»¬å¼€å§‹åŠ è½½æˆ‘ä»¬çš„apk ä½¿ç”¨DexClassLoader&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        File dexOutDir = activity.getDir(&lt;span class=&#34;string&#34;&gt;&amp;quot;dex&amp;quot;&lt;/span&gt;, activity.MODE_PRIVATE);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        loader = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; DexClassLoader(path, dexOutDir.getAbsolutePath(), &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;, activity.getClassLoader());&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//é€šè¿‡PackAgemanager æ¥è·å–æ’ä»¶çš„ç¬¬ä¸€ä¸ªactivityæ˜¯å“ªä¸€ä¸ª&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        PackageManager packageManager = activity.getPackageManager();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        packageInfo = packageManager.getPackageArchiveInfo(path, PackageManager.GET_ACTIVITIES);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//ç„¶åå¼€å§‹åŠ è½½æˆ‘ä»¬çš„èµ„æº è‚¯å®šè¦ä½¿ç”¨Resource ä½†æ˜¯å®ƒæ˜¯AssetManageråˆ›å»ºå‡ºæ¥çš„ å°±æ˜¯AssertManager æœ‰ä¸€ä¸ªaddAssertPath è¿™ä¸ªæ–¹æ³• ä½†æ˜¯ç§æœ‰çš„ æ‰€æœ‰ä½¿ç”¨åå°„&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        Class&amp;lt;?&amp;gt; assetManagerClass = AssetManager.class;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;try&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            AssetManager assertManagerObj = (AssetManager) assetManagerClass.newInstance();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            Method addAssetPathMethod = assetManagerClass.getMethod(&lt;span class=&#34;string&#34;&gt;&amp;quot;addAssetPath&amp;quot;&lt;/span&gt;, String.class);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            addAssetPathMethod.setAccessible(&lt;span class=&#34;keyword&#34;&gt;true&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            addAssetPathMethod.invoke(assertManagerObj, path);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;//åœ¨åˆ›å»ºä¸€ä¸ªResource&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            resources = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; Resources(assertManagerObj, activity.getResources().getDisplayMetrics(), activity.getResources().getConfiguration());&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;catch&lt;/span&gt; (Exception e) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            e.printStackTrace();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//å¯¹å¤–æä¾›æ’ä»¶çš„classLoader&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; ClassLoader &lt;span class=&#34;title&#34;&gt;getClassLoader&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; loader;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//æ’ä»¶ä¸­çš„Resource&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; Resources &lt;span class=&#34;title&#34;&gt;getResource&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; resources;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ç°åœ¨ä¸»Appå¯ä»¥å®ç°æ’ä»¶åŒ–åŠŸèƒ½äº†&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// åŠ è½½å¯¹åº”æ’ä»¶&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;HookManager.getInstance().loadPlugin(&lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// é€šè¿‡è·³åˆ°ProxyActivity æ¥æ¨¡æ‹Ÿå®ç°å¯¹åº”æ’ä»¶Activity&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Intent intent = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; Intent(&lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;, ProxyActivity.class);&lt;span class=&#34;comment&#34;&gt;//è¿™é‡Œå°±æ˜¯ä¸€ä¸ªå å‘çš„activity&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//è¿™é‡Œæ˜¯æ‹¿åˆ°æˆ‘ä»¬åŠ è½½çš„æ’ä»¶çš„ç¬¬ä¸€ä¸ªactivityçš„å…¨ç±»å&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;intent.putExtra(&lt;span class=&#34;string&#34;&gt;&amp;quot;ClassName&amp;quot;&lt;/span&gt;,HookManager.getInstance().packageInfo.activities[&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;].name);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;startActivity(intent);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;é€šè¿‡è¿™ç§ä»£ç†æ¨¡æ‹Ÿæ–¹å¼ä¹Ÿå¯ä»¥å®ç° Serviceã€BroadcastReceiverã€ContentProviderç»„ä»¶çš„ä»£ç†&lt;/p&gt;
&lt;h5 id=&#34;é—®é¢˜&#34;&gt;é—®é¢˜&lt;a title=&#34;#é—®é¢˜&#34; href=&#34;#é—®é¢˜&#34;&gt;&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;æ³¨æ„äº‹é¡¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ProxyActivityä¸­éœ€è¦é‡å†™getResoucesï¼ŒgetAssetsï¼ŒgetClassLoaderæ–¹æ³•è¿”å›æ’ä»¶çš„ç›¸åº”å¯¹è±¡ã€‚ç”Ÿå‘½å‘¨æœŸå‡½æ•°ä»¥åŠå’Œç”¨æˆ·äº¤äº’ç›¸å…³å‡½æ•°ï¼Œå¦‚onResumeï¼ŒonStopï¼ŒonBackPressedonï¼ŒKeyUponWindowï¼ŒFocusChangedç­‰éœ€è¦è½¬å‘ç»™æ’ä»¶ã€‚&lt;/li&gt;
&lt;li&gt;PluginActivityä¸­æ‰€æœ‰è°ƒç”¨contextçš„ç›¸å…³çš„æ–¹æ³•ï¼Œå¦‚setContentViewï¼ŒgetLayoutInflaterï¼ŒgetSystemServiceç­‰éƒ½éœ€è¦è°ƒç”¨ProxyActivityçš„ç›¸åº”æ–¹æ³•ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç¼ºç‚¹&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ’ä»¶ä¸­çš„Activityå¿…é¡»ç»§æ‰¿PluginActivityï¼Œå¼€å‘ä¾µå…¥æ€§å¼ºã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœæƒ³æ”¯æŒActivityçš„singleTaskï¼ŒsingleInstanceç­‰launchModeæ—¶ï¼Œéœ€è¦è‡ªå·±ç®¡ç†Activityæ ˆï¼Œå®ç°èµ·æ¥å¾ˆç¹çã€‚&lt;/li&gt;
&lt;li&gt;æ’ä»¶ä¸­éœ€è¦å°å¿ƒå¤„ç†Contextï¼Œå®¹æ˜“å‡ºé”™ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœæƒ³æŠŠä¹‹å‰çš„æ¨¡å—æ”¹é€ æˆæ’ä»¶éœ€è¦å¾ˆå¤šé¢å¤–çš„å·¥ä½œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¯¥æ–¹å¼è™½ç„¶èƒ½å¤Ÿå¾ˆå¥½çš„å®ç°å¯åŠ¨æ’ä»¶Activityçš„ç›®çš„ï¼Œä½†æ˜¯ç”±äºå¼€å‘å¼ä¾µå…¥æ€§å¾ˆå¼ºï¼Œdynamic-load-apkä¹‹åçš„æ’ä»¶åŒ–æ–¹æ¡ˆå¾ˆå°‘ç»§ç»­ä½¿ç”¨è¯¥æ–¹å¼ï¼Œè€Œæ˜¯é€šè¿‡hookç³»ç»Ÿå¯åŠ¨Activityçš„è¿‡ç¨‹ï¼Œè®©å¯åŠ¨æ’ä»¶ä¸­çš„Activityåƒå¯åŠ¨ä¸»å·¥ç¨‹çš„Activityä¸€æ ·ç®€å•ã€‚&lt;/p&gt;
&lt;h4 id=&#34;åŠ¨æ€æ›¿æ¢æ–¹æ¡ˆï¼šæä¾›å¯¹androidåº•å±‚çš„å„ç§ç±»è¿›è¡Œhookï¼Œæ¥å®ç°åŠ è½½æ’ä»¶ä¸­çš„å››å¤§ç»„ä»¶ï¼Œä»¥droidpluginæ¡†æ¶ä¸ºä»£è¡¨&#34;&gt;åŠ¨æ€æ›¿æ¢æ–¹æ¡ˆï¼šæä¾›å¯¹Androidåº•å±‚çš„å„ç§ç±»è¿›è¡ŒHookï¼Œæ¥å®ç°åŠ è½½æ’ä»¶ä¸­çš„å››å¤§ç»„ä»¶ï¼Œä»¥DroidPluginæ¡†æ¶ä¸ºä»£è¡¨&lt;a title=&#34;#åŠ¨æ€æ›¿æ¢æ–¹æ¡ˆï¼šæä¾›å¯¹androidåº•å±‚çš„å„ç§ç±»è¿›è¡Œhookï¼Œæ¥å®ç°åŠ è½½æ’ä»¶ä¸­çš„å››å¤§ç»„ä»¶ï¼Œä»¥droidpluginæ¡†æ¶ä¸ºä»£è¡¨&#34; href=&#34;#åŠ¨æ€æ›¿æ¢æ–¹æ¡ˆï¼šæä¾›å¯¹androidåº•å±‚çš„å„ç§ç±»è¿›è¡Œhookï¼Œæ¥å®ç°åŠ è½½æ’ä»¶ä¸­çš„å››å¤§ç»„ä»¶ï¼Œä»¥droidpluginæ¡†æ¶ä¸ºä»£è¡¨&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;å®ç°æ–¹æ¡ˆ:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Hook Instrumentå®ç°&lt;/li&gt;
&lt;li&gt;Hook Handlerå®ç°&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä»£ç Demo:&lt;a href=&#34;https://github.com/Onion99/AndroidComponentPlugin&#34; target=&#34;_blank&#34;&gt;Onion99/AndroidComponentPlugin: Androidä¸Šç®€å•å®ç°å››å¤§ç»„ä»¶çš„æ’ä»¶åŒ–&lt;/a&gt;&lt;br&gt;
å‚è€ƒ : &lt;a href=&#34;https://developer.aliyun.com/article/873723?spm=a2c6h.12883283.0.0.67d543078VqvHa&amp;amp;scm=20140722.ID_873723.P_121.MO_938-ST_5186-V_1-ID_873723-OR_rec&#34; target=&#34;_blank&#34;&gt;Android Hookå‘Šè¯‰ä½  å¦‚ä½•å¯åŠ¨æœªæ³¨å†Œçš„Activity&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;refer&#34;&gt;Refer&lt;a title=&#34;#refer&#34; href=&#34;#refer&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.jianshu.com/p/71585d744076&#34; target=&#34;_blank&#34;&gt;Androidæ’ä»¶åŒ–(ä¸€))&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://zhuanlan.zhihu.com/p/33017826&#34; target=&#34;_blank&#34;&gt;æ·±å…¥ç†è§£Androidæ’ä»¶åŒ–æŠ€æœ¯ - çŸ¥ä¹ (zhihu.com)&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://blog.csdn.net/n_fly/article/details/113865650&#34; target=&#34;_blank&#34;&gt;Androidæ’ä»¶åŒ–å®ç°æ–¹æ¡ˆ_å®‰å“æ’ä»¶åŒ–&lt;/a&gt;&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://onion99.github.io/2022/03/08/phzbEh3JEzAC0XwD/</guid>
            <title>Androidé»‘ç§‘æŠ€ - çƒ­ä¿®å¤</title>
            <link>https://onion99.github.io/2022/03/08/phzbEh3JEzAC0XwD/</link>
            <category>é»‘ç§‘æŠ€</category>
            <pubDate>Tue, 08 Mar 2022 06:38:05 +0800</pubDate>
            <description><![CDATA[ &lt;blockquote&gt;
&lt;p&gt;çƒ­ä¿®å¤æœ¬è´¨å°±æ˜¯å°†é”™è¯¯çš„ä»£ç æ›¿æ¢æˆæ­£ç¡®çš„ä»£ç ,ä½†è¿™é‡Œçš„æ›¿æ¢ä¸æ˜¯æ”¹å†™åŸæœ‰çš„ä»£ç ,è€Œæ˜¯æä¾›ä¸€ä»½æ–°çš„æ­£ç¡®çš„ä»£ç ,è®©åº”ç”¨è¿è¡Œæ—¶ç»•è¿‡é”™è¯¯çš„ä»£ç ,ä»è€Œæ‰§è¡Œæ­£ç¡®çš„ä»£ç &lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&#34;https://s1.ax1x.com/2022/03/06/bDtcIx.png&#34; alt=&#34;bDtcIx.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;p&gt;åŸºç¡€çŸ¥è¯†:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://fullstackaction.com/pages/ccf9c0/#%E4%B8%80%E3%80%81dex-class-%E6%B5%85%E6%9E%90&#34; target=&#34;_blank&#34;&gt;çƒ­ä¿®å¤ä¸æ’ä»¶åŒ–åŸºç¡€ - dexä¸class&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://fullstackaction.com/pages/1084c4/&#34; target=&#34;_blank&#34;&gt;çƒ­ä¿®å¤ä¸æ’ä»¶åŒ–åŸºç¡€ - Javaä¸Androidè™šæ‹Ÿæœº&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://fullstackaction.com/pages/a5eb80/&#34; target=&#34;_blank&#34;&gt;çƒ­ä¿®å¤ä¸æ’ä»¶åŒ–åŸºç¡€ - Javaä¸Androidçš„ç±»åŠ è½½å™¨&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;å®ç°æ–¹æ¡ˆ&#34;&gt;å®ç°æ–¹æ¡ˆ&lt;a title=&#34;#å®ç°æ–¹æ¡ˆ&#34; href=&#34;#å®ç°æ–¹æ¡ˆ&#34;&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id=&#34;nativeå±‚æ›¿æ¢æ–¹æ¡ˆ&#34;&gt;Nativeå±‚æ›¿æ¢æ–¹æ¡ˆ&lt;a title=&#34;#nativeå±‚æ›¿æ¢æ–¹æ¡ˆ&#34; href=&#34;#nativeå±‚æ›¿æ¢æ–¹æ¡ˆ&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;åº•å±‚æ›¿æ¢ï¼Œä¿®æ”¹javaæ–¹æ³•åœ¨nativeå±‚çš„å‡½æ•°æŒ‡é’ˆï¼ŒæŒ‡å‘ä¿®å¤åçš„æ–¹æ³•ä»¥è¾¾åˆ°ä¿®å¤ç›®çš„&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Android/Javaä»£ç çš„æœ€å°ç»„ç»‡æ–¹å¼æ˜¯æ–¹æ³•ï¼ˆMethodï¼Œå®é™…ä¸Šï¼Œæ¯ä¸€ä¸ªdexæ–‡ä»¶æœ€å¤šå¯ä»¥åŒ…å«65536ï¼ˆ0xffffï¼‰ä¸ªæ–¹æ³•ï¼‰ï¼Œæ¯ä¸ªæ–¹æ³•åœ¨ARTè™šæ‹Ÿæœºä¸­éƒ½æœ‰ä¸€ä¸ªArtMethodç»“æ„ä½“æŒ‡é’ˆä¸ä¹‹å¯¹åº”ï¼ŒArtMethodç»“æ„ä½“ä¸­åŒ…å«äº†Javaæ–¹æ³•çš„æ‰€æœ‰ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ‰§è¡Œå…¥å£ã€è®¿é—®æƒé™ã€æ‰€å±ç±»å’Œä»£ç æ‰§è¡Œåœ°å€ç­‰ç­‰ã€‚æ¢å¥è¯è¯´ï¼Œè™šæ‹Ÿæœºå°±æ˜¯é€šè¿‡ArtMethodç»“æ„ä½“æ¥æ“çºµJavaæ–¹æ³•çš„ã€‚ArtMethodç»“æ„å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight c++&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;ArtMethod&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;FINAL&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;...&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;protected&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  GcRoot&amp;lt;mirror::Class&amp;gt; declaring_class_;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  std::atomic&amp;lt;std::&lt;span class=&#34;keyword&#34;&gt;uint32_t&lt;/span&gt;&amp;gt; access_flags_;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;comment&#34;&gt;// Offset to the CodeItem.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;uint32_t&lt;/span&gt; dex_code_item_offset_;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;comment&#34;&gt;// Index into method_ids of the dex file associated with this method.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;uint32_t&lt;/span&gt; dex_method_index_;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;uint16_t&lt;/span&gt; method_index_;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;uint16_t&lt;/span&gt; hotness_count_;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;PtrSizedFields&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// Depending on the method type, the data is&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//   - native method: pointer to the JNI function registered to this method&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//                    or a function to resolve the JNI function,&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//   - conflict method: ImtConflictTable,&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//   - abstract/interface method: the single-implementation if any,&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//   - proxy method: the original interface method or constructor,&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//   - other methods: the profiling data.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt;* data_;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// Method dispatch from quick compiled code invokes this pointer which may cause bridging into&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// the interpreter.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt;* entry_point_from_quick_compiled_code_;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  ptr_sized_fields_;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;...&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ï½&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å…¶ä¸­æœ‰ä¸€ä¸ªå…³é”®æŒ‡é’ˆï¼Œå®ƒæ˜¯æ–¹æ³•çš„æ‰§è¡Œå…¥å£ï¼š&lt;br&gt;
&lt;code&gt;entry_point_from_quick_compiled_code_&lt;/code&gt;&lt;br&gt;
ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªæŒ‡é’ˆæŒ‡å‘æ–¹æ³•ä½“ç¼–è¯‘åå¯¹åº”çš„æ±‡ç¼–æŒ‡ä»¤ã€‚é‚£ä¹ˆï¼Œå¦‚æœæˆ‘ä»¬èƒ½hookè¿™ä¸ªæŒ‡é’ˆï¼Œç”±åŸæ¥æŒ‡å‘æœ‰bugçš„æ–¹æ³•ï¼Œå˜æˆæŒ‡å‘æ­£ç¡®çš„æ–¹æ³•ï¼Œå°±è¾¾åˆ°äº†ä¿®å¤çš„ç›®çš„ã€‚è¿™å°±æ˜¯nativeå±‚æ›¿æ¢æ–¹æ¡ˆçš„æ ¸å¿ƒåŸç†ã€‚å…·ä½“å®ç°æ–¹æ¡ˆå¯ä»¥æ˜¯æ”¹å˜æŒ‡é’ˆæŒ‡å‘ï¼ˆAndFixï¼‰ï¼Œä¹Ÿå¯ä»¥ç›´æ¥æ›¿æ¢æ•´ä¸ªç»“æ„ä½“ï¼ˆSophixï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåº•å±‚æ›¿æ¢æ–¹æ¡ˆè™½ç„¶æ˜¯å³ä½¿ç”Ÿæ•ˆçš„ï¼Œä½†æ˜¯å› ä¸ºä¸ä¼šåŠ è½½æ–°ç±»ï¼Œè€Œæ˜¯ç›´æ¥ä¿®æ”¹åŸç±»ï¼Œæ‰€ä»¥ä¿®æ”¹çš„ä»£ç ä¸èƒ½å¢åŠ æ–°çš„æ–¹æ³•ï¼Œå¦åˆ™ä¼šé€ æˆç´¢å¼•æ•°ä¸æ–¹æ³•æ•°ä¸åŒ¹é…ï¼Œæ— æ³•é€šè¿‡ç´¢å¼•æ‰¾åˆ°æ­£ç¡®æ–¹æ³•ï¼Œå­—æ®µåŒç†&lt;/p&gt;
&lt;h3 id=&#34;ç±»åŠ è½½æ–¹æ¡ˆ&#34;&gt;ç±»åŠ è½½æ–¹æ¡ˆ&lt;a title=&#34;#ç±»åŠ è½½æ–¹æ¡ˆ&#34; href=&#34;#ç±»åŠ è½½æ–¹æ¡ˆ&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;åŠ è½½ä¸€ä¸ªç±»çš„æ—¶å€™ï¼Œéƒ½ä¼šå»å¾ªç¯dexElementsæ•°ç»„å–å‡ºé‡Œé¢çš„dexæ–‡ä»¶ï¼Œç„¶åä»dexæ–‡ä»¶ä¸­æ‰¾ç›®æ ‡ç±»ï¼Œåªè¦ç›®æ ‡ç±»æ‰¾åˆ°ï¼Œåˆ™ç›´æ¥é€€å‡ºå¾ªç¯ï¼Œä¹Ÿå°±æ˜¯åé¢çš„dexæ–‡ä»¶å°±æ²¡æœ‰è¢«å–åˆ°çš„æœºä¼šã€‚å°†çƒ­ä¿®å¤çš„ç±»æ”¾åœ¨dexElements[]çš„æœ€å‰é¢ï¼Œè¿™æ ·åŠ è½½ç±»æ—¶ &lt;strong&gt;ä¼šä¼˜å…ˆåŠ è½½åˆ°è¦ä¿®å¤çš„ç±»&lt;/strong&gt;ä»¥è¾¾åˆ°ä¿®å¤ç›®çš„&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&#34;https://s1.ax1x.com/2022/03/06/bDduwj.png&#34; alt=&#34;bDduwj.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;p&gt;åŸºäºjvmçš„javaåº”ç”¨æ˜¯é€šè¿‡ClassLoaderæ¥åŠ è½½åº”ç”¨ä¸­çš„classçš„ï¼ŒAndroidå¯¹JVMä¼˜åŒ–è¿‡ï¼Œä½¿ç”¨çš„æ˜¯ART(ä»¥å‰æ˜¯Dalvik)ï¼Œclassæ–‡ä»¶ä¼šè¢«æ‰“åŒ…è¿›dexæ–‡ä»¶ä¸­ï¼Œåº•å±‚è™šæ‹Ÿæœºæœ‰æ‰€ä¸åŒï¼Œé‚£ä¹ˆå®ƒä»¬çš„ç±»åŠ è½½å™¨ä¹Ÿä¼šæœ‰æ‰€åŒºåˆ«ï¼Œåœ¨Androidä¸­ï¼Œè¦åŠ è½½dexæ–‡ä»¶ä¸­çš„classæ–‡ä»¶å°±éœ€è¦ç”¨åˆ° PathClassLoader æˆ– DexClassLoader è¿™ä¸¤ä¸ªAndroidä¸“ç”¨çš„ç±»åŠ è½½å™¨ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://s1.ax1x.com/2022/03/07/bsEKiR.png&#34; alt=&#34;bsEKiR.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;åŸç†&#34;&gt;åŸç†&lt;a title=&#34;#åŸç†&#34; href=&#34;#åŸç†&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://s1.ax1x.com/2022/03/07/bsdsXT.png&#34; alt=&#34;bsdsXT.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;ç”Ÿæˆä¿®å¤dex&#34;&gt;ç”Ÿæˆä¿®å¤Dex&lt;a title=&#34;#ç”Ÿæˆä¿®å¤dex&#34; href=&#34;#ç”Ÿæˆä¿®å¤dex&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;1.å°†å‡ºbugçš„ç±»ä¿®æ”¹æ­£ç¡®ï¼Œç„¶åæ‰§è¡Œæ‰“åŒ…æµç¨‹  &lt;a href=&#34;https://imgtu.com/i/bsNkSf&#34; target=&#34;_blank&#34;&gt;&lt;img src=&#34;https://s1.ax1x.com/2022/03/07/bsNkSf.png&#34; alt=&#34;bsNkSf.png&#34; loading=&#34;lazy&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;2.æ­¤æ—¶å–å‡ºå·¥ç¨‹ç›®å½•ä¸‹çš„/build/intermediates/javac/debug/classes/åŒ…è·¯å¾„/æ–‡ä»¶å¤¹ä¸‹å¯¹åº”çš„classæ–‡ä»¶&lt;/p&gt;
&lt;p&gt;3.åœ¨å¤åˆ¶è¿™ä¸ªclassæ–‡ä»¶æ—¶ï¼Œéœ€è¦æŠŠå®ƒæ‰€åœ¨çš„å®Œæ•´åŒ…ç›®å½•ä¸€èµ·å¤åˆ¶ï¼Œç„¶ååœ¨å‘½ä»¤è¡Œä¸‹cdåˆ°è¯¥ç›®å½•ï¼Œæ‰§è¡Œ&lt;code&gt;dx --dex --output=patch.dex åŒ…åè·¯å¾„/éœ€è¦ä¿®å¤çš„ç±»æ–‡ä»¶&lt;/code&gt;,æ­¤æ—¶ä¼šåœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆpatch.dexæ–‡ä»¶  &lt;a href=&#34;https://imgtu.com/i/bsNQf0&#34; target=&#34;_blank&#34;&gt;&lt;img src=&#34;https://s1.ax1x.com/2022/03/07/bsNQf0.png&#34; alt=&#34;bsNQf0.png&#34; loading=&#34;lazy&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;4.ç„¶åå°†patch.dexæ–‡ä»¶å½“æˆè¡¥ä¸åŒ…æ”¾å…¥èµ„æºæ–‡ä»¶å¤¹rawä¸‹å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;æŒ‡ä»¤ä¸ºï¼šdx --dex --output=patch.dex com/xxx/xxx/fixbug.class -&amp;gt; ç”Ÿæˆpatch.dexæ–‡ä»¶&lt;/p&gt;
&lt;p&gt;ä¹Ÿå¯ä»¥å†™æˆï¼šdx --dex --output=patch.jar com/xxx/xxx/fixbug.class -&amp;gt; ç”Ÿæˆpatch.jaræ–‡ä»¶&lt;/p&gt;
&lt;p&gt;ClassLoaderå¯ä»¥åŠ è½½.dexæ–‡ä»¶ï¼Œæˆ–è€….zipã€.jarã€.apkä¸­åŒ…å«çš„.dexæ–‡ä»¶&lt;/p&gt;
&lt;h4 id=&#34;å®è·µ&#34;&gt;å®è·µ&lt;a title=&#34;#å®è·µ&#34; href=&#34;#å®è·µ&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Application:&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;/**&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; * ä¹‹æ‰€ä»¥è¦åœ¨æœ¬ç±»ä¸­åšè¡¥ä¸åŒ…çš„å®‰è£…æ˜¯å› ä¸ºæ€•å¦‚æœåœ¨åé¢çš„æµç¨‹ä¸­åšå®‰è£…ä¼šé€ æˆæœ‰äº›å¸¦bugçš„ç±»å¦‚æœå·²ç»è¢«ç³»ç»ŸåŠ è½½çš„è¯ï¼Œåç»­è¡¥ä¸åŒ…å®‰è£…ä¹‹å&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; * è¡¥ä¸åŒ…ä¸­çš„ç±»å¾—ä¸åˆ°æ‰§è¡Œï¼Œå› ä¸ºç±»åŠ è½½æœ‰ç¼“å­˜æœºåˆ¶ï¼Œç³»ç»Ÿä¼šå°†åŠ è½½è¿‡çš„ç±»åšä¸€ä»½å†…å­˜ç¼“å­˜ã€‚&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;MyApplication&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;Application&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onCreate&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;super&lt;/span&gt;.onCreate();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// æ­¤å¤„ä¸ºåŠ è½½è¡¥ä¸åŒ…ï¼Œå…¶å®çœŸå®åº”ç”¨åœºæ™¯æ˜¯ä»æœåŠ¡ç«¯ä¸‹è½½è¡¥ä¸æ–‡ä»¶ï¼Œå› ä¸ºæœ¬å·¥ç¨‹ä¸ºç¤ºä¾‹æ‰€ä»¥ç›´æ¥å°†å…¶æ”¾åœ¨rawèµ„æºæ–‡ä»¶ç›®å½•ä¸‹å»è¯»å–ï¼Œçœå»äº†ä¸‹è½½è¿‡ç¨‹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        File patchFile = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; File(getCacheDir().getAbsolutePath() + File.separator + &lt;span class=&#34;string&#34;&gt;&amp;quot;patch.dex&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;try&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;// ä¸ºäº†é«˜ç‰ˆæœ¬Androidè®¿é—®å¤–éƒ¨å­˜å‚¨éœ€è¦åˆ†åŒºç­‰é—®é¢˜ï¼Œå› ä¸ºæ­¤å¤„ä»…åšç¤ºä¾‹è®²è§£æ‰€ä»¥å°±ç›´æ¥å°†åŒ…æ‹·è´åˆ°ç§æœ‰ç›®å½•ä¸­&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;// æ‹·è´åˆ°ç§æœ‰ç›®å½•ä¸­è¿˜æœ‰ä¸€ä¸ªå¥½å¤„æ˜¯é¿å…åœ¨è¡¥ä¸åŒ…å®‰è£…è¿‡ç¨‹ä¸­åŒ…æ–‡ä»¶è¢«åˆ é™¤é€ æˆå®‰è£…å¤±è´¥&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            copyFile(patchFile);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;// å®‰è£…è¡¥ä¸åŒ…&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            HotFix.installPatch(&lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;, patchFile);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;catch&lt;/span&gt; (IOException e) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            e.printStackTrace();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;copyFile&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(File dest)&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;throws&lt;/span&gt; IOException &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        InputStream input = &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        OutputStream output = &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;try&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;// ç”±äºæœ¬é¡¹ç›®æ˜¯æµ‹è¯•åŠŸèƒ½ï¼Œæ‰€ä»¥è¿™é‡Œç›´æ¥å°†è¡¥ä¸åŒ…æ”¾åœ¨å·¥ç¨‹å†…ï¼ŒçœŸå®å¼€å‘ç¯å¢ƒä¸­åº”è¯¥æ˜¯æ”¾åœ¨æœåŠ¡å™¨ç„¶åä¸‹è½½ä¸‹æ¥&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            input = getResources().openRawResource(R.raw.patch);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            output = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; FileOutputStream(dest);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;byte&lt;/span&gt;[] buf = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;byte&lt;/span&gt;[&lt;span class=&#34;number&#34;&gt;1024&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; bytesRead;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;while&lt;/span&gt; ((bytesRead = input.read(buf)) != -&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                output.write(buf, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, bytesRead);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;finally&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            input.close();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            output.close();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;HotFix.installPatch:&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;91&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;HotFix&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;installPatch&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(Application application, File patch)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (patch == &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt; || !patch.exists()) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;try&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;/**&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;             * 1.è·å–å½“å‰çš„ç±»åŠ è½½å™¨z&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;             */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            ClassLoader classLoader = application.getClassLoader();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;/**&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;             * 2.è·å–åˆ°dexElementså±æ€§ä»¥ä¾¿åç»­å‘å‰è¿½åŠ patch.dex&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;             */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            Field pathListField = ReflectUtils.findField(classLoader, &lt;span class=&#34;string&#34;&gt;&amp;quot;pathList&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            Object pathList = pathListField.get(classLoader);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            Field dexElementsField = ReflectUtils.findField(pathList, &lt;span class=&#34;string&#34;&gt;&amp;quot;dexElements&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            Object[] dexElements = (Object[]) dexElementsField.get(pathList);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;/**&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;             * 3.é€šè¿‡åå°„è°ƒç”¨DexPathListç±»ä¸­çš„makePathElements()æ–¹æ³•å°†patch.dexæœ€ç»ˆè½¬æ¢ä¸ºElement[]æ•°ç»„ï¼Œ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;             * DexPathListä¸€ç³»åˆ—æ–¹æ³•éƒ½æ˜¯ç”¨æ¥å°†è¡¥ä¸åŒ…è½¬æ¢ä¸ºElement[]æ•°ç»„çš„ï¼Œå¦‚makePathElementsï¼ŒmakeDexElements..&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;             * å…·ä½“çš„APIæ ¹æ®çœŸå®APIçš„ç‰ˆæœ¬ä¸åŒæ–¹æ³•å‚æ•°ç­‰å¯èƒ½ä¼šæœ‰å‡ºå…¥ï¼Œæ‰€ä»¥è¿™é‡Œåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­å®é™…ä¸Šåº”è¯¥é€šè¿‡åˆ¤æ–­å»å…¼å®¹å„ä¸ªç‰ˆæœ¬ï¼Œ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;             * æ­¤å¤„å› ä¸ºæ˜¯ç¤ºä¾‹æ‰€ä»¥æ²¡åšå…¼å®¹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;             */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            List&amp;lt;File&amp;gt; files = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; ArrayList&amp;lt;&amp;gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            files.add(patch);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            Method method = ReflectUtils.findMethod(pathList, &lt;span class=&#34;string&#34;&gt;&amp;quot;makePathElements&amp;quot;&lt;/span&gt;, List.class, File.class, List.class);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            ArrayList&amp;lt;IOException&amp;gt; suppressedExceptions = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; ArrayList&amp;lt;&amp;gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            Object[] patchElements = (Object[]) method.invoke(pathList, files, application.getCacheDir(), suppressedExceptions);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;/**&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;             * 4.åˆå¹¶patchElements+dexElements,å°†è¡¥ä¸åŒ…çš„.dexæ–‡ä»¶æ’å…¥æ•°ç»„æœ€å‰é¢ï¼Œåç»­åœ¨åŠ è½½ç±»çš„æ—¶å€™ä¼šä¼˜å…ˆä»ç¬¬ä¸€ä¸ªå¼€å§‹éå†æŸ¥æ‰¾ç±»&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;             */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            Object[] newElements = (Object[]) Array.newInstance(dexElements.getClass().getComponentType(), dexElements.length + patchElements.length);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            System.arraycopy(patchElements, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, newElements, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, patchElements.length);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            System.arraycopy(dexElements, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, newElements, patchElements.length, dexElements.length);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;/**&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;             * 5.å°†æ–°æ•°ç»„ç½®æ¢æ‰BaseDexClassLoader -&amp;gt; pathList -&amp;gt; dexElementså±æ€§ï¼Œè‡³æ­¤å·¥ä½œå®Œæˆ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;             */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            dexElementsField.set(pathList, newElements);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;catch&lt;/span&gt; (Exception e) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            e.printStackTrace();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;ReflectUtils&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;/* æ‰¾åˆ°åå°„å±æ€§ **/&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;static&lt;/span&gt; Field &lt;span class=&#34;title&#34;&gt;findField&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(Object instance, String name)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        Class&amp;lt;?&amp;gt; clz = instance.getClass();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        Field field = &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;while&lt;/span&gt; (clz != Object.class) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;try&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                field = clz.getDeclaredField(name);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                field.setAccessible(&lt;span class=&#34;keyword&#34;&gt;true&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; field;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125; &lt;span class=&#34;keyword&#34;&gt;catch&lt;/span&gt; (NoSuchFieldException e) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                e.printStackTrace();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;//å‘çˆ¶ç±»å¯»æ‰¾å±æ€§&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            clz = clz.getSuperclass();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; field;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;/* æ‰¾åˆ°åå°„å‡½æ•° **/&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;static&lt;/span&gt; Method &lt;span class=&#34;title&#34;&gt;findMethod&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(Object instance, String name, Class&amp;lt;?&amp;gt;... parameterTypes)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        Class&amp;lt;?&amp;gt; clz = instance.getClass();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        Method method = &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;while&lt;/span&gt; (clz != Object.class) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;try&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                method = clz.getDeclaredMethod(name, parameterTypes);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                method.setAccessible(&lt;span class=&#34;keyword&#34;&gt;true&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; method;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125; &lt;span class=&#34;keyword&#34;&gt;catch&lt;/span&gt; (NoSuchMethodException e) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                e.printStackTrace();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;//å‘çˆ¶ç±»å¯»æ‰¾å±æ€§&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            clz = clz.getSuperclass();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; method;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;/* æ‰¾åˆ°åå°„æ‰€æœ‰å‡½æ•°æ•°ç»„ **/&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;static&lt;/span&gt; Method[] findAllMethods(Object instance) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        Class&amp;lt;?&amp;gt; clz = instance.getClass();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; clz.getDeclaredMethods();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å®é™…ä¸Šï¼Œç±»æ›¿æ¢æ–¹æ¡ˆçš„æ ¸å¿ƒæ€æƒ³å°±æ˜¯ï¼šå°†ä¿®æ”¹åçš„patchï¼ˆåŒ…å«bugç±»æ–‡ä»¶ï¼‰æ‰“åŒ…æˆdexæ–‡ä»¶ï¼Œç„¶åhook ClassLoaderåŠ è½½æµç¨‹ï¼Œå°†è¿™ä¸ªdexæ–‡ä»¶æ’å…¥åˆ°Elementæ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚å› ä¸ºåŠ è½½ç±»æ˜¯ä¾æ¬¡è¿›è¡Œçš„ï¼Œæ‰€ä»¥è™šæ‹Ÿæœºä»ç¬¬ä¸€ä¸ªElementæ‰¾åˆ°ç±»åï¼Œå°±ä¸ä¼šå†åŠ è½½bugç±»äº†ã€‚&lt;/p&gt;
&lt;p&gt;ç±»åŠ è½½æ–¹æ¡ˆä¹Ÿæœ‰ç¼ºç‚¹ï¼Œå› ä¸ºç±»åŠ è½½åæ— æ³•å¸è½½ï¼Œæ‰€ä»¥ç±»åŠ è½½æ–¹æ¡ˆå¿…é¡»é‡å¯Appï¼Œè®©bugç±»é‡æ–°åŠ è½½åæ‰èƒ½ç”Ÿæ•ˆ&lt;/p&gt;
&lt;h3 id=&#34;instant-runæ–¹æ¡ˆ&#34;&gt;Instant Runæ–¹æ¡ˆ&lt;a title=&#34;#instant-runæ–¹æ¡ˆ&#34; href=&#34;#instant-runæ–¹æ¡ˆ&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;Instant Run æ–¹æ¡ˆçš„æ ¸å¿ƒæ€æƒ³æ˜¯â€”â€”æ’æ¡©ï¼Œåœ¨ç¼–è¯‘æ—¶é€šè¿‡æ’æ¡©åœ¨æ¯ä¸€ä¸ªæ–¹æ³•ä¸­æ’å…¥ä»£ç ï¼Œä¿®æ”¹ä»£ç é€»è¾‘ï¼Œåœ¨éœ€è¦æ—¶ç»•è¿‡é”™è¯¯æ–¹æ³•ï¼Œè°ƒç”¨patchç±»çš„æ­£ç¡®æ–¹æ³•&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;é¦–å…ˆï¼Œåœ¨ç¼–è¯‘æ—¶Instant Runä¸ºæ¯ä¸ªç±»æ’å…¥IncrementalChangeå˜é‡ï¼š&lt;br&gt;
&lt;code&gt;IncrementalChange  $change;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ä¸ºæ¯ä¸€ä¸ªæ–¹æ³•æ·»åŠ ç±»ä¼¼å¦‚ä¸‹ä»£ç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onCreate&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(Bundle savedInstanceState)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        IncrementalChange var2 = $change;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//$changeä¸ä¸ºnullï¼Œè¡¨ç¤ºè¯¥ç±»æœ‰ä¿®æ”¹ï¼Œéœ€è¦é‡å®šå‘&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(var2 != &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;//é€šè¿‡access$dispatchæ–¹æ³•è·³è½¬åˆ°patchç±»çš„æ­£ç¡®æ–¹æ³•&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            var2.access$dispatch(&lt;span class=&#34;string&#34;&gt;&amp;quot;onCreate.(Landroid/os/Bundle;)V&amp;quot;&lt;/span&gt;, &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; Object[]&amp;#123;&lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;, savedInstanceState&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;super&lt;/span&gt;.onCreate(savedInstanceState);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;.setContentView(&lt;span class=&#34;number&#34;&gt;2130968601&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;.tv = (TextView)&lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;.findViewById(&lt;span class=&#34;number&#34;&gt;2131492944&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å¦‚ä¸Šä»£ç ï¼Œå½“ä¸€ä¸ªç±»è¢«ä¿®æ”¹åï¼ŒInstant Runä¼šä¸ºè¿™ä¸ªç±»æ–°å»ºä¸€ä¸ªç±»ï¼Œå‘½åä¸ºxxx&amp;amp;overrideï¼Œä¸”å®ç°IncrementalChangeæ¥å£ï¼Œå¹¶ä¸”èµ‹å€¼ç»™åŸç±»çš„$changeå˜é‡ã€‚&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;MainActivity&lt;/span&gt;$&lt;span class=&#34;title&#34;&gt;override&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;implements&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;IncrementalChange&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ï½&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æ­¤æ—¶ï¼Œåœ¨è¿è¡Œæ—¶åŸç±»ä¸­æ¯ä¸ªæ–¹æ³•çš„var2 != nullï¼Œé€šè¿‡accessdispatchï¼ˆå‚æ•°æ˜¯æ–¹æ³•åå’ŒåŸå‚æ•°ï¼‰å®šä½åˆ°patchç±»MainActivityoverrideä¸­ä¿®æ”¹åçš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;Instant Runæ˜¯googleåœ¨AS2.0æ—¶ç”¨æ¥å®ç°â€œçƒ­éƒ¨ç½²â€çš„ï¼ŒåŒæ—¶ä¹Ÿä¸ºâ€œçƒ­ä¿®å¤â€æä¾›äº†ä¸€ä¸ªç»ä½³çš„æ€è·¯ã€‚ç¾å›¢çš„Robustå°±æ˜¯åŸºäºæ­¤ã€‚&lt;/p&gt;
&lt;h3 id=&#34;soåº“ä¿®å¤&#34;&gt;SOåº“ä¿®å¤&lt;a title=&#34;#soåº“ä¿®å¤&#34; href=&#34;#soåº“ä¿®å¤&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;h4 id=&#34;æ¥å£è°ƒç”¨æ›¿æ¢&#34;&gt;æ¥å£è°ƒç”¨æ›¿æ¢&lt;a title=&#34;#æ¥å£è°ƒç”¨æ›¿æ¢&#34; href=&#34;#æ¥å£è°ƒç”¨æ›¿æ¢&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;sdkæä¾›æ¥å£æ›¿æ¢Systemé»˜è®¤åŠ è½½soåº“çš„æ¥å£&lt;/p&gt;
&lt;figure class=&#34;highlight kotlin&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;SOPatchManger.loadLibrary(String libName)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//ä»£æ›¿&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;System.loadLibrary(String libName)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;SOPatchManger.loadLibraryæ¥å£åŠ è½½soåº“çš„æ—¶å€™ä¼˜å…ˆå°è¯•å»åŠ è½½sdkæŒ‡å®šç›®å½•ä¸‹è¡¥ä¸çš„soã€‚è‹¥ä¸å­˜åœ¨ï¼Œåˆ™å†å»åŠ è½½å®‰è£…apkç›®å½•ä¸‹çš„soåº“&lt;/p&gt;
&lt;p&gt;ä¼˜ç‚¹ï¼šä¸éœ€è¦å¯¹ä¸åŒsdkç‰ˆæœ¬è¿›è¡Œå…¼å®¹ï¼Œæ‰€ä»¥sdkç‰ˆæœ¬éƒ½æ˜¯System.loadLibraryè¿™ä¸ªæ¥å£&lt;br&gt;
ç¼ºç‚¹ï¼šéœ€è¦ä¾µå…¥ä¸šåŠ¡ä»£ç ï¼Œæ›¿æ¢æ‰Systemé»˜è®¤åŠ è½½soåº“çš„æ¥å£&lt;/p&gt;
&lt;h4 id=&#34;åå°„æ³¨å…¥&#34;&gt;åå°„æ³¨å…¥&lt;a title=&#34;#åå°„æ³¨å…¥&#34; href=&#34;#åå°„æ³¨å…¥&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;é‡‡å–ç±»ä¼¼ç±»ä¿®å¤åå°„æ³¨å…¥æ–¹å¼ï¼Œåªè¦æŠŠè¡¥ä¸soåº“çš„è·¯å¾„æ’å…¥åˆ°nativeLibraryDirectoriesæ•°ç»„çš„æœ€å‰é¢ï¼Œå°±èƒ½å¤Ÿè¾¾åˆ°åŠ è½½soåº“çš„æ—¶å€™æ˜¯è¡¥ä¸soåº“è€Œä¸æ˜¯åŸæ¥soåº“çš„ç›®å½•ï¼Œä»è€Œè¾¾åˆ°ä¿®å¤ã€‚&lt;/p&gt;
&lt;figure class=&#34;highlight typescript&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;title&#34;&gt;findLibrary&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;String&lt;/span&gt; libraryName&lt;/span&gt;)&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;built_in&#34;&gt;String&lt;/span&gt; fileName = System.mapLibraryName(libraryName);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; (NativeLibraryElement element : nativeLibraryPathElements) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;built_in&#34;&gt;String&lt;/span&gt; path = element.findNativeLibrary(fileName);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (path != &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; path;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ä¼˜ç‚¹ï¼šä¸éœ€ä¾µå…¥ç”¨æˆ·æ¥å£è°ƒç”¨&lt;br&gt;
ç¼ºç‚¹ï¼šéœ€è¦åšç‰ˆæœ¬å…¼å®¹æ§åˆ¶ï¼Œå…¼å®¹æ€§è¾ƒå·®&lt;/p&gt;
&lt;h2 id=&#34;çƒ­ä¿®å¤æŠ€æœ¯æ–¹æ¡ˆé€‰å‹&#34;&gt;çƒ­ä¿®å¤æŠ€æœ¯æ–¹æ¡ˆé€‰å‹&lt;a title=&#34;#çƒ­ä¿®å¤æŠ€æœ¯æ–¹æ¡ˆé€‰å‹&#34; href=&#34;#çƒ­ä¿®å¤æŠ€æœ¯æ–¹æ¡ˆé€‰å‹&#34;&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://s1.ax1x.com/2022/03/06/bDwH8x.png&#34; alt=&#34;bDwH8x.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;çƒ­ä¿®å¤å’Œæ’ä»¶åŒ–åŒºåˆ«&#34;&gt;çƒ­ä¿®å¤å’Œæ’ä»¶åŒ–åŒºåˆ«&lt;a title=&#34;#çƒ­ä¿®å¤å’Œæ’ä»¶åŒ–åŒºåˆ«&#34; href=&#34;#çƒ­ä¿®å¤å’Œæ’ä»¶åŒ–åŒºåˆ«&#34;&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;æ’ä»¶åŒ–å’Œçƒ­ä¿®å¤çš„åŸç†ï¼Œéƒ½æ˜¯åŠ¨æ€åŠ è½½ dexï¼apk ä¸­çš„ç±»ï¼èµ„æºï¼Œè®©å®¿ä¸»æ­£å¸¸çš„åŠ è½½å’Œè¿è¡Œæ’ä»¶ï¼ˆè¡¥ä¸ï¼‰ä¸­çš„å†…å®¹&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;æ’ä»¶åŒ–ç›®æ ‡æ˜¯æƒ³æŠŠéœ€è¦å®ç°çš„æ¨¡å—æˆ–åŠŸèƒ½å½“åšä¸€ä¸ªç‹¬ç«‹çš„æå–å‡ºæ¥ï¼Œå‡å°‘å®¿ä¸»çš„è§„æ¨¡ã€‚é‡åœ¨è§£å†³ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸï¼Œä»¥åŠèµ„æºçš„é—®é¢˜&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;çƒ­ä¿®å¤ç›®æ ‡åœ¨ä¿®å¤å·²æœ‰çš„é—®é¢˜ã€‚é‡åœ¨è§£å†³æ›¿æ¢å·²æœ‰çš„æœ‰é—®é¢˜çš„ç±»ï¼æ–¹æ³•ï¼èµ„æºç­‰&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;deemo&#34;&gt;Deemo&lt;a title=&#34;#deemo&#34; href=&#34;#deemo&#34;&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/jiangzhengnan/Syringe&#34; target=&#34;_blank&#34;&gt;jiangzhengnan/Syringe: ğŸ“Œ æ’ä»¶åŒ–æ³¨å…¥å·¥ç¨‹(çƒ­ä¿®å¤+æ’ä»¶åŒ–)&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;refer&#34;&gt;Refer&lt;a title=&#34;#refer&#34; href=&#34;#refer&#34;&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.jianshu.com/p/cb1f0702d59f&#34; target=&#34;_blank&#34;&gt;çƒ­ä¿®å¤â€”â€”æ·±å…¥æµ…å‡ºåŸç†ä¸å®ç°&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://www.cnblogs.com/not2/p/11392733.html&#34; target=&#34;_blank&#34;&gt;çƒ­ä¿®å¤ - è¥¿è´é›ª&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://zhuanlan.zhihu.com/p/109169752&#34; target=&#34;_blank&#34;&gt;Androidçƒ­ä¿®å¤æŠ€æœ¯,ä½ ä¼šæ€ä¹ˆé€‰ï¼Ÿ&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://github.com/BigSweet/hotFixALL&#34; target=&#34;_blank&#34;&gt;BigSweet/hotFixALL: æ•´ç†andfix,thinker,robustçƒ­ä¿®å¤ä½¿ç”¨æ–¹æ³•å’ŒåŸç†&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://github.com/yoyiyi/SoleilNotes/blob/master/Android/%E7%83%AD%E4%BF%AE%E5%A4%8D.md&#34; target=&#34;_blank&#34;&gt;SoleilNotes/çƒ­ä¿®å¤.md at master Â· yoyiyi/SoleilNotes&lt;/a&gt;&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://onion99.github.io/2022/03/08/ukYPIjylHjywfytF/</guid>
            <title>Androidé»‘ç§‘æŠ€ - çƒ­ä¿®å¤å’Œæ’ä»¶åŒ–åŸºç¡€</title>
            <link>https://onion99.github.io/2022/03/08/ukYPIjylHjywfytF/</link>
            <category>é»‘ç§‘æŠ€</category>
            <pubDate>Tue, 08 Mar 2022 06:31:41 +0800</pubDate>
            <description><![CDATA[ &lt;h3 id=&#34;dalvikå’Œ-art&#34;&gt;Dalvikå’Œ ART&lt;a title=&#34;#dalvikå’Œ-art&#34; href=&#34;#dalvikå’Œ-art&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;DVMä¹Ÿæ˜¯å®ç°äº†JVMè§„èŒƒçš„ä¸€ä¸ªè™šæ‹Ÿå™¨ï¼Œé»˜è®¤ä½¿ç”¨CMSåƒåœ¾å›æ”¶å™¨ï¼Œä½†æ˜¯ä¸JVMè¿è¡Œ Class å­—èŠ‚ç ä¸åŒï¼ŒDVM æ‰§è¡Œ Dex(Dalvik Executable Format) â€”â€”ä¸“ä¸º Dalvik è®¾è®¡çš„ä¸€ç§å‹ç¼©æ ¼å¼ã€‚Dex æ–‡ä»¶æ˜¯å¾ˆå¤š .class æ–‡ä»¶å¤„ç†å‹ç¼©åçš„äº§ç‰©ï¼Œæœ€ç»ˆå¯ä»¥åœ¨ Android è¿è¡Œæ—¶ç¯å¢ƒæ‰§è¡Œã€‚&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;p&gt;ARTï¼ˆAndroid Runtimeï¼‰ æ˜¯åœ¨ Android 4.4 ä¸­å¼•å…¥çš„ä¸€ä¸ªå¼€å‘è€…é€‰é¡¹ï¼Œä¹Ÿæ˜¯ Android 5.0 åŠæ›´é«˜ç‰ˆæœ¬çš„é»˜è®¤ Android è¿è¡Œæ—¶ã€‚&lt;/p&gt;
&lt;p&gt;ART å’Œ Dalvik éƒ½æ˜¯è¿è¡Œ Dex å­—èŠ‚ç çš„å…¼å®¹è¿è¡Œæ—¶ï¼Œå› æ­¤é’ˆå¯¹ Dalvik å¼€å‘çš„åº”ç”¨ä¹Ÿèƒ½åœ¨ ART ç¯å¢ƒä¸­è¿ä½œã€‚&lt;/p&gt;
&lt;p&gt;Dalvikå’Œ ARTç¼–è¯‘åŒºåˆ«&lt;br&gt;
&lt;img src=&#34;https://s1.ax1x.com/2022/03/07/bydjWn.png&#34; alt=&#34;bydjWn.png&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://source.android.google.cn/devices/tech/dalvik/gc-debug&#34; target=&#34;_blank&#34;&gt;source.android.google.cn/devices/tecâ€¦&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;dexoptä¸dexaotåŒºåˆ«:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;dexopt&lt;br&gt;
åœ¨Dalvikä¸­è™šæ‹Ÿæœºåœ¨åŠ è½½ä¸€ä¸ªdexæ–‡ä»¶æ—¶ï¼Œå¯¹ dex æ–‡ä»¶ è¿›è¡Œ éªŒè¯ å’Œ ä¼˜åŒ–çš„æ“ä½œï¼Œå…¶å¯¹ dex æ–‡ä»¶çš„ä¼˜åŒ–ç»“æœå˜æˆäº† odex(Optimized dex) æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶å’Œ dex æ–‡ä»¶å¾ˆåƒï¼Œåªæ˜¯ä½¿ç”¨äº†ä¸€äº›ä¼˜åŒ–æ“ä½œç ã€‚&lt;/li&gt;
&lt;li&gt;dex2oat&lt;br&gt;
ART é¢„å…ˆç¼–è¯‘æœºåˆ¶ï¼Œåœ¨å®‰è£…æ—¶å¯¹ dex æ–‡ä»¶æ‰§è¡Œdexoptä¼˜åŒ–ä¹‹åå†å°†odexè¿›è¡Œ AOT æå‰ç¼–è¯‘æ“ä½œï¼Œç¼–è¯‘ä¸ºOATï¼ˆå®é™…ä¸Šæ˜¯ELFæ–‡ä»¶ï¼‰å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆæœºå™¨ç ï¼‰ã€‚ï¼ˆç›¸æ¯”åšè¿‡ODEXä¼˜åŒ–ï¼Œæœªåšè¿‡ä¼˜åŒ–çš„DEXè½¬æ¢æˆOATè¦èŠ±è´¹æ›´é•¿çš„æ—¶é—´ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;ç±»åŠ è½½&#34;&gt;ç±»åŠ è½½&lt;a title=&#34;#ç±»åŠ è½½&#34; href=&#34;#ç±»åŠ è½½&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;ä»»ä½•ä¸€ä¸ª Java ç¨‹åºéƒ½æ˜¯ç”±ä¸€ä¸ªæˆ–å¤šä¸ª class æ–‡ä»¶ç»„æˆï¼Œåœ¨ç¨‹åºè¿è¡Œæ—¶ï¼Œéœ€è¦å°† class æ–‡ä»¶åŠ è½½åˆ° JVM ä¸­æ‰å¯ä»¥ä½¿ç”¨ï¼Œè´Ÿè´£åŠ è½½è¿™äº› class æ–‡ä»¶çš„å°±æ˜¯ Java çš„ç±»åŠ è½½æœºåˆ¶ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Androidä¸­å¸¸ç”¨çš„æœ‰ä¸¤ç§ç±»åŠ è½½å™¨ï¼ŒDexClassLoaderå’ŒPathClassLoaderï¼Œå®ƒä»¬éƒ½ç»§æ‰¿äºBaseDexClassLoaderã€‚ç›¸å…³æºç å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://pic1.zhimg.com/80/v2-43a7045200722c1aea24966765f82570_720w.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;p&gt;åŒºåˆ«åœ¨äºè°ƒç”¨çˆ¶ç±»æ„é€ å™¨æ—¶ï¼ŒDexClassLoaderå¤šä¼ äº†ä¸€ä¸ªoptimizedDirectoryå‚æ•°ï¼Œè¿™ä¸ªç›®å½•å¿…é¡»æ˜¯å†…éƒ¨å­˜å‚¨è·¯å¾„ï¼Œç”¨æ¥ç¼“å­˜ç³»ç»Ÿåˆ›å»ºçš„Dexæ–‡ä»¶ã€‚è€ŒPathClassLoaderè¯¥å‚æ•°ä¸ºnullï¼Œåªèƒ½åŠ è½½å†…éƒ¨å­˜å‚¨ç›®å½•çš„Dexæ–‡ä»¶ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨DexClassLoaderå»åŠ è½½å¤–éƒ¨çš„apkï¼Œç”¨æ³•å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://pic3.zhimg.com/80/v2-280d8e49c4b6aab388bc1f8b906f13f2_720w.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;refer&#34;&gt;Refer&lt;a title=&#34;#refer&#34; href=&#34;#refer&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://juejin.cn/post/7018534681620512805&#34; target=&#34;_blank&#34;&gt;Android çƒ­ä¿®å¤æ ¸å¿ƒåŸç†ï¼ŒClassLoaderç±»åŠ è½½ &lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://blog.csdn.net/qq_35090026/article/details/122909541#:~:text=Android%E4%B8%AD%E7%9A%84ClassLoader%E7%B1%BB%E5%9E%8B%E5%88%86%E5%88%AB%E6%98%AF%E7%B3%BB%E7%BB%9F%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8%E5%92%8C%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8A%A0%E8%BD%BD%E5%99%A8%E3%80%82%20%E5%85%B6%E4%B8%AD%E7%B3%BB%E7%BB%9F%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8%E4%B8%BB%E8%A6%81%E5%8C%85%E6%8B%AC3%E7%A7%8D%EF%BC%8C%E5%88%86%E5%88%AB%E6%98%AF%20BootClassLoader%20%E3%80%81,PathClassLoader%20%E5%92%8C%20DexClassLoader%20%E3%80%82&#34; target=&#34;_blank&#34;&gt;Android ClassLoaderç±»åŠ è½½æœºåˆ¶&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://blog.csdn.net/qq_32506429/article/details/122783941&#34; target=&#34;_blank&#34;&gt;Android ClassLoaderæœºåˆ¶ä¸çƒ­ä¿®å¤&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://blog.csdn.net/xiangzhihong8/article/details/52880327&#34; target=&#34;_blank&#34;&gt;Android ClassLoaderè¯¦è§£&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;åŒäº²å§”æ‰˜æœºåˆ¶&#34;&gt;åŒäº²å§”æ‰˜æœºåˆ¶&lt;a title=&#34;#åŒäº²å§”æ‰˜æœºåˆ¶&#34; href=&#34;#åŒäº²å§”æ‰˜æœºåˆ¶&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;ClassLoaderè°ƒç”¨loadClassæ–¹æ³•åŠ è½½ç±»ï¼Œä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://pic2.zhimg.com/80/v2-20dca70a7fca2413de158563cb7d27d1_720w.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹å‡ºClassLoaderåŠ è½½ç±»æ—¶ï¼Œå…ˆæŸ¥çœ‹è‡ªèº«æ˜¯å¦å·²ç»åŠ è½½è¿‡è¯¥ç±»ï¼Œå¦‚æœæ²¡æœ‰åŠ è½½è¿‡ä¼šé¦–å…ˆè®©çˆ¶åŠ è½½å™¨å»åŠ è½½ï¼Œå¦‚æœçˆ¶åŠ è½½å™¨æ— æ³•åŠ è½½è¯¥ç±»æ—¶æ‰ä¼šè°ƒç”¨è‡ªèº«çš„findClassæ–¹æ³•åŠ è½½ï¼Œè¯¥æœºåˆ¶å¾ˆå¤§ç¨‹åº¦ä¸Šé¿å…äº†ç±»çš„é‡å¤åŠ è½½ã€‚&lt;/p&gt;
&lt;h3 id=&#34;dexclassloaderçš„dexpathlist&#34;&gt;DexClassLoaderçš„DexPathList&lt;a title=&#34;#dexclassloaderçš„dexpathlist&#34; href=&#34;#dexclassloaderçš„dexpathlist&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;DexPathListæ˜¯åœ¨æ„é€ DexClassLoaderæ—¶ç”Ÿæˆçš„ï¼Œå…¶å†…éƒ¨åŒ…å«äº†DexFile&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&#34;https://s1.ax1x.com/2022/03/07/by01BT.png&#34; alt=&#34;by01BT.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;p&gt;DexPathListçš„loadClassä¼šå»éå†DexFileç›´åˆ°æ‰¾åˆ°éœ€è¦åŠ è½½çš„ç±»ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://pic3.zhimg.com/80/v2-ddf43519948c3b9ab3f15ff19cf77dfe_720w.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;p&gt;è…¾è®¯çš„qqç©ºé—´çƒ­ä¿®å¤æŠ€æœ¯æ­£æ˜¯åˆ©ç”¨äº†DexClassLoaderçš„åŠ è½½æœºåˆ¶ï¼Œå°†éœ€è¦æ›¿æ¢çš„ç±»æ·»åŠ åˆ°dexElementsçš„å‰é¢ï¼Œè¿™æ ·ç³»ç»Ÿä¼šä½¿ç”¨å…ˆæ‰¾åˆ°çš„ä¿®å¤è¿‡çš„ç±»ã€‚&lt;/p&gt;
&lt;h3 id=&#34;èµ„æºåŠ è½½&#34;&gt;èµ„æºåŠ è½½&lt;a title=&#34;#èµ„æºåŠ è½½&#34; href=&#34;#èµ„æºåŠ è½½&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Androidç³»ç»Ÿé€šè¿‡Resourceå¯¹è±¡åŠ è½½èµ„æºï¼Œä¸‹é¢ä»£ç å±•ç¤ºäº†è¯¥å¯¹è±¡çš„ç”Ÿæˆè¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://pic1.zhimg.com/80/v2-ab6ea5aad79904422d2fa7d8bc87a64c_720w.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;p&gt;å› æ­¤ï¼Œåªè¦å°†æ’ä»¶apkçš„è·¯å¾„åŠ å…¥åˆ°AssetManagerä¸­ï¼Œä¾¿èƒ½å¤Ÿå®ç°å¯¹æ’ä»¶èµ„æºçš„è®¿é—®ã€‚&lt;/p&gt;
&lt;p&gt;å…·ä½“å®ç°æ—¶ï¼Œç”±äºAssetManagerå¹¶ä¸æ˜¯ä¸€ä¸ªpublicçš„ç±»ï¼Œéœ€è¦é€šè¿‡åå°„å»åˆ›å»ºï¼Œå¹¶ä¸”éƒ¨åˆ†Romå¯¹åˆ›å»ºçš„Resourceç±»è¿›è¡Œäº†ä¿®æ”¹ï¼Œæ‰€ä»¥éœ€è¦è€ƒè™‘ä¸åŒRomçš„å…¼å®¹æ€§ã€‚&lt;/p&gt;
&lt;h3 id=&#34;refer-1&#34;&gt;Refer&lt;a title=&#34;#refer-1&#34; href=&#34;#refer-1&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://zhuanlan.zhihu.com/p/33017826&#34; target=&#34;_blank&#34;&gt;æ·±å…¥ç†è§£Androidæ’ä»¶åŒ–æŠ€æœ¯ &lt;/a&gt;&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://onion99.github.io/2022/03/03/p2ie22dC9NcVwpEH/</guid>
            <title>æºç å­¦ä¹  - LiveData</title>
            <link>https://onion99.github.io/2022/03/03/p2ie22dC9NcVwpEH/</link>
            <category>æºç è§£æ</category>
            <pubDate>Thu, 03 Mar 2022 01:47:39 +0800</pubDate>
            <description><![CDATA[ &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&#34;https://developer.android.google.cn/reference/androidx/lifecycle/LiveData&#34; target=&#34;_blank&#34;&gt;&lt;code&gt;LiveData&lt;/code&gt;&lt;/a&gt; æ˜¯ä¸€ç§å¯è§‚å¯Ÿçš„æ•°æ®å­˜å‚¨å™¨ç±»ã€‚ä¸å¸¸è§„çš„å¯è§‚å¯Ÿç±»ä¸åŒï¼ŒLiveData å…·æœ‰ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥èƒ½åŠ›ï¼Œæ„æŒ‡å®ƒéµå¾ªå…¶ä»–åº”ç”¨ç»„ä»¶ï¼ˆå¦‚ Activityã€Fragment æˆ– Serviceï¼‰çš„ç”Ÿå‘½å‘¨æœŸã€‚è¿™ç§æ„ŸçŸ¥èƒ½åŠ›å¯ç¡®ä¿ LiveData ä»…æ›´æ–°å¤„äºæ´»è·ƒç”Ÿå‘½å‘¨æœŸçŠ¶æ€çš„åº”ç”¨ç»„ä»¶è§‚å¯Ÿè€…&lt;/p&gt;
&lt;/blockquote&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;h3 id=&#34;ä¼˜ç‚¹&#34;&gt;ä¼˜ç‚¹&lt;a title=&#34;#ä¼˜ç‚¹&#34; href=&#34;#ä¼˜ç‚¹&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ç¡®ä¿ç•Œé¢ç¬¦åˆæ•°æ®çŠ¶æ€
&lt;ul&gt;
&lt;li&gt;LiveData éµå¾ªè§‚å¯Ÿè€…æ¨¡å¼ã€‚å½“åº•å±‚æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼ŒLiveData ä¼šé€šçŸ¥ Observer å¯¹è±¡ã€‚æ‚¨å¯ä»¥æ•´åˆä»£ç ä»¥åœ¨è¿™äº› Observer å¯¹è±¡ä¸­æ›´æ–°ç•Œé¢ã€‚è¿™æ ·ä¸€æ¥ï¼Œæ‚¨æ— éœ€åœ¨æ¯æ¬¡åº”ç”¨æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶æ›´æ–°ç•Œé¢ï¼Œå› ä¸ºè§‚å¯Ÿè€…ä¼šæ›¿æ‚¨å®Œæˆæ›´æ–°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä¸ä¼šå‘ç”Ÿå†…å­˜æ³„æ¼
&lt;ul&gt;
&lt;li&gt;è§‚å¯Ÿè€…ä¼šç»‘å®šåˆ° Lifecycle å¯¹è±¡ï¼Œå¹¶åœ¨å…¶å…³è”çš„ç”Ÿå‘½å‘¨æœŸé­åˆ°é”€æ¯åè¿›è¡Œè‡ªæˆ‘æ¸…ç†ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä¸ä¼šå›  Activity åœæ­¢è€Œå¯¼è‡´å´©æºƒ
&lt;ul&gt;
&lt;li&gt;å¦‚æœè§‚å¯Ÿè€…çš„ç”Ÿå‘½å‘¨æœŸå¤„äºéæ´»è·ƒçŠ¶æ€ï¼ˆå¦‚è¿”å›æ ˆä¸­çš„ Activityï¼‰ï¼Œåˆ™å®ƒä¸ä¼šæ¥æ”¶ä»»ä½• LiveData äº‹ä»¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä¸å†éœ€è¦æ‰‹åŠ¨å¤„ç†ç”Ÿå‘½å‘¨æœŸ
&lt;ul&gt;
&lt;li&gt;ç•Œé¢ç»„ä»¶åªæ˜¯è§‚å¯Ÿç›¸å…³æ•°æ®ï¼Œä¸ä¼šåœæ­¢æˆ–æ¢å¤è§‚å¯Ÿã€‚LiveData å°†è‡ªåŠ¨ç®¡ç†æ‰€æœ‰è¿™äº›æ“ä½œï¼Œå› ä¸ºå®ƒåœ¨è§‚å¯Ÿæ—¶å¯ä»¥æ„ŸçŸ¥ç›¸å…³çš„ç”Ÿå‘½å‘¨æœŸçŠ¶æ€å˜åŒ–ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ•°æ®å§‹ç»ˆä¿æŒæœ€æ–°çŠ¶æ€
&lt;ul&gt;
&lt;li&gt;å¦‚æœç”Ÿå‘½å‘¨æœŸå˜ä¸ºéæ´»è·ƒçŠ¶æ€ï¼Œå®ƒä¼šåœ¨å†æ¬¡å˜ä¸ºæ´»è·ƒçŠ¶æ€æ—¶æ¥æ”¶æœ€æ–°çš„æ•°æ®ã€‚ä¾‹å¦‚ï¼Œæ›¾ç»åœ¨åå°çš„ Activity ä¼šåœ¨è¿”å›å‰å°åç«‹å³æ¥æ”¶æœ€æ–°çš„æ•°æ®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é€‚å½“çš„é…ç½®æ›´æ”¹
&lt;ul&gt;
&lt;li&gt;å¦‚æœç”±äºé…ç½®æ›´æ”¹ï¼ˆå¦‚è®¾å¤‡æ—‹è½¬ï¼‰è€Œé‡æ–°åˆ›å»ºäº† Activity æˆ– Fragmentï¼Œå®ƒä¼šç«‹å³æ¥æ”¶æœ€æ–°çš„å¯ç”¨æ•°æ®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å…±äº«èµ„æº
&lt;ul&gt;
&lt;li&gt;æ‚¨å¯ä»¥ä½¿ç”¨å•ä¾‹æ¨¡å¼æ‰©å±• LiveData å¯¹è±¡ä»¥å°è£…ç³»ç»ŸæœåŠ¡ï¼Œä»¥ä¾¿åœ¨åº”ç”¨ä¸­å…±äº«å®ƒä»¬ã€‚LiveData å¯¹è±¡è¿æ¥åˆ°ç³»ç»ŸæœåŠ¡ä¸€æ¬¡ï¼Œç„¶åéœ€è¦ç›¸åº”èµ„æºçš„ä»»ä½•è§‚å¯Ÿè€…åªéœ€è§‚å¯Ÿ LiveData å¯¹è±¡ã€‚å¦‚éœ€äº†è§£è¯¦æƒ…ï¼Œè¯·å‚é˜…æ‰©å±• LiveDataã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;ä½¿ç”¨&#34;&gt;ä½¿ç”¨&lt;a title=&#34;#ä½¿ç”¨&#34; href=&#34;#ä½¿ç”¨&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;figure class=&#34;highlight kotlin&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;DetailVideModel&lt;/span&gt; : &lt;span class=&#34;type&#34;&gt;ViewModel &amp;#123;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	  &lt;span class=&#34;keyword&#34;&gt;val&lt;/span&gt; getTopTabLiveData &lt;span class=&#34;keyword&#34;&gt;by&lt;/span&gt; lazy &amp;#123;  MutableLiveData&amp;lt;&lt;span class=&#34;built_in&#34;&gt;Boolean&lt;/span&gt;&amp;gt;() &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;MediaDetailsActivity&lt;/span&gt; : &lt;span class=&#34;type&#34;&gt;BaseActivity&lt;/span&gt;&lt;/span&gt;()&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	  viewModel.getTopTabLiveData.observe(&lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	       &lt;span class=&#34;comment&#34;&gt;// do some thing    &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;![I8k2xH.png](&lt;a href=&#34;https://z3.ax1x.com/2021/11/08/I8k2xH.png&#34;&gt;https://z3.ax1x.com/2021/11/08/I8k2xH.png&lt;/a&gt; =100x100)&lt;/p&gt;
&lt;h3 id=&#34;observer()åšäº†ä»€ä¹ˆ&#34;&gt;observer()åšäº†ä»€ä¹ˆ&lt;a title=&#34;#observer()åšäº†ä»€ä¹ˆ&#34; href=&#34;#observer()åšäº†ä»€ä¹ˆ&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;å°†æŒ‡å®šäº‹ä»¶è·Ÿç”Ÿå‘½å‘¨æœŸç»‘å®š&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;abstract&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;LiveData&lt;/span&gt;&amp;lt;&lt;span class=&#34;title&#34;&gt;T&lt;/span&gt;&amp;gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;/* åœ¨ç»™å®šæ‰€æœ‰è€…çš„ç”Ÿå‘½å‘¨æœŸå†…å°†ç»™å®šçš„è§‚å¯Ÿè€…æ·»åŠ åˆ°è§‚å¯Ÿè€…åˆ—è¡¨ä¸­ã€‚ */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@MainThread&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;observe&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; LifecycleOwner owner, &lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; Observer&amp;lt;? &lt;span class=&#34;keyword&#34;&gt;super&lt;/span&gt; T&amp;gt; observer)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        assertMainThread(&lt;span class=&#34;string&#34;&gt;&amp;quot;observe&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// åˆ¤æ–­ç”Ÿå‘½å‘¨æœŸä¸ºé”€æ¯,åˆ™å¿½ç•¥&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (owner.getLifecycle().getCurrentState() == DESTROYED) &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// å®ä¾‹ä¸€ä¸ªæ–°çš„ç”Ÿå‘½å‘¨æœŸç»‘å®šè§‚å¯Ÿè€…&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        LifecycleBoundObserver wrapper = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; LifecycleBoundObserver(owner, observer);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// åˆ¤æ–­æ˜¯å¦ä¹‹å‰å·²ç»èµ‹å€¼,æ¥é˜²æ­¢æœ‰ç…ç¬”é‡å¤è°ƒç”¨,ä¸“æ²»ä»£ç æ°´åœŸä¸æœ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        ObserverWrapper existing = mObservers.putIfAbsent(observer, wrapper);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// æ³¨æ„çœ‹LifecycleBoundObserver.isAttachedTo()&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// å¦‚æœä¹‹å‰å·²ç»èµ‹å€¼ä½†åˆæœ‰ç…ç¬”åœ¨ä¸åŒLifecycleOwner(ç”Ÿå‘½å‘¨æœŸç®¡ç†è€…)ä¸­è°ƒç”¨,è¯ä¸å¤šè¯´,ç›´æ¥ç»™crash,googleå°±æ˜¯ç‰›é€¼&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (existing != &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; !existing.isAttachedTo(owner)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;throw&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; IllegalArgumentException(&lt;span class=&#34;string&#34;&gt;&amp;quot;Cannot add the same observer&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    + &lt;span class=&#34;string&#34;&gt;&amp;quot; with different lifecycles&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// å¦‚æœå·²ç»èµ‹å€¼ä¸”ä¸Šé¢ç…ç¬”å¤„ç†æ²¡é—®é¢˜,å°±ä¸å†åšå¤„ç†äº†&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (existing != &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// çœ‹åˆ°äº†æ²¡æœ‰,æ ¸å¿ƒå•Š,ç²¾é«“å•Š,ç»™å½“å‰LifecycleOwneråŠ å…¥Observer(è§‚å¯Ÿè€…),åœ¨ç”Ÿå‘½å‘¨æœŸå„ä¸ªé˜¶æ®µå“åº”äº‹ä»¶&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        owner.getLifecycle().addObserver(wrapper);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#125;   &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;çœ‹çœ‹mObservers.putIfAbsent:&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;/* LinkedListï¼Œå®ƒä¼ªè£…æˆä¸€ä¸ªMapå¹¶æ”¯æŒåœ¨è¿­ä»£æœŸé—´è¿›è¡Œä¿®æ”¹ã€‚å®ƒä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;SafeIterableMap&lt;/span&gt;&amp;lt;&lt;span class=&#34;title&#34;&gt;K&lt;/span&gt;, &lt;span class=&#34;title&#34;&gt;V&lt;/span&gt;&amp;gt; &lt;span class=&#34;keyword&#34;&gt;implements&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;Iterable&lt;/span&gt;&amp;lt;&lt;span class=&#34;title&#34;&gt;Map&lt;/span&gt;.&lt;span class=&#34;title&#34;&gt;Entry&lt;/span&gt;&amp;lt;&lt;span class=&#34;title&#34;&gt;K&lt;/span&gt;, &lt;span class=&#34;title&#34;&gt;V&lt;/span&gt;&amp;gt;&amp;gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;/* å¦‚æœæŒ‡å®šçš„é”®å°šæœªä¸å€¼å…³è”ï¼Œåˆ™å°†å…¶ä¸ç»™å®šå€¼å…³è”,è¿”å›ä¸æŒ‡å®šé”®å…³è”çš„å‰ä¸€ä¸ªå€¼ï¼Œå¦‚æœè¯¥é”®æ²¡æœ‰æ˜ å°„ï¼Œåˆ™null */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; V &lt;span class=&#34;title&#34;&gt;putIfAbsent&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; K key, &lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; V v)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        Entry&amp;lt;K, V&amp;gt; entry = get(key);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// å¦‚æœç»™å®šçš„å€¼å·²ç»å­˜åœ¨,åˆ™è¿”å›å€¼&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (entry != &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;) &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; entry.mValue;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// å¦åˆ™å­˜è¿›å»,çœŸä¼¼å‰å®³å•Š&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        put(key, v);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// è¿”å›ä»£è¡¨ä¹‹å‰ä¸å­˜åœ¨çš„nullå€¼,è¿™å°±æ˜¯ç†è§£æœ‰æœ¨æœ‰ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#125;   &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;çœ‹çœ‹LifecycleBoundObserver :&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;LifecycleBoundObserver&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;ObserverWrapper&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;implements&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;LifecycleEventObserver&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// ç”Ÿå‘½å‘¨æœŸç®¡ç†è€…&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; LifecycleOwner mOwner;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// çœ‹åˆ°è¿™é‡Œæ²¡,ç›´æ¥èµ‹å€¼äº†,æœ‰ä»€ä¹ˆå¥½è¯´çš„&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    LifecycleBoundObserver(&lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; LifecycleOwner owner, Observer&amp;lt;? &lt;span class=&#34;keyword&#34;&gt;super&lt;/span&gt; T&amp;gt; observer) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;super&lt;/span&gt;(observer);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        mOwner = owner;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// æœ‰ç‚¹æ„æ€,è¿™é‡Œåˆ¤æ–­æ˜¯å¦å¤„åœ¨æ´»è·ƒçŠ¶æ€,å°±å¯ä»¥ä»–å¦ˆçš„åšæ­£ç¡®çš„ç”Ÿå‘½å‘¨æœŸå›è°ƒå“åº”&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;shouldBeActive&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; mOwner.getLifecycle().getCurrentState().isAtLeast(STARTED);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onStateChanged&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; LifecycleOwner source,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;            &lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; Lifecycle.Event event)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        Lifecycle.State currentState = mOwner.getLifecycle().getCurrentState();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// è‹¥ç”Ÿå‘½å‘¨æœŸå·²ä¸ºé”€æ¯çŠ¶æ€, åˆ™ç§»é™¤ observer, é¿å…å†…å­˜æ³„éœ²&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (currentState == DESTROYED) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            removeObserver(mObserver);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        Lifecycle.State prevState = &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;while&lt;/span&gt; (prevState != currentState) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            prevState = currentState;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            activeStateChanged(shouldBeActive());&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            currentState = mOwner.getLifecycle().getCurrentState();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// åˆ¤æ–­ä¸¤ä¸ªç”Ÿå‘½å‘¨æœŸç®¡ç†è€…æ˜¯å¦ä¸ºåŒä¸€ä¸ª&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;isAttachedTo&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(LifecycleOwner owner)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; mOwner == owner;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;detachObserver&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        mOwner.getLifecycle().removeObserver(&lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å¥½äº†åˆ°è¿™LiveData.observe()å·²ç»è§‚å¯Ÿå®Œæ¯•äº†,åˆ°çœ‹çœ‹LiveData.postValue()äº†,&lt;br&gt;
åˆ«è¯´,googleè¿˜æ˜¯æœ‰ç‚¹è®²ç©¶çš„,çœ‹çœ‹è¿™ä¸ªå®˜æ–¹æç¤º:&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;liveData.postValue(&lt;span class=&#34;string&#34;&gt;&amp;quot;a&amp;quot;&lt;/span&gt;);&lt;span class=&#34;comment&#34;&gt;// å¼‚æ­¥ä¼ å€¼&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;liveData.setValue(&lt;span class=&#34;string&#34;&gt;&amp;quot;b&amp;quot;&lt;/span&gt;); &lt;span class=&#34;comment&#34;&gt;//åŒæ­¥ä¼ å€¼&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// ç»“æœ: å€¼â€œbâ€å°†é¦–å…ˆè®¾ç½®ï¼Œç„¶åä¸»çº¿ç¨‹å°†ç”¨å€¼â€œaâ€è¦†ç›–å®ƒã€‚&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// å¦‚æœåœ¨æ­¤ä¸»çº¿ç¨‹æ‰§è¡ŒpostValue()ä¹‹å‰å¤šæ¬¡è°ƒç”¨postValue()ï¼Œåˆ™åªä¼šè°ƒåº¦æœ€åä¸€ä¸ªå€¼&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;postvalue()åšäº†ä»€ä¹ˆ&#34;&gt;postValue()åšäº†ä»€ä¹ˆ&lt;a title=&#34;#postvalue()åšäº†ä»€ä¹ˆ&#34; href=&#34;#postvalue()åšäº†ä»€ä¹ˆ&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;ä»–å¦ˆçš„,è¿˜èƒ½åšä»€ä¹ˆ,å°±æ˜¯ä¼ å€¼å•Š,è¿™è¿˜ç”¨è¯´çš„æ–‡ç« åˆ°æ­¤ç»“æŸäº†,ä¸ä¼šå§,ä¸ä¼šå§,å¼‚æ­¥ä¼ å€¼å¾—æ³¨æ„å¤„ç†å¤šçº¿ç¨‹ä¸‹çš„å…±äº«å˜é‡é—®é¢˜å‘¢&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;![I8mrdA.png](&lt;a href=&#34;https://z3.ax1x.com/2021/11/08/I8mrdA.png&#34;&gt;https://z3.ax1x.com/2021/11/08/I8mrdA.png&lt;/a&gt; =100x100)&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;...&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;postValue&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(T value)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; postTask;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   &lt;span class=&#34;keyword&#34;&gt;synchronized&lt;/span&gt; (mDataLock) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;comment&#34;&gt;// åˆ¤æ–­ä¹‹å‰æ˜¯å¦å·²ç»èµ‹å€¼è¿‡äº†&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     postTask = mPendingData == NOT_SET;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;comment&#34;&gt;// ç»™mPendingDataèµ‹å€¼ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     mPendingData = value;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   &lt;span class=&#34;comment&#34;&gt;// çœ‹åˆ°æ²¡æœ‰,ä»–å¦ˆçš„,ä¹‹å‰å·²ç»èµ‹å€¼å°±returnäº†,å¥½æ°”å“¦,å¹²å˜›è¿™æ ·å‘¢&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   &lt;span class=&#34;comment&#34;&gt;// å˜¿,çœ‹ä¸‹mPostValueRunnableæ²¡æœ‰,ä»–å°±æ˜¯é˜²æ­¢ç…ç¬”å¤šçº¿ç¨‹ä¸‹å¤šæ¬¡èµ‹ç›¸åŒå€¼åšçš„&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!postTask) &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   &lt;span class=&#34;comment&#34;&gt;// æŠŠä¼ å€¼çº¿ç¨‹æ”¾åˆ°ä¸»çº¿ç¨‹æ‰§è¡Œ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   ArchTaskExecutor.getInstance().postToMainThread(mPostValueRunnable);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;...&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// æœªèµ‹å€¼çŠ¶æ€&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; Object NOT_SET = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; Object()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// é»˜è®¤å°±æ˜¯æœªèµ‹å€¼çŠ¶æ€&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;volatile&lt;/span&gt; Object mPendingData = NOT_SET&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// ä¼ å€¼çº¿ç¨‹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; Runnable mPostValueRunnable = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; Runnable() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;meta&#34;&gt;@SuppressWarnings(&amp;quot;unchecked&amp;quot;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;run&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// çœ‹åˆ°æ²¡æœ‰,çœŸæ­£ä¼ å€¼éƒ½æ˜¯é€šè¿‡newValueæ¥ä¼ çš„å¥½ä¸å¥½&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    Object newValue;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;synchronized&lt;/span&gt; (mDataLock) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      newValue = mPendingData;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;comment&#34;&gt;// å˜¿å˜¿,è¿™é‡Œå›å½’é»˜è®¤æœªèµ‹å€¼çŠ¶æ€äº†&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      mPendingData = NOT_SET;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// æœ€ç»ˆè¿˜æ˜¯è°ƒåˆ°setValueå•Š,æœç„¶å•Š,æ¡æ¡é“è·¯é€šsetValueå•Š&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    setValue((T) newValue);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;setvalue()&#34;&gt;setValue()&lt;a title=&#34;#setvalue()&#34; href=&#34;#setvalue()&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;æœ‰ä»€ä¹ˆå¥½è¯´çš„,å…¶ä»–çš„ä¸€æªç§’äº†,æˆ‘æ‰æ˜¯ä¼ è¾“æ•°æ®çš„æ ¸å¿ƒä»£ç å¥½ä¸å¥½,å±,dispatchingValueæ‰æ˜¯&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/blockquote&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// è®¾ç½®ä¼ è¾“æ•°æ®ã€‚ å¦‚æœæœ‰æ´»è·ƒçš„ObserverWrapper(è§‚å¯Ÿè€…)ï¼Œå€¼å°†è¢«åˆ†å‘ç»™ä»–ä»¬ã€‚    &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;setValue&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(T value)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  assertMainThread(&lt;span class=&#34;string&#34;&gt;&amp;quot;setValue&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  mVersion++;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  mData = value;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  dispatchingValue(&lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@SuppressWarnings(&amp;quot;WeakerAccess&amp;quot;)&lt;/span&gt; &lt;span class=&#34;comment&#34;&gt;/* synthetic access */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;dispatchingValue&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;meta&#34;&gt;@Nullable&lt;/span&gt; ObserverWrapper initiator)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// åˆ¤æ–­äº‹ä»¶åˆ†å‘æ˜¯å¦å·²ç»åœ¨æ‰§è¡Œ,æ˜¯åˆ™æ‰“æ–­&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (mDispatchingValue) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            mDispatchInvalidated = &lt;span class=&#34;keyword&#34;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// äº‹ä»¶åˆ†å‘å¼€å§‹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        mDispatchingValue = &lt;span class=&#34;keyword&#34;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;do&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            mDispatchInvalidated = &lt;span class=&#34;keyword&#34;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (initiator != &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                considerNotify(initiator);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                initiator = &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; (Iterator&amp;lt;Map.Entry&amp;lt;Observer&amp;lt;? &lt;span class=&#34;keyword&#34;&gt;super&lt;/span&gt; T&amp;gt;, ObserverWrapper&amp;gt;&amp;gt; iterator =&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                        mObservers.iteratorWithAdditions(); iterator.hasNext(); ) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    considerNotify(iterator.next().getValue());&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (mDispatchInvalidated) &lt;span class=&#34;keyword&#34;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;while&lt;/span&gt; (mDispatchInvalidated);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// äº‹ä»¶åˆ†å‘ç»“æŸ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        mDispatchingValue = &lt;span class=&#34;keyword&#34;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;...&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;considerNotify&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(ObserverWrapper observer)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// å¦‚æœç”Ÿå‘½å‘¨æœŸç®¡ç†è€…å·²ç»é”€æ¯,åˆ™å¿½ç•¥&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!observer.mActive) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// åœ¨åˆ†å‘ä¹‹å‰æ£€æŸ¥ä¸‹æœ€å…ˆçŠ¶æ€,å¦‚æœä¸åœ¨æ´»è·ƒé˜¶æ®µ,åˆ™ä¸æ”¹å˜çŠ¶æ€&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!observer.shouldBeActive()) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            observer.activeStateChanged(&lt;span class=&#34;keyword&#34;&gt;false&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// åˆ¤æ–­version , å› ä¸ºä»ä¸Šé¢æ¥çœ‹,æ¯æ¬¡èµ‹å€¼versionéƒ½ä¼šå˜å¾—&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// ä»–å¦ˆçš„çš„,è¿™æ ·å°±ä¸ä¼šé™·å…¥å¤šæ¬¡åˆ†å‘,ä¿è¯åªå–æœ€å…ˆçš„ä¼ å€¼&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (observer.mLastVersion &amp;gt;= mVersion) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        observer.mLastVersion = mVersion;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// æ‰§è¡Œæ¯ä¸ªç”Ÿå‘½å‘¨æœŸç®¡ç†è€…çš„è§‚å¯Ÿè€…çš„äº‹ä»¶åˆ†å‘&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        observer.mObserver.onChanged((T) mData);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;getåˆ°æ²¡æœ‰?&lt;br&gt;
&lt;img src=&#34;https://z3.ax1x.com/2021/11/08/I8YNWQ.png&#34; alt=&#34;I8YNWQ.png&#34; loading=&#34;lazy&#34;&gt;]&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://onion99.github.io/2022/03/02/uVaapTCHAYrYDaHP/</guid>
            <title>æºç å­¦ä¹  - Lifecycle</title>
            <link>https://onion99.github.io/2022/03/02/uVaapTCHAYrYDaHP/</link>
            <category>æºç è§£æ</category>
            <pubDate>Wed, 02 Mar 2022 01:33:23 +0800</pubDate>
            <description><![CDATA[ &lt;blockquote&gt;
&lt;p&gt;Jetpack Lifecycle æä¾›äº†å¯ç”¨äºæ„å»ºç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥å‹ç»„ä»¶çš„ç±»å’Œæ¥å£,ä»è€Œæ ¹æ® Activity æˆ– Fragment çš„å½“å‰ç”Ÿå‘½å‘¨æœŸçŠ¶æ€è‡ªåŠ¨è°ƒæ•´å…¶è¡Œä¸º,è®°ä½æˆ‘ä»¬è¦è§£æçš„æ˜¯Jet Pack Lifecycle ,è€Œä¸æ˜¯ åŸæœ‰Activity/Fragmentçš„ç”Ÿå‘½å‘¨æœŸæµç¨‹&lt;/p&gt;
&lt;/blockquote&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;p&gt;&lt;img src=&#34;https://s4.ax1x.com/2022/03/01/blNKTx.png&#34; alt=&#34;space&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;ä½¿ç”¨&#34;&gt;ä½¿ç”¨&lt;a title=&#34;#ä½¿ç”¨&#34; href=&#34;#ä½¿ç”¨&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;h4 id=&#34;é€šè¿‡-defaultlifecycleobserver-å®ç°&#34;&gt;é€šè¿‡ DefaultLifecycleObserver å®ç°&lt;a title=&#34;#é€šè¿‡-defaultlifecycleobserver-å®ç°&#34; href=&#34;#é€šè¿‡-defaultlifecycleobserver-å®ç°&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;ç±»å¯ä»¥é€šè¿‡å®ç° DefaultLifecycleObserver å¹¶æ›¿æ¢ç›¸åº”çš„æ–¹æ³•ï¼ˆå¦‚ onCreate å’Œ onStart ç­‰ï¼‰æ¥ç›‘æ§ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸçŠ¶æ€ã€‚ç„¶åï¼Œæ‚¨å¯ä»¥é€šè¿‡è°ƒç”¨ Lifecycle ç±»çš„ addObserver() æ–¹æ³•å¹¶ä¼ é€’è§‚å¯Ÿå™¨çš„å®ä¾‹æ¥æ·»åŠ è§‚å¯Ÿå™¨&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&#34;highlight kotlin&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// æ„å»ºç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥å‹ç»„ä»¶&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;MyObserver&lt;/span&gt; : &lt;span class=&#34;type&#34;&gt;DefaultLifecycleObserver &amp;#123;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;override&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onResume&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(owner: &lt;span class=&#34;type&#34;&gt;LifecycleOwner&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        connect() &lt;span class=&#34;comment&#34;&gt;// åœ¨é¡µé¢ onResume æ—¶è¿æ¥&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;override&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onPause&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(owner: &lt;span class=&#34;type&#34;&gt;LifecycleOwner&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        disconnect() &lt;span class=&#34;comment&#34;&gt;// åœ¨é¡µé¢ onStop æ—¶è¿æ¥&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// æ·»åŠ ç”Ÿå‘½å‘¨æœŸè§‚å¯Ÿå™¨&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;MyActivity&lt;/span&gt; : &lt;span class=&#34;type&#34;&gt;AppCompatActivity&lt;/span&gt;&lt;/span&gt;() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;override&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onCreate&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(...)&lt;/span&gt;&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	    myLifecycleOwner.getLifecycle().addObserver(MyObserver())&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;é€šè¿‡æ³¨è§£å®ç°licecycle-observer&#34;&gt;é€šè¿‡æ³¨è§£å®ç°Licecycle Observer&lt;a title=&#34;#é€šè¿‡æ³¨è§£å®ç°licecycle-observer&#34; href=&#34;#é€šè¿‡æ³¨è§£å®ç°licecycle-observer&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;figure class=&#34;highlight kotlin&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// 1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;interface&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;ILifecycleObserver&lt;/span&gt; : &lt;span class=&#34;type&#34;&gt;LifecycleObserver &amp;#123;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@OnLifecycleEvent(Lifecycle.Event.ON_CREATE)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onCreate&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(owner: &lt;span class=&#34;type&#34;&gt;LifecycleOwner&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@OnLifecycleEvent(Lifecycle.Event.ON_START)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onStart&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(owner: &lt;span class=&#34;type&#34;&gt;LifecycleOwner&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@OnLifecycleEvent(Lifecycle.Event.ON_RESUME)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onResume&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(owner: &lt;span class=&#34;type&#34;&gt;LifecycleOwner&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@OnLifecycleEvent(Lifecycle.Event.ON_PAUSE)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onPause&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(owner: &lt;span class=&#34;type&#34;&gt;LifecycleOwner&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@OnLifecycleEvent(Lifecycle.Event.ON_STOP)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onStop&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(owner: &lt;span class=&#34;type&#34;&gt;LifecycleOwner&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@OnLifecycleEvent(Lifecycle.Event.ON_DESTROY)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onDestroy&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(owner: &lt;span class=&#34;type&#34;&gt;LifecycleOwner&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@OnLifecycleEvent(Lifecycle.Event.ON_ANY)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onLifecycleChanged&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(owner: &lt;span class=&#34;type&#34;&gt;LifecycleOwner&lt;/span&gt;, event: &lt;span class=&#34;type&#34;&gt;Lifecycle&lt;/span&gt;.&lt;span class=&#34;type&#34;&gt;Event&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// 2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;MyObserver&lt;/span&gt; : &lt;span class=&#34;type&#34;&gt;ILifecycleObserver &amp;#123;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;override&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onCreate&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(owner: &lt;span class=&#34;type&#34;&gt;LifecycleOwner&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt; &amp;#123;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;override&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onStart&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(owner: &lt;span class=&#34;type&#34;&gt;LifecycleOwner&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt; &amp;#123;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;override&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onResume&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(owner: &lt;span class=&#34;type&#34;&gt;LifecycleOwner&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        connect() &lt;span class=&#34;comment&#34;&gt;// åœ¨é¡µé¢ onResume æ—¶è¿æ¥&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;override&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onPause&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(owner: &lt;span class=&#34;type&#34;&gt;LifecycleOwner&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        disconnect() &lt;span class=&#34;comment&#34;&gt;// åœ¨é¡µé¢ onStop æ—¶è¿æ¥&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;override&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onStop&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(owner: &lt;span class=&#34;type&#34;&gt;LifecycleOwner&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt; &amp;#123;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;override&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onDestroy&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(owner: &lt;span class=&#34;type&#34;&gt;LifecycleOwner&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt; &amp;#123;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;override&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onLifecycleChanged&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(owner: &lt;span class=&#34;type&#34;&gt;LifecycleOwner&lt;/span&gt;, event: &lt;span class=&#34;type&#34;&gt;Lifecycle&lt;/span&gt;.&lt;span class=&#34;type&#34;&gt;Event&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt; &amp;#123;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;è§£æ&#34;&gt;è§£æ&lt;a title=&#34;#è§£æ&#34; href=&#34;#è§£æ&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;h4 id=&#34;classç»„æˆ&#34;&gt;Classç»„æˆ&lt;a title=&#34;#classç»„æˆ&#34; href=&#34;#classç»„æˆ&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;é¦–å…ˆæˆ‘ä»¬å¾—çŸ¥é“Activity/Fragmentæ˜¯å¦‚ä½•å®ç°LifecycleOwnerçš„&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;LifecycleOwner:&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;interface&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;LifecycleOwner&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;/**&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;     * Returns the Lifecycle of the provider.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;     */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;Lifecycle &lt;span class=&#34;title&#34;&gt;getLifecycle&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°Fragment å’ŒActivityéƒ½å®ç°äº†ç›¸å…³çš„LifecycleOwneræ¥å£&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;Fragment&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;implements&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;ComponentCallbacks&lt;/span&gt;, &lt;span class=&#34;title&#34;&gt;OnCreateContextMenuListener&lt;/span&gt;, &lt;span class=&#34;title&#34;&gt;LifecycleOwner&lt;/span&gt;,&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;        &lt;span class=&#34;title&#34;&gt;ViewModelStoreOwner&lt;/span&gt;, &lt;span class=&#34;title&#34;&gt;HasDefaultViewModelProviderFactory&lt;/span&gt;, &lt;span class=&#34;title&#34;&gt;SavedStateRegistryOwner&lt;/span&gt;,&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;        &lt;span class=&#34;title&#34;&gt;ActivityResultCaller&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    LifecycleRegistry mLifecycleRegistry;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;initLifecycle&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        mLifecycleRegistry = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; LifecycleRegistry(&lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; Lifecycle &lt;span class=&#34;title&#34;&gt;getLifecycle&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; mLifecycleRegistry;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;    &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;ComponentActivity&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;androidx&lt;/span&gt;.&lt;span class=&#34;title&#34;&gt;core&lt;/span&gt;.&lt;span class=&#34;title&#34;&gt;app&lt;/span&gt;.&lt;span class=&#34;title&#34;&gt;ComponentActivity&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;implements&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;        &lt;span class=&#34;title&#34;&gt;ContextAware&lt;/span&gt;,&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;        &lt;span class=&#34;title&#34;&gt;LifecycleOwner&lt;/span&gt;,&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;        &lt;span class=&#34;title&#34;&gt;ViewModelStoreOwner&lt;/span&gt;,&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;        &lt;span class=&#34;title&#34;&gt;HasDefaultViewModelProviderFactory&lt;/span&gt;,&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;        &lt;span class=&#34;title&#34;&gt;SavedStateRegistryOwner&lt;/span&gt;,&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;        &lt;span class=&#34;title&#34;&gt;OnBackPressedDispatcherOwner&lt;/span&gt;,&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;        &lt;span class=&#34;title&#34;&gt;ActivityResultRegistryOwner&lt;/span&gt;,&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;        &lt;span class=&#34;title&#34;&gt;ActivityResultCaller&lt;/span&gt; &lt;/span&gt;&amp;#123;&amp;#125; &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;æ˜ç¡®LifecycleRegistryä¸»è¦ä½œç”¨&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;/* å®šä¹‰ä¸€ä¸ªå…·æœ‰ Android ç”Ÿå‘½å‘¨æœŸçš„å¯¹è±¡ */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;abstract&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;Lifecycle&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@MainThread&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;abstract&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;addObserver&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; LifecycleObserver observer)&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@MainThread&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;abstract&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;removeObserver&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; LifecycleObserver observer)&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// ç”Ÿå‘½å‘¨æœŸäº‹ä»¶,è¡¨æ˜å·²è¢«åˆ†å‘çš„ç”Ÿå‘½å‘¨æœŸäº‹ä»¶,æ˜ å°„åˆ°Activityå’ŒFragmentä¸­çš„å›è°ƒäº‹ä»¶ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;enum&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;Event&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        ON_CREATE,ON_START,ON_RESUME,ON_PAUSE,ON_STOP,ON_DESTROY,ON_ANY;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// ç”Ÿå‘½å‘¨æœŸçŠ¶æ€,è¡¨æ˜ç»„ä»¶çš„å½“å‰çŠ¶æ€&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;enum&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;State&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        DESTROYED,INITIALIZED,CREATED,STARTED,RESUMED;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;/* å¯ä»¥å¤„ç†å¤šä¸ªObserverçš„Lifecycleå®ç°,Fragmentå’ŒActivityä½¿ç”¨ */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;LifecycleRegistry&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;Lifecycle&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;LifecycleRegistry&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; LifecycleOwner provider, &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; enforceMainThread)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        mLifecycleOwner = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; WeakReference&amp;lt;&amp;gt;(provider);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        mState = INITIALIZED;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        mEnforceMainThread = enforceMainThread;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;åˆ°è¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥å¤§è‡´è¿™ä¹ˆè®¤ä¸ºäº†, LifecycleOwner é€šè¿‡è·å–å½“å‰å¯¹åº”çš„ LifecycleRegistry  ç®¡ç†å¤šä¸ªLicecycleObserver,ç„¶ååœ¨ç”Ÿå‘½å‘¨æœŸçŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶,å¤„ç†ä¸åŒçŠ¶æ€äº‹ä»¶çš„åˆ†æ”¾&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;activity-æ˜¯å¦‚ä½•å®ç°jetpack-lifecycleäº‹ä»¶åˆ†æ”¾çš„?&#34;&gt;Activity æ˜¯å¦‚ä½•å®ç°Jetpack Lifecycleäº‹ä»¶åˆ†æ”¾çš„?&lt;a title=&#34;#activity-æ˜¯å¦‚ä½•å®ç°jetpack-lifecycleäº‹ä»¶åˆ†æ”¾çš„?&#34; href=&#34;#activity-æ˜¯å¦‚ä½•å®ç°jetpack-lifecycleäº‹ä»¶åˆ†æ”¾çš„?&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;figure class=&#34;highlight kotlin&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;package&lt;/span&gt; androidx.core.app;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;ComponentActivity&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;Activity&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;implements&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;LifecycleOwner&lt;/span&gt;,&lt;span class=&#34;type&#34;&gt;KeyEventDispatcher.Component &amp;#123;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; LifecycleRegistry mLifecycleRegistry = new LifecycleRegistry(&lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;); &lt;span class=&#34;comment&#34;&gt;//1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;protected&lt;/span&gt; void onCreate(&lt;span class=&#34;meta&#34;&gt;@Nullable&lt;/span&gt; Bundle savedInstanceState) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;super&lt;/span&gt;.onCreate(savedInstanceState);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        ReportFragment.injectIfNeededIn(&lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;); &lt;span class=&#34;comment&#34;&gt;// 3&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; Lifecycle getLifecycle() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; mLifecycleRegistry; &lt;span class=&#34;comment&#34;&gt;// 2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æ³¨æ„çœ‹ReportFragment:&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;110&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;111&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;112&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;113&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;114&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;115&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;116&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;117&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;118&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;119&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;120&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;121&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;122&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;123&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;124&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;125&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;126&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;127&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;128&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;129&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;130&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;131&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;132&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;133&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;134&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;135&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;136&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;137&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;138&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;139&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;140&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;141&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;142&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;143&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;144&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;145&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;146&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;147&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;148&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;149&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;ReportFragment&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;Fragment&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; String REPORT_FRAGMENT_TAG = &lt;span class=&#34;string&#34;&gt;&amp;quot;androidx.lifecycle&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            + &lt;span class=&#34;string&#34;&gt;&amp;quot;.LifecycleDispatcher.report_fragment_tag&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;injectIfNeededIn&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(Activity activity)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (Build.VERSION.SDK_INT &amp;gt;= &lt;span class=&#34;number&#34;&gt;29&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;         activity.registerActivityLifecycleCallbacks(&lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; LifecycleCallbacks());&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;       &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        android.app.FragmentManager manager = activity.getFragmentManager();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (manager.findFragmentByTag(REPORT_FRAGMENT_TAG) == &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            manager.beginTransaction().add(&lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; ReportFragment(), REPORT_FRAGMENT_TAG).commit();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;// Hopefully, we are the first to make a transaction.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            manager.executePendingTransactions();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@SuppressWarnings(&amp;quot;deprecation&amp;quot;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;dispatch&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; Activity activity, &lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; Lifecycle.Event event)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//å·²ç»è¢«æ ‡æ³¨ä¸º@Deprecated&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (activity &lt;span class=&#34;keyword&#34;&gt;instanceof&lt;/span&gt; LifecycleRegistryOwner) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            ((LifecycleRegistryOwner) activity).getLifecycle().handleLifecycleEvent(event);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (activity &lt;span class=&#34;keyword&#34;&gt;instanceof&lt;/span&gt; LifecycleOwner) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            Lifecycle lifecycle = ((LifecycleOwner) activity).getLifecycle();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (lifecycle &lt;span class=&#34;keyword&#34;&gt;instanceof&lt;/span&gt; LifecycleRegistry) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                ((LifecycleRegistry) lifecycle).handleLifecycleEvent(event);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;static&lt;/span&gt; ReportFragment &lt;span class=&#34;title&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(Activity activity)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; (ReportFragment) activity.getFragmentManager().findFragmentByTag(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                REPORT_FRAGMENT_TAG);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onActivityCreated&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(Bundle savedInstanceState)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;super&lt;/span&gt;.onActivityCreated(savedInstanceState);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        dispatchCreate(mProcessListener);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        dispatch(Lifecycle.Event.ON_CREATE);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onStart&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;super&lt;/span&gt;.onStart();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        dispatchStart(mProcessListener);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        dispatch(Lifecycle.Event.ON_START);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onResume&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;super&lt;/span&gt;.onResume();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        dispatchResume(mProcessListener);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        dispatch(Lifecycle.Event.ON_RESUME);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onPause&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;super&lt;/span&gt;.onPause();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        dispatch(Lifecycle.Event.ON_PAUSE);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onStop&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;super&lt;/span&gt;.onStop();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        dispatch(Lifecycle.Event.ON_STOP);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onDestroy&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;super&lt;/span&gt;.onDestroy();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        dispatch(Lifecycle.Event.ON_DESTROY);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// just want to be sure that we won&amp;#x27;t leak reference to an activity&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        mProcessListener = &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;dispatch&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; Lifecycle.Event event)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (Build.VERSION.SDK_INT &amp;lt; &lt;span class=&#34;number&#34;&gt;29&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            dispatch(getActivity(), event);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//API29åŠä»¥ä¸Šç›´æ¥ä½¿ç”¨Application.ActivityLifecycleCallbacksæ¥ç›‘å¬ç”Ÿå‘½å‘¨æœŸ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;LifecycleCallbacks&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;implements&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;Application&lt;/span&gt;.&lt;span class=&#34;title&#34;&gt;ActivityLifecycleCallbacks&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onActivityCreated&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; Activity activity,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;                &lt;span class=&#34;meta&#34;&gt;@Nullable&lt;/span&gt; Bundle bundle)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onActivityPostCreated&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; Activity activity,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;                &lt;span class=&#34;meta&#34;&gt;@Nullable&lt;/span&gt; Bundle savedInstanceState)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            dispatch(activity, Lifecycle.Event.ON_CREATE);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onActivityStarted&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; Activity activity)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onActivityPostStarted&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; Activity activity)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            dispatch(activity, Lifecycle.Event.ON_START);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onActivityResumed&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; Activity activity)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onActivityPostResumed&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; Activity activity)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            dispatch(activity, Lifecycle.Event.ON_RESUME);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onActivityPrePaused&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; Activity activity)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            dispatch(activity, Lifecycle.Event.ON_PAUSE);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onActivityPaused&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; Activity activity)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onActivityPreStopped&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; Activity activity)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            dispatch(activity, Lifecycle.Event.ON_STOP);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onActivityStopped&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; Activity activity)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onActivitySaveInstanceState&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; Activity activity,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;                &lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; Bundle bundle)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onActivityPreDestroyed&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; Activity activity)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            dispatch(activity, Lifecycle.Event.ON_DESTROY);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onActivityDestroyed&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; Activity activity)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;é€šè¿‡ä¸€ä¸ªé€æ˜çš„Fragmentæ¥åˆ†å‘ç”Ÿå‘½å‘¨æœŸäº‹ä»¶ï¼Œè¿™æ ·å¯¹äºActivityæ¥è¯´æ˜¯æ— ä¾µå…¥çš„ã€‚åˆ†æˆä¸¤éƒ¨åˆ†é€»è¾‘ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å½“API&amp;gt;=29æ—¶ï¼Œç›´æ¥ä½¿ç”¨Application.ActivityLifecycleCallbacksæ¥åˆ†å‘ç”Ÿå‘½å‘¨æœŸäº‹ä»¶&lt;/li&gt;
&lt;li&gt;è€Œå½“API&amp;lt;29æ—¶ï¼Œåœ¨Fragmentçš„ç”Ÿå‘½å‘¨æœŸå›è°ƒä¸­è¿›è¡Œäº†äº‹ä»¶åˆ†å‘ã€‚&lt;br&gt;
ä½†æ®Šé€”åŒå½’ï¼Œä¸¤è€…æœ€ç»ˆéƒ½ä¼šèµ°åˆ°&lt;code&gt;dispatch(Activity activity, Lifecycle.Event event)&lt;/code&gt;æ–¹æ³•&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;lifecycleobserver-æ˜¯å¦‚ä½•è¢«å“åº”çš„?&#34;&gt;LifecycleObserver æ˜¯å¦‚ä½•è¢«å“åº”çš„?&lt;a title=&#34;#lifecycleobserver-æ˜¯å¦‚ä½•è¢«å“åº”çš„?&#34; href=&#34;#lifecycleobserver-æ˜¯å¦‚ä½•è¢«å“åº”çš„?&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;100&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;/* 1 */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;ReportFragment&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// äº‹ä»¶åˆ†å‘&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;dispatch&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; Activity activity, &lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; Lifecycle.Event event)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (activity &lt;span class=&#34;keyword&#34;&gt;instanceof&lt;/span&gt; LifecycleRegistryOwner) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            ((LifecycleRegistryOwner) activity).getLifecycle().handleLifecycleEvent(event);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (activity &lt;span class=&#34;keyword&#34;&gt;instanceof&lt;/span&gt; LifecycleOwner) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            Lifecycle lifecycle = ((LifecycleOwner) activity).getLifecycle();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (lifecycle &lt;span class=&#34;keyword&#34;&gt;instanceof&lt;/span&gt; LifecycleRegistry) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                ((LifecycleRegistry) lifecycle).handleLifecycleEvent(event);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;/* 2 */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;LifecycleRegistry&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;Lifecycle&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// 2.1-å¤„ç†ç”Ÿå‘½å‘¨æœŸäº‹ä»¶&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;handleLifecycleEvent&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; Lifecycle.Event event)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        enforceMainThreadIfNeeded(&lt;span class=&#34;string&#34;&gt;&amp;quot;handleLifecycleEvent&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        moveToState(event.getTargetState());&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// 2.2-åˆ¤æ–­ç”Ÿå‘½å‘¨æœŸçŠ¶æ€&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;moveToState&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(State next)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (mState == next) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        mState = next;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (mHandlingEvent || mAddingObserverCounter != &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            mNewEventOccurred = &lt;span class=&#34;keyword&#34;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;// we will figure out what to do on upper level.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        mHandlingEvent = &lt;span class=&#34;keyword&#34;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        sync();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        mHandlingEvent = &lt;span class=&#34;keyword&#34;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// 2-3 åŒæ­¥çŠ¶æ€è‡³LifecycleObserver&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;sync&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        LifecycleOwner lifecycleOwner = mLifecycleOwner.get();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (lifecycleOwner == &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;throw&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; IllegalStateException(&lt;span class=&#34;string&#34;&gt;&amp;quot;LifecycleOwner of this LifecycleRegistry is already&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    + &lt;span class=&#34;string&#34;&gt;&amp;quot;garbage collected. It is too late to change lifecycle state.&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;while&lt;/span&gt; (!isSynced()) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            mNewEventOccurred = &lt;span class=&#34;keyword&#34;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;// no need to check eldest for nullability, because isSynced does it for us.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (mState.compareTo(mObserverMap.eldest().getValue().mState) &amp;lt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                backwardPass(lifecycleOwner);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            Entry&amp;lt;LifecycleObserver, ObserverWithState&amp;gt; newest = mObserverMap.newest();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!mNewEventOccurred &amp;amp;&amp;amp; newest != &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    &amp;amp;&amp;amp; mState.compareTo(newest.getValue().mState) &amp;gt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                forwardPass(lifecycleOwner);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        mNewEventOccurred = &lt;span class=&#34;keyword&#34;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;forwardPass&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(LifecycleOwner lifecycleOwner)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        Iterator&amp;lt;Entry&amp;lt;LifecycleObserver, ObserverWithState&amp;gt;&amp;gt; ascendingIterator =&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                mObserverMap.iteratorWithAdditions();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;while&lt;/span&gt; (ascendingIterator.hasNext() &amp;amp;&amp;amp; !mNewEventOccurred) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            Entry&amp;lt;LifecycleObserver, ObserverWithState&amp;gt; entry = ascendingIterator.next();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            ObserverWithState observer = entry.getValue();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;while&lt;/span&gt; ((observer.mState.compareTo(mState) &amp;lt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt; &amp;amp;&amp;amp; !mNewEventOccurred&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    &amp;amp;&amp;amp; mObserverMap.contains(entry.getKey()))) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                pushParentState(observer.mState);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; Event event = Event.upFrom(observer.mState);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (event == &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    &lt;span class=&#34;keyword&#34;&gt;throw&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; IllegalStateException(&lt;span class=&#34;string&#34;&gt;&amp;quot;no event up from &amp;quot;&lt;/span&gt; + observer.mState);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                observer.dispatchEvent(lifecycleOwner, event);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                popParentState();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;backwardPass&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(LifecycleOwner lifecycleOwner)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        Iterator&amp;lt;Entry&amp;lt;LifecycleObserver, ObserverWithState&amp;gt;&amp;gt; descendingIterator =&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                mObserverMap.descendingIterator();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;while&lt;/span&gt; (descendingIterator.hasNext() &amp;amp;&amp;amp; !mNewEventOccurred) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            Entry&amp;lt;LifecycleObserver, ObserverWithState&amp;gt; entry = descendingIterator.next();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            ObserverWithState observer = entry.getValue();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;while&lt;/span&gt; ((observer.mState.compareTo(mState) &amp;gt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt; &amp;amp;&amp;amp; !mNewEventOccurred&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    &amp;amp;&amp;amp; mObserverMap.contains(entry.getKey()))) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                Event event = Event.downFrom(observer.mState);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (event == &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    &lt;span class=&#34;keyword&#34;&gt;throw&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; IllegalStateException(&lt;span class=&#34;string&#34;&gt;&amp;quot;no event down from &amp;quot;&lt;/span&gt; + observer.mState);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                pushParentState(event.getTargetState());&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                observer.dispatchEvent(lifecycleOwner, event);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                popParentState();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;refer&#34;&gt;Refer&lt;a title=&#34;#refer&#34; href=&#34;#refer&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.mo4tech.com/analysis-of-the-basic-use-and-rationale-of-android-jetpack-component-lifecycle.html&#34; target=&#34;_blank&#34;&gt;Analysis of the basic use and rationale of Android Jetpack component Lifecycle - Moment For Technology (mo4tech.com)&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/u013700502/article/details/118469311&#34; target=&#34;_blank&#34;&gt;Android Jetpackç³»åˆ—ä¹‹Lifecycle_å°é©¬å¿«è·‘çš„åšå®¢-CSDNåšå®¢_androidä¸­lifecycle&lt;/a&gt;&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://onion99.github.io/2021/11/30/9S5c1rplpdSAbIxR/</guid>
            <title>æºç å­¦ä¹  - ViewModel</title>
            <link>https://onion99.github.io/2021/11/30/9S5c1rplpdSAbIxR/</link>
            <category>æºç è§£æ</category>
            <pubDate>Tue, 30 Nov 2021 07:30:53 +0800</pubDate>
            <description><![CDATA[ &lt;blockquote&gt;
&lt;p&gt;ViewModel ç±»æ—¨åœ¨ä»¥æ³¨é‡ç”Ÿå‘½å‘¨æœŸçš„æ–¹å¼å­˜å‚¨å’Œç®¡ç†ç•Œé¢ç›¸å…³çš„æ•°æ®ã€‚ViewModel ç±»è®©æ•°æ®å¯åœ¨å‘ç”Ÿå±å¹•æ—‹è½¬ç­‰é…ç½®æ›´æ”¹åç»§ç»­ç•™å­˜,å°†è§†å›¾å’Œæ•°æ®è¿›è¡Œäº†åˆ†ç¦»è§£è€¦ï¼Œä¸ºè§†å›¾å±‚æä¾›æ•°æ®&lt;/p&gt;
&lt;/blockquote&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;h3 id=&#34;é…ç½®å˜æ›´ä¿å­˜æ•°æ®çš„æ–¹å¼&#34;&gt;é…ç½®å˜æ›´ä¿å­˜æ•°æ®çš„æ–¹å¼&lt;a title=&#34;#é…ç½®å˜æ›´ä¿å­˜æ•°æ®çš„æ–¹å¼&#34; href=&#34;#é…ç½®å˜æ›´ä¿å­˜æ•°æ®çš„æ–¹å¼&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;onSaveInstance(Bundle)&lt;/li&gt;
&lt;li&gt;ViewModel&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;viewmodelä¼˜åŠ¿&#34;&gt;ViewModelä¼˜åŠ¿&lt;a title=&#34;#viewmodelä¼˜åŠ¿&#34; href=&#34;#viewmodelä¼˜åŠ¿&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ViewModelæ˜¯å°†æ•°æ®å­˜åˆ°å†…å­˜ä¸­ï¼Œè€ŒonSaveInstance()æ˜¯é€šè¿‡Bundleå°†åºåˆ—åŒ–æ•°æ®å­˜åœ¨ç£ç›˜ä¸­&lt;/li&gt;
&lt;li&gt;ViewModelå¯ä»¥å­˜å‚¨ä»»ä½•å½¢å¼çš„æ•°æ®ï¼Œä¸”å¤§å°ä¸é™åˆ¶(ä¸è¶…è¿‡Appåˆ†é…çš„å†…å­˜å³å¯)ï¼ŒonSaveInstance()ä¸­åªèƒ½å­˜å‚¨å¯åºåˆ—åŒ–çš„æ•°æ®ï¼Œä¸”å¤§å°ä¸€èˆ¬ä¸è¶…è¿‡1Mï¼ˆIPCé€šä¿¡æ•°æ®é™åˆ¶ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;viewmodelç”Ÿå‘½å‘¨æœŸ&#34;&gt;ViewModelç”Ÿå‘½å‘¨æœŸ&lt;a title=&#34;#viewmodelç”Ÿå‘½å‘¨æœŸ&#34; href=&#34;#viewmodelç”Ÿå‘½å‘¨æœŸ&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/08/I8L0jU.png&#34; alt=&#34;I8L0jU.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;p&gt;ViewModelå¯¹è±¡å­˜åœ¨çš„æ—¶é—´èŒƒå›´æ˜¯è·å– ViewModel æ—¶ä¼ é€’ç»™ ViewModelProvider çš„Lifecycleã€‚ViewModelå°†ä¸€ç›´ç•™åœ¨å†…å­˜ä¸­ï¼Œç›´åˆ°é™å®šå…¶å­˜åœ¨æ—¶é—´èŒƒå›´çš„Lifecycleæ°¸ä¹…æ¶ˆå¤±ï¼š&lt;br&gt;
å¯¹äºactivityï¼Œæ˜¯åœ¨activityé”€æ¯æ—¶ï¼›&lt;br&gt;
å¯¹äºfragmentï¼Œæ˜¯åœ¨ fragmentåˆ†ç¦»æ—¶&lt;/p&gt;
&lt;h3 id=&#34;è§£æ&#34;&gt;è§£æ&lt;a title=&#34;#è§£æ&#34; href=&#34;#è§£æ&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;h4 id=&#34;viewmodelæ˜¯æ€ä¹ˆæ ·å®ä¾‹åŒ–çš„?&#34;&gt;ViewModelæ˜¯æ€ä¹ˆæ ·å®ä¾‹åŒ–çš„?&lt;a title=&#34;#viewmodelæ˜¯æ€ä¹ˆæ ·å®ä¾‹åŒ–çš„?&#34; href=&#34;#viewmodelæ˜¯æ€ä¹ˆæ ·å®ä¾‹åŒ–çš„?&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;figure class=&#34;highlight kotlin&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;abstract&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;BindingActivity&lt;/span&gt;&amp;lt;&lt;span class=&#34;type&#34;&gt;T : ViewDataBinding&lt;/span&gt;&amp;gt; &lt;span class=&#34;keyword&#34;&gt;constructor&lt;/span&gt;&lt;/span&gt;(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@LayoutRes&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;val&lt;/span&gt; layoutId: &lt;span class=&#34;built_in&#34;&gt;Int&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;) : AppCompatActivity(), HasAndroidInjector &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;open&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;type&#34;&gt;&amp;lt;T : ViewModel?&amp;gt;&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;getActivityScopeViewModel&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(modelClass: &lt;span class=&#34;type&#34;&gt;Class&lt;/span&gt;&amp;lt;&lt;span class=&#34;type&#34;&gt;T&lt;/span&gt;&amp;gt;)&lt;/span&gt;&lt;/span&gt;: T &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// å®ä¾‹åŒ–å¯¹åº”Scopeçš„ViewModelProvider&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!::activityProvider.isInitialized) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            activityProvider = ViewModelProvider(requireActivity())&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// è·å–ViewModelProviderè·å–Viewmodel&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; activityProvider.&lt;span class=&#34;keyword&#34;&gt;get&lt;/span&gt;(modelClass)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;viewmodelprovideråˆæ˜¯å•¥?&#34;&gt;ViewModelProvideråˆæ˜¯å•¥?&lt;a title=&#34;#viewmodelprovideråˆæ˜¯å•¥?&#34; href=&#34;#viewmodelprovideråˆæ˜¯å•¥?&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;ViewModelçš„è¾…åŠ©ç¨‹åºç±»ï¼Œè¯¥ç±»è´Ÿè´£ä¸ºç•Œé¢å‡†å¤‡æ•°æ®ã€‚åœ¨é…ç½®æ›´æ”¹æœŸé—´ä¼šè‡ªåŠ¨ä¿ç•™ ViewModel å¯¹è±¡ï¼Œä»¥ä¾¿å®ƒä»¬å­˜å‚¨çš„æ•°æ®ç«‹å³å¯ä¾›ä¸‹ä¸€ä¸ª activity æˆ– fragment å®ä¾‹ä½¿ç”¨&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;/* ä¸ºFragment/Activityæä¾›ViewModelsçš„å®ç”¨ç¨‹åºç±» */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;ViewModelProvider&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// æ„é€ æ–¹æ³•&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// 1.åˆ›å»ºç”¨æ¥å­˜å‚¨ViewModelçš„ViewModelStore&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// 2. åˆ›å»ºç”¨äºå®ä¾‹åŒ–æ–°ViewModelçš„Factory&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;ViewModelProvider&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; ViewModelStoreOwner owner)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;(owner.getViewModelStore(), owner &lt;span class=&#34;keyword&#34;&gt;instanceof&lt;/span&gt; HasDefaultViewModelProviderFactory&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                ? ((HasDefaultViewModelProviderFactory) owner).getDefaultViewModelProviderFactory()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                : NewInstanceFactory.getInstance());&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// æ„é€ æ–¹æ³•&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;ViewModelProvider&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; ViewModelStoreOwner owner, &lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; Factory factory)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;(owner.getViewModelStore(), factory);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// æ„é€ æ–¹æ³•&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;ViewModelProvider&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; ViewModelStore store, &lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; Factory factory)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        mFactory = factory;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        mViewModelStore = store;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ViewModelProvider å…³é”®å‚æ•°ç»„æˆ:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ViewModelStoreOwnerï¼šViewModelå­˜å‚¨å™¨æ‹¥æœ‰è€…ï¼Œç”¨æ¥æä¾›ViewModelStore&lt;/li&gt;
&lt;li&gt;ViewModelStoreï¼šViewModelå­˜å‚¨å™¨ï¼Œç”¨æ¥å­˜å‚¨ViewModel&lt;/li&gt;
&lt;li&gt;ViewModelProviderFactoryï¼šåˆ›å»ºViewModelçš„å·¥å‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é¦–å…ˆå°è¯•é€šè¿‡ViewModelStore.get(key)è·å–ViewModelï¼Œå¦‚æœä¸ä¸ºç©ºç›´æ¥è¿”å›è¯¥å®ä¾‹ï¼›å¦‚æœä¸ºç©ºï¼Œé€šè¿‡Factory.createåˆ›å»ºViewModelå¹¶ä¿å­˜åˆ°ViewModelStoreä¸­ã€‚å…ˆæ¥çœ‹Factoryæ˜¯å¦‚ä½•åˆ›å»ºViewModelçš„ï¼ŒViewModelProvideræ„é€ å‡½æ•°ä¸­ï¼Œå¦‚æœæ²¡æœ‰ä¼ å…¥Factoryï¼Œé‚£ä¹ˆä¼šä½¿ç”¨NewInstanceFactory&lt;/p&gt;
&lt;h4 id=&#34;viewmodelproviderä¸­çš„ownerå’Œfactoryæ€ä¹ˆæ¥çš„?&#34;&gt;ViewModelProviderä¸­çš„Ownerå’ŒFactoryæ€ä¹ˆæ¥çš„?&lt;a title=&#34;#viewmodelproviderä¸­çš„ownerå’Œfactoryæ€ä¹ˆæ¥çš„?&#34; href=&#34;#viewmodelproviderä¸­çš„ownerå’Œfactoryæ€ä¹ˆæ¥çš„?&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;ComponentActivity&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;androidx&lt;/span&gt;.&lt;span class=&#34;title&#34;&gt;core&lt;/span&gt;.&lt;span class=&#34;title&#34;&gt;app&lt;/span&gt;.&lt;span class=&#34;title&#34;&gt;ComponentActivity&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;implements&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;        &lt;span class=&#34;title&#34;&gt;ViewModelStoreOwner&lt;/span&gt;,&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;        &lt;span class=&#34;title&#34;&gt;HasDefaultViewModelProviderFactory&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h5 id=&#34;viewmodelproviderfactory&#34;&gt;ViewModelProviderFactory&lt;a title=&#34;#viewmodelproviderfactory&#34; href=&#34;#viewmodelproviderfactory&#34;&gt;&lt;/a&gt;&lt;/h5&gt;
&lt;blockquote&gt;
&lt;p&gt;Activity,Fragmenté»˜è®¤å®ç°äº†HasDefaultViewModelProviderFactoryæ¥å£,å®ç°è‡ªå·±åˆ›å»ºViewModelçš„ViewModelProviderFactory&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/08/IGEOT1.png&#34; alt=&#34;IGEOT1.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;p&gt;å†æ¥çœ‹çœ‹&lt;code&gt;ComponentActivity.getViewModelStore()&lt;/code&gt;:&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;ComponentActivity&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;androidx&lt;/span&gt;.&lt;span class=&#34;title&#34;&gt;core&lt;/span&gt;.&lt;span class=&#34;title&#34;&gt;app&lt;/span&gt;.&lt;span class=&#34;title&#34;&gt;ComponentActivity&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;implements&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;        &lt;span class=&#34;title&#34;&gt;ViewModelStoreOwner&lt;/span&gt;,&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;        &lt;span class=&#34;title&#34;&gt;HasDefaultViewModelProviderFactory&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;/* è¿”å›æœªå‘ViewModelProvideræ„é€ å‡½æ•°æä¾›è‡ªå®šä¹‰Factoryæ—¶åº”ä½¿ç”¨çš„é»˜è®¤ViewModelProvider.Factory  */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; ViewModelProvider.&lt;span class=&#34;function&#34;&gt;Factory &lt;span class=&#34;title&#34;&gt;getDefaultViewModelProviderFactory&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (getApplication() == &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;throw&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; IllegalStateException(&lt;span class=&#34;string&#34;&gt;&amp;quot;Your activity is not yet attached to the &amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    + &lt;span class=&#34;string&#34;&gt;&amp;quot;Application instance. You can&amp;#x27;t request ViewModel before onCreate call.&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// å¦ˆçš„,å°±æ˜¯è¿™ä¹ˆç®€å•,ç›´æ¥å®ä¾‹åŒ–&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (mDefaultFactory == &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            mDefaultFactory = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; SavedStateViewModelFactory(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    getApplication(),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    &lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    getIntent() != &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt; ? getIntent().getExtras() : &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; mDefaultFactory;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;    &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h5 id=&#34;viewmodelstore&#34;&gt;ViewModelStore&lt;a title=&#34;#viewmodelstore&#34; href=&#34;#viewmodelstore&#34;&gt;&lt;/a&gt;&lt;/h5&gt;
&lt;blockquote&gt;
&lt;p&gt;Activity,Fragmentä¹Ÿé»˜è®¤å®ç°äº†è¿™ä¸ªæ¥å£,ä»¥æ¥è·å–è·Ÿå½“å‰ç”Ÿå‘½å‘¨æœŸç›¸å…³çš„ViewModelStore,çœ‹åˆ°æ²¡æœ‰,æœ‰å›¾æœ‰çœŸç›¸&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/08/I8xIk4.png&#34; alt=&#34;I8xIk4.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;p&gt;çœ‹çœ‹&lt;code&gt;ComponentActivity.getViewModelStore()&lt;/code&gt;:&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; ViewModelStore &lt;span class=&#34;title&#34;&gt;getViewModelStore&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (getApplication() == &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;throw&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; IllegalStateException(&lt;span class=&#34;string&#34;&gt;&amp;quot;Your activity is not yet attached to the &amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                + &lt;span class=&#34;string&#34;&gt;&amp;quot;Application instance. You can&amp;#x27;t request ViewModel before onCreate call.&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// å‰,è¿™é‡Œç…§æˆ‘çŒœæƒ³è‚¯å®šæ˜¯å®ç°ViewModelStoreçš„å•ä¾‹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ensureViewModelStore();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// è¿”å›ä¸æ­¤Activityå…³è”çš„ViewModelStore&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; mViewModelStore;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;void ensureViewModelStore() &amp;#123;
    if (mViewModelStore == null) &amp;#123;
        // æ£€ç´¢å…ˆå‰ç”±onRetainNonConfigurationInstance()è¿”å›çš„é…ç½®å˜æ›´åçš„ç¼“å­˜é…ç½®
        NonConfigurationInstances nc = (NonConfigurationInstances) getLastNonConfigurationInstance();
        // å¦‚æœç¼“å­˜é…ç½®ä¸ä¸ºç©º,åˆ™å–ç¼“å­˜é…ç½®çš„viewModelStore
        if (nc != null) &amp;#123;
            mViewModelStore = nc.viewModelStore;
        &amp;#125;
        // å¦åˆ™è‡ªå·±å®ä¾‹ä¸€ä¸ª
        if (mViewModelStore == null) &amp;#123;
            mViewModelStore = new ViewModelStore();
        &amp;#125;
    &amp;#125;
&amp;#125;    
&lt;/code&gt;&lt;/pre&gt;
&lt;figure class=&#34;highlight kotlin&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;72&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;**é€šè¿‡getLastNonConfigurationInstance()æˆ‘ä»¬å¯ä»¥åœ¨çŸ¥é“ **&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ViewModelStoreçš„å­˜å–éƒ½æ˜¯é—´æ¥åœ¨ActivityThreadä¸­è¿›è¡Œå¹¶ä¿å­˜åœ¨ActivityClientRecordä¸­ã€‚åœ¨Activityé…ç½®å˜åŒ–æ—¶ï¼ŒViewModelStoreå¯ä»¥åœ¨Activityé”€æ¯æ—¶å¾—ä»¥ä¿å­˜å¹¶åœ¨é‡å»ºæ—¶é‡æ–°ä»lastNonConfigurationInstancesä¸­è·å–ï¼Œåˆå› ä¸ºViewModelStoreæä¾›äº†ViewModelï¼Œæ‰€ä»¥ViewModelä¹Ÿå¯ä»¥åœ¨Activityé…ç½®å˜åŒ–æ—¶å¾—ä»¥ä¿å­˜ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆViewModelçš„ç”Ÿå‘½å‘¨æœŸæ¯”Activityç”Ÿå‘½å‘¨æœŸé•¿çš„åŸå› äº†ã€‚&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;#### æœ€åViewModelProvideræ˜¯å¦‚ä½•&lt;span class=&#34;keyword&#34;&gt;get&lt;/span&gt;åˆ° Viewmodelçš„?&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;```java&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// ç¬¬ä¸€æ­¥:å°get&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &amp;lt;T extends ViewModel&amp;gt; T &lt;span class=&#34;keyword&#34;&gt;get&lt;/span&gt;(&lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; Class&amp;lt;T&amp;gt; modelClass) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        String canonicalName = modelClass.getCanonicalName();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// å¥½å®¶ä¼™,çœ‹åˆ°æ²¡æœ‰,å¦‚æœè¿™é‡Œåˆ¤æ–­æ˜¯å±€éƒ¨ç±»æˆ–è€…åŒ¿åç±»,å°±ç›´æ¥ç»™crashäº†,è°·æ­Œå°±æ˜¯ç‰›é€¼&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (canonicalName == &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;throw&lt;/span&gt; new IllegalArgumentException(&lt;span class=&#34;string&#34;&gt;&amp;quot;Local and anonymous classes can not be ViewModels&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// é¦–å…ˆæ„é€ äº†ä¸€ä¸ªkeyï¼Œç›´æ¥è°ƒç”¨ä¸‹é¢çš„get(key,modelClass)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;get&lt;/span&gt;(DEFAULT_KEY + &lt;span class=&#34;string&#34;&gt;&amp;quot;:&amp;quot;&lt;/span&gt; + canonicalName, modelClass);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// ç¬¬äºŒæ­¥:å¤§get&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &amp;lt;T extends ViewModel&amp;gt; T &lt;span class=&#34;keyword&#34;&gt;get&lt;/span&gt;(&lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; String key, &lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; Class&amp;lt;T&amp;gt; modelClass) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        ViewModel viewModel = mViewModelStore.&lt;span class=&#34;keyword&#34;&gt;get&lt;/span&gt;(key);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// å°è¯•ä»ViewModelStoreä¸­è·å–ViewModel&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (modelClass.isInstance(viewModel)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (mFactory instanceof OnRequeryFactory) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                ((OnRequeryFactory) mFactory).onRequery(viewModel);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;// viewModelä¸ä¸ºç©ºç›´æ¥è¿”å›è¯¥å®ä¾‹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; (T) viewModel;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// ç„¶åå¦‚æœä¸ºnull,åˆ™é€šè¿‡å…·ä½“å·¥å‚ç±»å»å®ä¾‹åŒ–ViewModel&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (mFactory instanceof KeyedFactory) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            viewModel = ((KeyedFactory) mFactory).create(key, modelClass);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            viewModel = mFactory.create(modelClass);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// å˜¿å˜¿,æ”¾è¿›ç¼“å­˜&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        mViewModelStore.put(key, viewModel);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; (T) viewModel;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// ViewModelçš„å®ä¾‹åŒ–&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &amp;lt;T extends ViewModel&amp;gt; T create(&lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; String key, &lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; Class&amp;lt;T&amp;gt; modelClass) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        boolean isAndroidViewModel = AndroidViewModel.&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt;.isAssignableFrom(modelClass);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        Constructor&amp;lt;T&amp;gt; &lt;span class=&#34;keyword&#34;&gt;constructor&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// é€šè¿‡åå°„,å»æ‰¾åˆ°å½“å‰ViewModelçš„æ„é€ å‡½æ•°&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (isAndroidViewModel &amp;amp;&amp;amp; mApplication != &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;constructor&lt;/span&gt; = findMatchingConstructor(modelClass, ANDROID_VIEWMODEL_SIGNATURE);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;constructor&lt;/span&gt; = findMatchingConstructor(modelClass, VIEWMODEL_SIGNATURE);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;keyword&#34;&gt;constructor&lt;/span&gt; == &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; mFactory.create(modelClass);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        SavedStateHandleController controller = SavedStateHandleController.create(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                mSavedStateRegistry, mLifecycle, key, mDefaultArgs);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// å˜¿å˜¿,è°ƒç”¨æ„é€ å‡½æ•°,å®ä¾‹åŒ–        &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;try&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            T viewmodel;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (isAndroidViewModel &amp;amp;&amp;amp; mApplication != &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                viewmodel = &lt;span class=&#34;keyword&#34;&gt;constructor&lt;/span&gt;.newInstance(mApplication, controller.getHandle());&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                viewmodel = &lt;span class=&#34;keyword&#34;&gt;constructor&lt;/span&gt;.newInstance(controller.getHandle());&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            viewmodel.setTagIfAbsent(TAG_SAVED_STATE_HANDLE_CONTROLLER, controller);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; viewmodel;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;catch&lt;/span&gt; (IllegalAccessException e) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;throw&lt;/span&gt; new RuntimeException(&lt;span class=&#34;string&#34;&gt;&amp;quot;Failed to access &amp;quot;&lt;/span&gt; + modelClass, e);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;catch&lt;/span&gt; (InstantiationException e) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;throw&lt;/span&gt; new RuntimeException(&lt;span class=&#34;string&#34;&gt;&amp;quot;A &amp;quot;&lt;/span&gt; + modelClass + &lt;span class=&#34;string&#34;&gt;&amp;quot; cannot be instantiated.&amp;quot;&lt;/span&gt;, e);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;catch&lt;/span&gt; (InvocationTargetException e) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;throw&lt;/span&gt; new RuntimeException(&lt;span class=&#34;string&#34;&gt;&amp;quot;An exception happened in constructor of &amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    + modelClass, e.getCause());&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;   &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;viewmodelstore-æ˜¯æ˜¯å¦‚ä½•å­˜å‚¨viewmodelçš„?&#34;&gt;ViewModelStore æ˜¯æ˜¯å¦‚ä½•å­˜å‚¨ViewModelçš„?&lt;a title=&#34;#viewmodelstore-æ˜¯æ˜¯å¦‚ä½•å­˜å‚¨viewmodelçš„?&#34; href=&#34;#viewmodelstore-æ˜¯æ˜¯å¦‚ä½•å­˜å‚¨viewmodelçš„?&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;å˜¿å˜¿,å­˜å‚¨ViewModelçš„ViewModelStore,ç‰›é€¼å•Š,ç”¨ä¸€ä¸ªHashMapæ¥ç¼“å­˜çœ‹åˆ°æœ‰æœ¨æœ‰:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://img-blog.csdnimg.cn/img_convert/61bfe8240cd5d1648037da8bdc77ea8e.png&#34; alt=&#34;viewmodelcreate.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;ViewModelStore&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; HashMap&amp;lt;String, ViewModel&amp;gt; mMap = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; HashMap&amp;lt;&amp;gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;put&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(String key, ViewModel viewModel)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        ViewModel oldViewModel = mMap.put(key, viewModel);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (oldViewModel != &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;) oldViewModel.onCleared();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; ViewModel &lt;span class=&#34;title&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(String key)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; mMap.get(key);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;Set&amp;lt;String&amp;gt; &lt;span class=&#34;title&#34;&gt;keys&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; HashSet&amp;lt;&amp;gt;(mMap.keySet());&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;clear&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; (ViewModel vm : mMap.values()) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            vm.clear();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        mMap.clear();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/08/IG8UgA.png&#34; alt=&#34;IG8UgA.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;viewmodelæ„ä¹‰&#34;&gt;ViewModelæ„ä¹‰&lt;a title=&#34;#viewmodelæ„ä¹‰&#34; href=&#34;#viewmodelæ„ä¹‰&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/08/IGd3ff.png&#34; alt=&#34;IGd3ff.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/08/IGwfKg.png&#34; alt=&#34;IGwfKg.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://onion99.github.io/2021/11/30/hu0861X6Ltf32fYt/</guid>
            <title>æºç å­¦ä¹  - DataBinding</title>
            <link>https://onion99.github.io/2021/11/30/hu0861X6Ltf32fYt/</link>
            <category>æºç è§£æ</category>
            <pubDate>Tue, 30 Nov 2021 07:27:07 +0800</pubDate>
            <description><![CDATA[ &lt;h3 id=&#34;sameple&#34;&gt;Sameple&lt;a title=&#34;#sameple&#34; href=&#34;#sameple&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;é¦–å…ˆ,æˆ‘ä»¬æ¥çœ‹çœ‹DataBindingä½¿ç”¨:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç»™layoutæ–‡ä»¶å¥—å¨ƒ:&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight xml&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;utf-8&amp;quot;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;layout&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;FrameLayout&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;androidx.viewpager.widget.ViewPager&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;            &lt;span class=&#34;attr&#34;&gt;android:id&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;@+id/home_pager&amp;quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;com.flyco.tablayout.SlidingTabLayout&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;            &lt;span class=&#34;attr&#34;&gt;android:id&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;@+id/home_tab&amp;quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;FrameLayout&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;layout&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;åœ¨Fragmentæˆ–è€…Viewä¸­è·å–bindingå¯¹è±¡&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight kotlin&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;binding = DataBindingUtil.inflate(inflater,layoutRes,container,&lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;è¶…,å°±æ˜¯è¿™ä¹ˆç®€å•,æ¥ä»&lt;code&gt;inflate&lt;/code&gt;å¼€å§‹è§£æ&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;h3 id=&#34;databindingutil.inflateæ¢³ç†&#34;&gt;DataBindingUtil.inflateæ¢³ç†&lt;a title=&#34;#databindingutil.inflateæ¢³ç†&#34; href=&#34;#databindingutil.inflateæ¢³ç†&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;static&lt;/span&gt; &amp;lt;T extends ViewDataBinding&amp;gt; &lt;span class=&#34;function&#34;&gt;T &lt;span class=&#34;title&#34;&gt;inflate&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;        &lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; LayoutInflater inflater, &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; layoutId, &lt;span class=&#34;meta&#34;&gt;@Nullable&lt;/span&gt; ViewGroup parent,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; attachToParent, &lt;span class=&#34;meta&#34;&gt;@Nullable&lt;/span&gt; DataBindingComponent bindingComponent)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// æ£€æŸ¥åº·åº·æ˜¯ä¸æ˜¯å­layouté™„åŠ åˆ°çˆ¶layout,ä¸€èˆ¬æ˜¯false,å› ä¸ºå¦‚æœä¸ºtureä¼šå¯¼è‡´å­layoutçš„layoutparams å¤±æ•ˆ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; useChildren = parent != &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; attachToParent;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// ä¸Šé¢ä¸€èˆ¬ä¸ºfalse,é‚£è¿™é‡Œä¸€èˆ¬ä¹Ÿæ˜¯é›¶è›‹å•Š&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; startChildren = useChildren ? parent.getChildCount() : &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// è§£æxmlç”ŸæˆView,æ”¾ç©ºå¤§è„‘å°±æ˜¯è¿™æ ·,æ·±ç©¶çš„è¯,æˆ‘åªèƒ½ç”©ä¸€ç¯‡éƒ­ç¥çš„æ–‡ç« äº†:https://blog.csdn.net/guolin_blog/article/details/12921889&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// ä»€ä¹ˆå…·ä½“inflateæ˜¯æ€ä¹ˆæ ·,ä¸å¬ä¸å¬ç‹å…«å¿µç»&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; View view = inflater.inflate(layoutId, parent, attachToParent);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// å˜¿å˜¿,è¿™é‡Œå¼€å§‹binding&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (useChildren) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; bindToAddedViews(bindingComponent, parent, startChildren, layoutId);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; bind(bindingComponent, view, layoutId);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;...&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;static&lt;/span&gt; DataBinderMapper sMapper = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; DataBinderMapperImpl();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;static&lt;/span&gt; &amp;lt;T extends ViewDataBinding&amp;gt; &lt;span class=&#34;function&#34;&gt;T &lt;span class=&#34;title&#34;&gt;bind&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(DataBindingComponent bindingComponent, View root,&lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; layoutId)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// ä¸ç†äº†,è¿™é‡Œå°±æ‹¿åˆ°bindingäº†,å¯ä»¥ç›´æ¥å¼•ç”¨Viewäº†,åœæ­¢æ€è€ƒ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; (T) sMapper.getDataBinder(bindingComponent, root, layoutId);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;é—®é¢˜æ¥äº†,å®ƒæ˜¯æ€ä¹ˆå–å¾—æˆ‘è¦çš„DataBindingå¯¹è±¡ä¸”åˆæ˜¯æ€ä¹ˆå®ç°Viewç»‘å®šçš„?&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¥½,æ¥åº·åº·,è¿™ä¸ª&lt;code&gt;DataBinderMapperImpl&lt;/code&gt;,è¿™æ˜¯ç¼–è¯‘é˜¶æ®µä¸‹kaptè‡ªåŠ¨ç”Ÿæˆçš„:&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;package&lt;/span&gt; androidx.databinding;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// å¥½å®¶ä¼™,è¿™é‡Œç›´æ¥ç»§æ‰¿MergedDataBinderMapper &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;DataBinderMapperImpl&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;MergedDataBinderMapper&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  DataBinderMapperImpl() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// æ·»åŠ kaptä¸‹ç”Ÿæˆå½“å‰Moduleçš„DataBinderMapperImpl&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    addMapper(&lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; com.xxx.xxx.DataBinderMapperImpl());&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;...&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// åˆå¹¶å…¶ä»–Mapperçš„DataBindingMapper &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;MergedDataBinderMapper&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;DataBinderMapper&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; Set&amp;lt;Class&amp;lt;? extends DataBinderMapper&amp;gt;&amp;gt; mExistingMappers = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; HashSet&amp;lt;&amp;gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// æ·»åŠ Mapper,å¦‚æœå·²ç»å­˜åœ¨åˆ™å¿½ç•¥&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;addMapper&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(DataBinderMapper mapper)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        Class&amp;lt;? extends DataBinderMapper&amp;gt; mapperClass = mapper.getClass();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (mExistingMappers.add(mapperClass)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            mMappers.add(mapper);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; List&amp;lt;DataBinderMapper&amp;gt; dependencies = mapper.collectDependencies();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt;(DataBinderMapper dependency : dependencies) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                addMapper(dependency);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;&lt;code&gt;MergedDataBinderMapper.getDataBinder&lt;/code&gt;:&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; ViewDataBinding &lt;span class=&#34;title&#34;&gt;getDataBinder&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(DataBindingComponent bindingComponent, View view,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; layoutId)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// éå†ä¹‹å‰æ·»åŠ çš„mMappers    &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt;(DataBinderMapper mapper : mMappers) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// å¥½äº†,è¿™é‡Œè·å–å¯¹åº”çš„Mapperçš„DataBinder,è¶…,æƒ³æƒ³ä¹‹å‰æ·»åŠ äº†å“ªä¸ªMapper&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// æ²¡é”™,ä¸æ­£å¥½å¯¹ä¸Štmdçš„ä¸Šé¢1çš„com.xxx.xxx.DataBinderMapperImpl()&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        ViewDataBinding result = mapper.getDataBinder(bindingComponent, view, layoutId);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (result != &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;) &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; result;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (loadFeatures()) &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; getDataBinder(bindingComponent, view, layoutId);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;è®©æˆ‘ä»¬æ¥åº·åº·kaptç”Ÿæˆçš„&lt;code&gt;com.xxx.xxx.DataBinderMapperImpl()&lt;/code&gt;åˆ°åº•æœ‰ä»€ä¹ˆ&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;DataBinderMapperImpl&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;DataBinderMapper&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;comment&#34;&gt;// layout id ç´¢å¼•&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; LAYOUT_FRAGMENTHOME = &lt;span class=&#34;number&#34;&gt;40&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; SparseIntArray INTERNAL_LAYOUT_ID_LOOKUP = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; SparseIntArray(&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;static&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    INTERNAL_LAYOUT_ID_LOOKUP.put(com.xmiles.callshow.R.layout.fragment_home, LAYOUT_FRAGMENTHOME);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; ViewDataBinding &lt;span class=&#34;title&#34;&gt;getDataBinder&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(DataBindingComponent component, View view, &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; layoutId)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// æ‹¿åˆ°ç´¢å¼•çš„id&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; localizedLayoutId = INTERNAL_LAYOUT_ID_LOOKUP.get(layoutId);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(localizedLayoutId &amp;gt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; Object tag = view.getTag();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;comment&#34;&gt;// åˆ¤æ–­tag&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(tag == &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;)&lt;span class=&#34;keyword&#34;&gt;throw&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; RuntimeException(&lt;span class=&#34;string&#34;&gt;&amp;quot;view must have a tag&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;comment&#34;&gt;// è¿™é‡Œå¦‚æœå¸ƒå±€æ•°é‡è¶…50,ä¸ºé¿å…ä¸€ä¸ªæ–¹æ³•ä½“è¿‡å¤§,ä¼šé¢å¤–æ–°å»ºå¦å¤–ä¸€ä¸ªå‡½æ•°å»å¤„ç†,è¿™é‡Œä¸ºå¥½å±•ç¤º,æ•´ä¸ªç±»æˆ‘å°±åˆ é™¤äº†å¾ˆå¤šå…¶ä»–å¸ƒå±€å‚æ•°&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; methodIndex = (localizedLayoutId - &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;) / &lt;span class=&#34;number&#34;&gt;50&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;comment&#34;&gt;// è·Ÿæ®å¯¹åº”componetç”Ÿæˆå¯¹åº”çš„ViewDetaBinding&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;switch&lt;/span&gt;(methodIndex) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;case&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;          &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; internalGetViewDataBinding0(component, view, localizedLayoutId, tag);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;case&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;          &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; internalGetViewDataBinding1(component, view, localizedLayoutId, tag);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;comment&#34;&gt;// GetViewDataBinding&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; ViewDataBinding &lt;span class=&#34;title&#34;&gt;internalGetViewDataBinding0&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(DataBindingComponent component,View view, &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; internalId, Object tag)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;switch&lt;/span&gt;(internalId) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;case&lt;/span&gt;  LAYOUT_FRAGMENTHOME: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;string&#34;&gt;&amp;quot;layout/fragment_home_0&amp;quot;&lt;/span&gt;.equals(tag)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;          &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; FragmentHomeBindingImpl(component, view);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;throw&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; IllegalArgumentException(&lt;span class=&#34;string&#34;&gt;&amp;quot;The tag for fragment_home is invalid. Received: &amp;quot;&lt;/span&gt; + tag);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;refer&#34;&gt;Refer&lt;a title=&#34;#refer&#34; href=&#34;#refer&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.jianshu.com/p/4be20cc58f17&#34; target=&#34;_blank&#34;&gt;Androidæ¶æ„ç»„ä»¶ä¹‹DataBindingæºç è§£æ - ç®€ä¹¦ (jianshu.com)&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://www.jianshu.com/p/4e9a1ab05bb5&#34; target=&#34;_blank&#34;&gt;DataBindingæºç åˆ†æ - ç®€ä¹¦ (jianshu.com)&lt;/a&gt;&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://onion99.github.io/2021/11/08/qX2v7eB61IheaBrH/</guid>
            <title>Javaå¹¶å‘(4) - CAS</title>
            <link>https://onion99.github.io/2021/11/08/qX2v7eB61IheaBrH/</link>
            <category>å¹¶å‘</category>
            <pubDate>Mon, 08 Nov 2021 02:59:57 +0800</pubDate>
            <description><![CDATA[ &lt;p&gt;é”æœºåˆ¶é—®é¢˜:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨å¤šçº¿ç¨‹ç«äº‰ä¸‹ï¼ŒåŠ é”ã€é‡Šæ”¾é”ä¼šå¯¼è‡´æ¯”è¾ƒå¤šçš„ä¸Šä¸‹æ–‡åˆ‡æ¢å’Œè°ƒåº¦å»¶æ—¶ï¼Œå¼•èµ·æ€§èƒ½é—®é¢˜&lt;/li&gt;
&lt;li&gt;ä¸€ä¸ªçº¿ç¨‹æŒæœ‰é”ä¼šå¯¼è‡´å…¶å®ƒæ‰€æœ‰éœ€è¦æ­¤é”çš„çº¿ç¨‹æŒ‚èµ·&lt;/li&gt;
&lt;li&gt;å¦‚æœä¸€ä¸ªä¼˜å…ˆçº§é«˜çš„çº¿ç¨‹ç­‰å¾…ä¸€ä¸ªä¼˜å…ˆçº§ä½çš„çº¿ç¨‹é‡Šæ”¾é”ä¼šå¯¼è‡´ä¼˜å…ˆçº§å€’ç½®ï¼Œå¼•èµ·æ€§èƒ½é£é™©&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;volatile æ˜¯ä¸é”™çš„æœºåˆ¶ï¼Œä½†æ˜¯ volatile ä¸èƒ½ä¿è¯åŸå­æ€§ï¼Œå› æ­¤å¯¹äºåŒæ­¥æœ€ç»ˆè¿˜æ˜¯è¦å›åˆ°é”æœºåˆ¶ä¸Šæ¥ã€‚ç‹¬å é”æ˜¯ä¸€ç§æ‚²è§‚é”ï¼Œsynchronized å°±æ˜¯ä¸€ç§ç‹¬å é”ï¼Œä¼šå¯¼è‡´å…¶å®ƒæ‰€æœ‰éœ€è¦é”çš„çº¿ç¨‹æŒ‚èµ·ï¼Œç­‰å¾…æŒæœ‰é”çš„çº¿ç¨‹é‡Šæ”¾é”ã€‚è€Œå¦ä¸€ä¸ªæ›´åŠ æœ‰æ•ˆçš„é”å°±æ˜¯ä¹è§‚é”&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¹è§‚é”å³æ€»æ˜¯å‡è®¾æœ€å¥½çš„æƒ…å†µï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¸ä¼šä¿®æ”¹ï¼Œæ‰€ä»¥ä¸ä¼šä¸Šé”ï¼Œä½†æ˜¯åœ¨æ›´æ–°çš„æ—¶å€™ä¼šåˆ¤æ–­ä¸€ä¸‹åœ¨æ­¤æœŸé—´åˆ«äººæœ‰æ²¡æœ‰å»æ›´æ–°è¿™ä¸ªæ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ç‰ˆæœ¬å·æœºåˆ¶å’Œ CAS ç®—æ³•å®ç°&lt;/p&gt;
&lt;/blockquote&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;h3 id=&#34;åŸå­æ“ä½œ&#34;&gt;åŸå­æ“ä½œ&lt;a title=&#34;#åŸå­æ“ä½œ&#34; href=&#34;#åŸå­æ“ä½œ&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;æ‰€è°“â€œåŸå­â€æ“ä½œï¼Œæ˜¯æŒ‡ä¸€ç»„ä¸å¯åˆ†å‰²çš„æ“ä½œï¼šæ“ä½œè€…å¯¹ç›®æ ‡å¯¹è±¡è¿›è¡Œæ“ä½œæ—¶ï¼Œè¦ä¹ˆå®Œæˆæ‰€æœ‰æ“ä½œåå…¶ä»–æ“ä½œè€…æ‰èƒ½æ“ä½œï¼›è¦ä¹ˆè¿™ä¸ªæ“ä½œè€…ä¸èƒ½è¿›è¡Œä»»ä½•æ“ä½œ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/04/Ie5YA1.png&#34; alt=&#34;Ie5YA1.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;TestAtomic&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(String[] args)&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;throws&lt;/span&gt; Exception &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// å®ä¾‹åŒ–äº†ä¸€ä¸ªAtomicIntegerç±»çš„å¯¹è±¡atomicå¹¶å®šä¹‰åˆå§‹å€¼ä¸º1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        AtomicInteger atomic = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; AtomicInteger(&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// è¿›è¡Œatomicçš„åŸå­åŒ–æ“ä½œï¼šå¢åŠ 1å¹¶ä¸”è·å–è¿™ä¸ªå¢åŠ åçš„æ–°å€¼&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        atomic.incrementAndGet();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;cas-åŸç†&#34;&gt;CAS åŸç†&lt;a title=&#34;#cas-åŸç†&#34; href=&#34;#cas-åŸç†&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;CAS çš„æ€æƒ³å¾ˆç®€å•ï¼Œä¸‰ä¸ªå‚æ•°ï¼šå½“å‰å†…å­˜å€¼ Vã€æ—§çš„é¢„æœŸå€¼ Aã€å³å°†æ›´æ–°çš„å€¼ Bï¼Œå½“ä¸”ä»…å½“é¢„æœŸå€¼ A å’Œå†…å­˜å€¼ V ç›¸åŒæ—¶ï¼Œå°†å†…å­˜å€¼ä¿®æ”¹ä¸º B å¹¶è¿”å› trueï¼Œå¦åˆ™ä»€ä¹ˆéƒ½ä¸åšï¼Œå¹¶è¿”å› falseã€‚æˆ‘ä»¬æ‹¿ AtomicInteger ç±»æ¥åˆ†æï¼Œå…ˆæ¥çœ‹çœ‹ AtomicInteger é™æ€ä»£ç å—ç‰‡æ®µ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;casç¼ºç‚¹&#34;&gt;CASç¼ºç‚¹&lt;a title=&#34;#casç¼ºç‚¹&#34; href=&#34;#casç¼ºç‚¹&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;å¾ªç¯æ—¶é—´é•¿å¼€é”€å¾ˆå¤§&lt;/li&gt;
&lt;li&gt;åªèƒ½ä¿è¯ä¸€ä¸ªå…±äº«å˜é‡çš„åŸå­æ“ä½œ&lt;/li&gt;
&lt;li&gt;ABAé—®é¢˜&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;ä¾‹å­&#34;&gt;ä¾‹å­&lt;a title=&#34;#ä¾‹å­&#34; href=&#34;#ä¾‹å­&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;1.åœ¨å†…å­˜åœ°å€Vå½“ä¸­ï¼Œå­˜å‚¨ç€å€¼ä¸º10çš„å˜é‡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://s1.ax1x.com/2022/03/17/q9xFtf.png&#34; alt=&#34;q9xFtf.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;p&gt;2.æ­¤æ—¶çº¿ç¨‹1æƒ³è¦æŠŠå˜é‡çš„å€¼å¢åŠ 1ã€‚å¯¹çº¿ç¨‹1æ¥è¯´ï¼Œæ—§çš„é¢„æœŸå€¼A=10ï¼Œè¦ä¿®æ”¹çš„æ–°å€¼B=11ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://s1.ax1x.com/2022/03/17/q9x90I.png&#34; alt=&#34;q9x90I.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;p&gt;3.åœ¨çº¿ç¨‹1è¦æäº¤æ›´æ–°ä¹‹å‰ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹2æŠ¢å…ˆä¸€æ­¥ï¼ŒæŠŠå†…å­˜åœ°å€Vä¸­çš„å˜é‡å€¼ç‡å…ˆæ›´æ–°æˆäº†11ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://s1.ax1x.com/2022/03/17/q9vv1e.png&#34; alt=&#34;q9vv1e.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;p&gt;4.çº¿ç¨‹1å¼€å§‹æäº¤æ›´æ–°ï¼Œé¦–å…ˆè¿›è¡ŒAå’Œåœ°å€Vçš„å®é™…å€¼æ¯”è¾ƒï¼ˆCompareï¼‰ï¼Œå‘ç°Aä¸ç­‰äºVçš„å®é™…å€¼ï¼Œæäº¤å¤±è´¥ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://s1.ax1x.com/2022/03/17/q9v56J.png&#34; alt=&#34;q9v56J.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;p&gt;5.çº¿ç¨‹1é‡æ–°è·å–å†…å­˜åœ°å€Vçš„å½“å‰å€¼ï¼Œå¹¶é‡æ–°è®¡ç®—æƒ³è¦ä¿®æ”¹çš„æ–°å€¼ã€‚æ­¤æ—¶å¯¹çº¿ç¨‹1æ¥è¯´ï¼ŒA=11ï¼ŒB=12ã€‚è¿™ä¸ªé‡æ–°å°è¯•çš„è¿‡ç¨‹è¢«ç§°ä¸ºè‡ªæ—‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://s1.ax1x.com/2022/03/17/q9v8OA.png&#34; alt=&#34;q9v8OA.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;p&gt;6.è¿™ä¸€æ¬¡æ¯”è¾ƒå¹¸è¿ï¼Œæ²¡æœ‰å…¶ä»–çº¿ç¨‹æ”¹å˜åœ°å€Vçš„å€¼ã€‚çº¿ç¨‹1è¿›è¡ŒCompareï¼Œå‘ç°Aå’Œåœ°å€Vçš„å®é™…å€¼æ˜¯ç›¸ç­‰çš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://s1.ax1x.com/2022/03/17/q9vmo6.png&#34; alt=&#34;q9vmo6.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;p&gt;7.çº¿ç¨‹1è¿›è¡ŒSWAPï¼ŒæŠŠåœ°å€Vçš„å€¼æ›¿æ¢ä¸ºBï¼Œä¹Ÿå°±æ˜¯12ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://s1.ax1x.com/2022/03/17/q9j9vd.png&#34; alt=&#34;q9j9vd.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä»æ€æƒ³ä¸Šæ¥è¯´ï¼ŒSynchronizedå±äºæ‚²è§‚é”ï¼Œæ‚²è§‚åœ°è®¤ä¸ºç¨‹åºä¸­çš„å¹¶å‘æƒ…å†µä¸¥é‡ï¼Œæ‰€ä»¥ä¸¥é˜²æ­»å®ˆã€‚CASå±äºä¹è§‚é”ï¼Œä¹è§‚åœ°è®¤ä¸ºç¨‹åºä¸­çš„å¹¶å‘æƒ…å†µä¸é‚£ä¹ˆä¸¥é‡ï¼Œæ‰€ä»¥è®©çº¿ç¨‹ä¸æ–­å»å°è¯•æ›´æ–°ï¼Œæœ€ç»ˆå¯ä»¥ç†è§£æˆä¸€ä¸ªæ— é˜»å¡å¤šçº¿ç¨‹äº‰æŠ¢èµ„æºçš„æ¨¡å‹&lt;/p&gt;
&lt;h3 id=&#34;å‚è€ƒ&#34;&gt;å‚è€ƒ&lt;a title=&#34;#å‚è€ƒ&#34; href=&#34;#å‚è€ƒ&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.jianshu.com/p/ae25eb3cfb5d&#34; target=&#34;_blank&#34;&gt;Javaï¼šCAS(ä¹è§‚é”) &lt;/a&gt;&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://onion99.github.io/2021/11/04/cNDSpE5p4avS2tOi/</guid>
            <title>è‡ªå®šä¹‰View(11) - æ»šåŠ¨é€Ÿåº¦å’Œæ»šåŠ¨è®¡ç®—</title>
            <link>https://onion99.github.io/2021/11/04/cNDSpE5p4avS2tOi/</link>
            <category>å›¾å½¢ç»˜åˆ¶</category>
            <pubDate>Thu, 04 Nov 2021 06:09:36 +0800</pubDate>
            <description><![CDATA[ &lt;h3 id=&#34;velocitytracker&#34;&gt;VelocityTracker&lt;a title=&#34;#velocitytracker&#34; href=&#34;#velocitytracker&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;è·Ÿè¸ªæ‰‹æŒ‡åœ¨æ»‘åŠ¨è¿‡ç¨‹ä¸­çš„é€Ÿåº¦ï¼ŒåŒ…æ‹¬æ°´å¹³å’Œç«–ç›´æ–¹å‘çš„é€Ÿåº¦&lt;/p&gt;
&lt;/blockquote&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;VelocityTrackerTestView&lt;/span&gt;(&lt;span class=&#34;title&#34;&gt;context&lt;/span&gt;: &lt;span class=&#34;title&#34;&gt;Context&lt;/span&gt;?, &lt;span class=&#34;title&#34;&gt;attrs&lt;/span&gt;: &lt;span class=&#34;title&#34;&gt;AttributeSet&lt;/span&gt;?) : &lt;span class=&#34;title&#34;&gt;View&lt;/span&gt;(&lt;span class=&#34;title&#34;&gt;context&lt;/span&gt;, &lt;span class=&#34;title&#34;&gt;attrs&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//1ã€åˆ›å»ºå®ä¾‹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; mVelocityTracker = VelocityTracker.obtain()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@SuppressLint(&amp;quot;ClickableViewAccessibility&amp;quot;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;override fun &lt;span class=&#34;title&#34;&gt;onTouchEvent&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(event: MotionEvent)&lt;/span&gt;: Boolean &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//2ã€é‡ç½®&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (event.actionMasked == MotionEvent.ACTION_DOWN) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            mVelocityTracker.clear()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//3ã€å¼€å§‹è¿½è¸ª&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        mVelocityTracker.addMovement(event)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        when (event.actionMasked) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            MotionEvent.ACTION_DOWN -&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;comment&#34;&gt;//...&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            MotionEvent.ACTION_MOVE -&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;comment&#34;&gt;//o...&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            MotionEvent.ACTION_UP -&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;comment&#34;&gt;//é€Ÿåº¦ = ï¼ˆ ç»ˆç‚¹ä½ç½®(px) - èµ·ç‚¹ä½ç½®(px) ï¼‰/ æ—¶é—´æ®µ(ms)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;comment&#34;&gt;//4ã€è®¾ç½®æ—¶é—´æ®µ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                mVelocityTracker.computeCurrentVelocity(&lt;span class=&#34;number&#34;&gt;1000&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;comment&#34;&gt;//5ã€è·å–xæ–¹å‘ã€yæ–¹å‘çš„é€Ÿåº¦&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;comment&#34;&gt;//å…¶ä¸­getXVelocityã€getYVelocityæ–¹æ³•çš„å‚æ•°æ˜¯pointerIdï¼Œç”¨äºå¤šæŒ‡è§¦æ§ã€‚ä¸è€ƒè™‘å¤šæŒ‡æ—¶ï¼Œå¯ä»¥ä¸ç”¨ä¼ å‚æ•°&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; xVelocity = mVelocityTracker.getXVelocity(&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; yVelocity = mVelocityTracker.getYVelocity(&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;comment&#34;&gt;//...&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;override fun &lt;span class=&#34;title&#34;&gt;onDetachedFromWindow&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//6ã€å½“ä¸éœ€è¦ä½¿ç”¨æ—¶ï¼Œé‡ç½®å¹¶å›æ”¶å†…å­˜&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        mVelocityTracker.clear()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        mVelocityTracker.recycle()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;super&lt;/span&gt;.onDetachedFromWindow()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;VelocityTracker ä¸€èˆ¬ç”¨æ¥åˆ¤æ–­å½“å‰æ˜¯å¦è¾¾åˆ°ä¸€å®šçš„æ»‘åŠ¨é€Ÿåº¦æ¥è§¦å‘ Fling çš„æ•ˆæœï¼Œè¿™ä¸ªæ»‘åŠ¨é€Ÿåº¦æˆ‘ä»¬å¯ä»¥è‡ªå·±è®¾ç½®ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ç³»ç»Ÿæä¾›çš„æ¥è·å–&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; mViewConfiguration : ViewConfiguration = ViewConfiguration.get(context)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; mMaxFlingVelocity = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//è§¦å‘flingçš„é€Ÿåº¦&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; mMinFlingVelocity = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;init &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    mMaxFlingVelocity = mViewConfiguration.scaledMaximumFlingVelocity&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    mMinFlingVelocity = mViewConfiguration.scaledMinimumFlingVelocity&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;scroller&#34;&gt;Scroller&lt;a title=&#34;#scroller&#34; href=&#34;#scroller&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;åœ¨ View ç±»é‡Œé¢ï¼Œæœ‰ä¸¤ä¸ªå’Œæ»šåŠ¨ç›¸å…³çš„ç±» scrollTo() å’Œ scrollByã€‚è¿™ä¸¤ä¸ªæ–¹æ³•å¯ä»¥å®ç° View å†…å®¹çš„ç§»åŠ¨ï¼Œæ¯”å¦‚è¯´ä¸€ä¸ª TextViewï¼Œå¦‚æœä½¿ç”¨ scrollTo()ï¼Œé‚£ä¹ˆç§»åŠ¨çš„æ˜¯é‡Œé¢çš„æ–‡å­—è€Œä¸æ˜¯ä½ç½®ï¼ŒscrollBy() ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚é‚£ä¹ˆä¸ºä»€ä¹ˆæ˜¯ç§»åŠ¨ï¼Œä¸æ˜¯æ»šåŠ¨å‘¢ï¼Ÿè¿™æ˜¯å› ä¸ºè¿™ä¸¤ä¸ªæ–¹æ³•éƒ½æ˜¯ç¬é—´å®Œæˆï¼Œè€Œä¸æ˜¯å¸¦æœ‰æ»šåŠ¨è¿‡ç¨‹çš„æ»šåŠ¨ï¼Œæ‰€ä»¥è¯´å¦‚æœè¦å®ç°æ•ˆæœæ¯”è¾ƒå¥½çš„æ»šåŠ¨è¿˜æ˜¯éœ€è¦ Scroller&lt;/p&gt;
&lt;p&gt;å¸¸ç”¨API:&lt;/p&gt;
&lt;div class=&#34;Ï†bq&#34;&gt;&lt;div class=&#34;Ï†bs&#34;&gt;&lt;table&gt;&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;API&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;ç®€ä»‹&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;computeScrollOffset()&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;åˆ¤æ–­å½“å‰çš„æ»‘åŠ¨åŠ¨ä½œæ˜¯å¦å®Œæˆçš„&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;getCurrX()ã€getCurrY()&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;è·å–å½“å‰æ»‘åŠ¨çš„åæ ‡å€¼&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;getFinalX()ã€getFinalY()&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;è·å–æœ€ç»ˆæ»‘åŠ¨åœæ­¢æ—¶çš„åæ ‡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;isFinished()&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;ç”¨æ¥åˆ¤æ–­å½“å‰æ»šåŠ¨æ˜¯å¦ç»“æŸ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;startScroll(int startX, int startY, int dx, int dy)&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;ç”¨æ¥å¼€å§‹æ»šåŠ¨ï¼Œè¿™ä¸ªæ˜¯å¾ˆé‡è¦çš„ä¸€ä¸ªè§¦å‘computeScroll()çš„æ–¹æ³•ï¼Œè°ƒç”¨è¿™ä¸ªæ–¹æ³•ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨computeScrollé‡Œé¢è·å–æ»šåŠ¨çš„ä¿¡æ¯ï¼Œç„¶åå®Œæˆæˆ‘ä»¬çš„éœ€è¦ã€‚è¿™ä¸ªè¿˜æœ‰ä¸€ä¸ªå¸¦æœ‰æ»šåŠ¨æŒç»­æ—¶é—´çš„é‡è½½å‡½æ•°ï¼Œå¯ä»¥æ ¹æ®éœ€æ±‚è‡ªç”±ä½¿ç”¨ã€‚ç‰¹åˆ«è¦æ³¨æ„è¿™å››ä¸ªå‚æ•°ï¼ŒstartXå’ŒstartYæ˜¯å¼€å§‹çš„åæ ‡ä½ç½®ï¼Œæ­£æ•°å·¦ä¸Šï¼Œè´Ÿæ•°å³ä¸‹ï¼Œdxã€dyåŒç†ï¼Œå½“åœ¨computeScroll()è·å–getCurrX()çš„æ—¶å€™ï¼Œå˜åŒ–èŒƒå›´å°±ä¸è¿™é‡Œåœ°è®¾ç½®æœ‰å…³ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;&lt;/div&gt;&lt;/div&gt;&lt;h3 id=&#34;overscroller&#34;&gt;OverScroller&lt;a title=&#34;#overscroller&#34; href=&#34;#overscroller&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;å¯¹è¶…å‡ºæ»‘åŠ¨è¾¹ç•Œçš„æƒ…å†µçš„å¤„ç†&lt;/p&gt;
&lt;/blockquote&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://onion99.github.io/2021/11/04/dY7a31QepeVitGkX/</guid>
            <title>è‡ªå®šä¹‰View(10) - GestureDetector</title>
            <link>https://onion99.github.io/2021/11/04/dY7a31QepeVitGkX/</link>
            <category>å›¾å½¢ç»˜åˆ¶</category>
            <pubDate>Thu, 04 Nov 2021 06:08:39 +0800</pubDate>
            <description><![CDATA[ &lt;h3 id=&#34;gesturedetector&#34;&gt;GestureDetector&lt;a title=&#34;#gesturedetector&#34; href=&#34;#gesturedetector&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;div class=&#34;Ï†bq&#34;&gt;&lt;div class=&#34;Ï†bs&#34;&gt;&lt;table&gt;&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç›‘å¬å™¨&lt;/th&gt;
&lt;th&gt;ç®€ä»‹&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;OnContextClickListener&lt;/td&gt;
&lt;td&gt;è¿™ä¸ªå¾ˆå®¹æ˜“è®©äººè”æƒ³åˆ°ContextMenuï¼Œç„¶è€Œå®ƒå’ŒContextMenuå¹¶æ²¡æœ‰ä»€ä¹ˆå…³ç³»ï¼Œå®ƒæ˜¯åœ¨Android6.0(API 23)æ‰æ·»åŠ çš„ä¸€ä¸ªé€‰é¡¹ï¼Œæ˜¯ç”¨äºæ£€æµ‹å¤–éƒ¨è®¾å¤‡ä¸Šçš„æŒ‰é’®æ˜¯å¦æŒ‰ä¸‹çš„ï¼Œä¾‹å¦‚è“ç‰™è§¦æ§ç¬”ä¸Šçš„æŒ‰é’®ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¿½ç•¥å³å¯ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;OnDoubleTapListener&lt;/td&gt;
&lt;td&gt;åŒå‡»äº‹ä»¶ï¼Œæœ‰ä¸‰ä¸ªå›è°ƒç±»å‹ï¼šåŒå‡»(DoubleTap)ã€å•å‡»ç¡®è®¤(SingleTapConfirmed) å’Œ åŒå‡»äº‹ä»¶å›è°ƒ(DoubleTapEvent)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;OnGestureListener&lt;/td&gt;
&lt;td&gt;æ‰‹åŠ¿æ£€æµ‹ï¼Œä¸»è¦æœ‰ä»¥ä¸‹ç±»å‹äº‹ä»¶ï¼šæŒ‰ä¸‹(Down)ã€ ä¸€æ‰”(Fling)ã€é•¿æŒ‰(LongPress)ã€æ»šåŠ¨(Scroll)ã€è§¦æ‘¸åé¦ˆ(ShowPress) å’Œ å•å‡»æŠ¬èµ·(SingleTapUp)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;SimpleOnGestureListener&lt;/td&gt;
&lt;td&gt;è¿™ä¸ªæ˜¯ä¸Šè¿°ä¸‰ä¸ªæ¥å£çš„ç©ºå®ç°ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä½¿ç”¨è¿™ä¸ªæ¯”è¾ƒå¤šï¼Œä¹Ÿæ¯”è¾ƒæ–¹ä¾¿&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;&lt;/div&gt;&lt;/div&gt;&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// 1.åˆ›å»ºä¸€ä¸ªç›‘å¬å›è°ƒ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;SimpleOnGestureListener listener = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; SimpleOnGestureListener() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onDoubleTap&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(MotionEvent e)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        Toast.makeText(MainActivity.&lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;quot;åŒå‡»666&amp;quot;&lt;/span&gt;, Toast.LENGTH_SHORT).show();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;super&lt;/span&gt;.onDoubleTap(e);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// 2.åˆ›å»ºä¸€ä¸ªæ£€æµ‹å™¨&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; GestureDetector detector = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; GestureDetector(&lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;, listener);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// 3.ç»™ç›‘å¬å™¨è®¾ç½®æ•°æ®æº&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;view.setOnTouchListener(&lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; View.OnTouchListener() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onTouch&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(View v, MotionEvent event)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; detector.onTouchEvent(event);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;scalegesturedetector&#34;&gt;ScaleGestureDetector&lt;a title=&#34;#scalegesturedetector&#34; href=&#34;#scalegesturedetector&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;Android ç¼©æ”¾æ‰‹åŠ¿æ£€æµ‹ ScaleGestureDetectorï¼Œåœ¨å¤§å¤šæ•°çš„æƒ…å†µä¸‹ç¼©æ”¾æ‰‹åŠ¿éƒ½ä¸æ˜¯å•ç‹¬å­˜åœ¨çš„ï¼Œéœ€è¦é…åˆå…¶å®ƒçš„æ‰‹åŠ¿æ¥ä½¿ç”¨&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;sample&#34;&gt;sample&lt;a title=&#34;#sample&#34; href=&#34;#sample&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;ScaleGestureDemoView&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;View&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; String TAG = &lt;span class=&#34;string&#34;&gt;&amp;quot;ScaleGestureDemoView&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; ScaleGestureDetector mScaleGestureDetector;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;ScaleGestureDemoView&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(Context context)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;super&lt;/span&gt;(context);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;ScaleGestureDemoView&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(Context context, &lt;span class=&#34;meta&#34;&gt;@Nullable&lt;/span&gt; AttributeSet attrs)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;super&lt;/span&gt;(context, attrs);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        initScaleGestureDetector();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;initScaleGestureDetector&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        mScaleGestureDetector = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; ScaleGestureDetector(getContext(), &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; ScaleGestureDetector.SimpleOnScaleGestureListener() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onScaleBegin&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(ScaleGestureDetector detector)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onScale&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(ScaleGestureDetector detector)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                Log.i(TAG, &lt;span class=&#34;string&#34;&gt;&amp;quot;focusX = &amp;quot;&lt;/span&gt; + detector.getFocusX());       &lt;span class=&#34;comment&#34;&gt;// ç¼©æ”¾ä¸­å¿ƒï¼Œxåæ ‡&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                Log.i(TAG, &lt;span class=&#34;string&#34;&gt;&amp;quot;focusY = &amp;quot;&lt;/span&gt; + detector.getFocusY());       &lt;span class=&#34;comment&#34;&gt;// ç¼©æ”¾ä¸­å¿ƒyåæ ‡&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                Log.i(TAG, &lt;span class=&#34;string&#34;&gt;&amp;quot;scale = &amp;quot;&lt;/span&gt; + detector.getScaleFactor());   &lt;span class=&#34;comment&#34;&gt;// ç¼©æ”¾å› å­&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onScaleEnd&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(ScaleGestureDetector detector)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onTouchEvent&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(MotionEvent event)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        mScaleGestureDetector.onTouchEvent(event);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://onion99.github.io/2021/11/04/z3aQsRLVolBbFVsl/</guid>
            <title>è‡ªå®šä¹‰View(9) - äº‹ä»¶åˆ†å‘</title>
            <link>https://onion99.github.io/2021/11/04/z3aQsRLVolBbFVsl/</link>
            <category>å›¾å½¢ç»˜åˆ¶</category>
            <pubDate>Thu, 04 Nov 2021 06:07:31 +0800</pubDate>
            <description><![CDATA[ &lt;blockquote&gt;
&lt;p&gt;äº‹ä»¶åˆ†å‘çš„è¿‡ç¨‹å…¶å®ä¹Ÿå°±æ˜¯äº‹ä»¶ä¼ é€’è¿‡ç¨‹ã€‚äº‹ä»¶ä¼ é€’çš„é¡ºåºç”±Acticityä¼ é€’åˆ°æ ¹Viewï¼Œè¿™ä¸ªæ ¹View é€šå¸¸æ˜¯ä¸€ä¸ªViewGroup(ViewGroupæœ¬èº«ä¹Ÿæ˜¯Viewçš„å­ç±»)ï¼Œç„¶åå†ä¼ é€’ç»™ViewGroupä¸‹çš„å­View, è‹¥äº‹ä»¶åœ¨è‡ªä¸Šè€Œä¸‹çš„ä¼ é€’è¿‡ç¨‹ä¸­ä¸€ç›´æ²¡æœ‰è¢«æ¶ˆè´¹ï¼Œåˆ™äº‹ä»¶ä¼šåå‘å‘ä¸Šä¼ é€’ï¼Œæ­¤æ—¶çˆ¶ViewGroupå¯ä»¥å¯¹äº‹ä»¶è¿›è¡Œæ¶ˆè´¹ï¼Œè‹¥ä»ç„¶æ²¡æœ‰è¢«æ¶ˆè´¹çš„è¯ï¼Œæœ€åä¼šå›åˆ°Activityçš„onTouchEvent&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ‰€ä»¥å¾ˆå¤šæ—¶å€™å¦‚æœæœ‰å†²çªçš„è¯,æœ€å…ˆæ¶ˆè´¹çš„æ˜¯æœ€åº•éƒ¨çš„å­View&lt;br&gt;
&lt;img src=&#34;https://z3.ax1x.com/2021/11/03/IE3gqf.png&#34; alt=&#34;IE3gqf.png&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;h3 id=&#34;äº‹ä»¶åˆ†å‘method&#34;&gt;äº‹ä»¶åˆ†å‘Method&lt;a title=&#34;#äº‹ä»¶åˆ†å‘method&#34; href=&#34;#äº‹ä»¶åˆ†å‘method&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;div class=&#34;Ï†bq&#34;&gt;&lt;div class=&#34;Ï†bs&#34;&gt;&lt;table&gt;&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;æ–¹æ³•&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;ä½œç”¨&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;è°ƒç”¨æ—¶åˆ»&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;dispatchTouchEvent()&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;ç”¨æ¥è¿›è¡Œäº‹ä»¶ä¼ é€’&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;å¦‚æœäº‹ä»¶èƒ½å¤Ÿä¼ é€’ç»™å½“å‰ Viewï¼Œé‚£ä¹ˆæ­¤æ–¹æ³•ä¸€å®šä¼šè¢«è°ƒç”¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;onInterceptTouchEvent()&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;ç”¨æ¥æ˜¯å¦æ‹¦æˆªäº‹ä»¶&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;å¦‚æœå½“å‰ View æ‹¦æˆªäº†æŸä¸ªäº‹ä»¶ï¼Œé‚£ä¹ˆåœ¨åŒä¸€ä¸ªäº‹ä»¶åºåˆ—å½“ä¸­ï¼Œæ­¤æ–¹æ³•ä¸ä¼šè¢«å†æ¬¡è°ƒç”¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;onTouchEvent()&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;å¤„ç†äº‹ä»¶&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;åœ¨ dispatchTouchEvent()æ–¹æ³•ä¸­è°ƒç”¨&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;&lt;/div&gt;&lt;/div&gt;&lt;h3 id=&#34;äº‹ä»¶åˆ†å‘é¡ºåº&#34;&gt;äº‹ä»¶åˆ†å‘é¡ºåº&lt;a title=&#34;#äº‹ä»¶åˆ†å‘é¡ºåº&#34; href=&#34;#äº‹ä»¶åˆ†å‘é¡ºåº&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Activity&amp;amp;Window&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;dispatchTouchEvent&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(MotionEvent ev)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (ev.getAction() == MotionEvent.ACTION_DOWN) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        onUserInteraction();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// å½“äº‹ä»¶æ²¡æœ‰è¢«ä»»ä½•å­View æ¶ˆè´¹æ—¶,å³è¿™é‡Œä¸ºfalseæ—¶,æœ€ç»ˆæ‰§è¡Œè‡ªå·±çš„nTouchEvent&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (getWindow().superDispatchTouchEvent(ev)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; onTouchEvent(ev);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;DecorView(FrameLayout çš„å­ç±»)&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;PhoneWindow&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;Window&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;implements&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;MenuBuilder&lt;/span&gt;.&lt;span class=&#34;title&#34;&gt;Callback&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;superDispatchTouchEvent&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(MotionEvent event)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; mDecor.superDispatchTouchEvent(event);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;DecorView&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;FrameLayout&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;implements&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;RootViewSurfaceTaker&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	    &lt;span class=&#34;comment&#34;&gt;//FrameLayout å¹¶æ²¡æœ‰é‡å†™dispatchTouchEventæ–¹æ³•ï¼Œæ‰€ä»¥äº‹ä»¶å¼€å§‹äº¤ç”± ViewGroup çš„ dispatchTouchEvent å¼€å§‹åˆ†å‘äº†&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;superDispatchTouchEvent&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(MotionEvent event)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;super&lt;/span&gt;.dispatchTouchEvent(event);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ViewGroup&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åˆ¤æ–­äº‹ä»¶æ˜¯å¤Ÿéœ€è¦è¢« ViewGroup æ‹¦æˆª&lt;/li&gt;
&lt;li&gt;éå†æ‰€æœ‰å­Viewï¼Œé€ä¸ªåˆ†å‘äº‹ä»¶&lt;/li&gt;
&lt;li&gt;å°†äº‹ä»¶äº¤ç»™ViewGroupè‡ªå·±æˆ–è€…ç›®æ ‡å­Viewå¤„ç†&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;110&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;111&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;112&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;113&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;114&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;115&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;116&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;117&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;118&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;119&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;120&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;121&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;122&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;123&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;124&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;125&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;126&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;127&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;128&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;129&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;130&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;131&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;132&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;133&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;134&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;dispatchTouchEvent&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(MotionEvent ev)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; handled = &lt;span class=&#34;keyword&#34;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (onFilterTouchEventForSecurity(ev)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; action = ev.getAction();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// å…ˆæ£€éªŒäº‹ä»¶æ˜¯å¦éœ€è¦è¢«ViewGroupæ‹¦æˆª&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; intercepted;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (actionMasked == MotionEvent.ACTION_DOWN || mFirstTouchTarget != &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;// æ ¡éªŒæ˜¯å¦ç»™mGroupFlagsè®¾ç½®äº†FLAG_DISALLOW_INTERCEPTæ ‡å¿—ä½&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; disallowIntercept = (mGroupFlags &amp;amp; FLAG_DISALLOW_INTERCEPT) != &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!disallowIntercept) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;comment&#34;&gt;// èµ°onInterceptTouchEventåˆ¤æ–­æ˜¯å¦æ‹¦æˆªäº‹ä»¶&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                intercepted = onInterceptTouchEvent(ev);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                intercepted = &lt;span class=&#34;keyword&#34;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            intercepted = &lt;span class=&#34;keyword&#34;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; split = (mGroupFlags &amp;amp; FLAG_SPLIT_MOTION_EVENTS) != &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!canceled &amp;amp;&amp;amp; !intercepted) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;// æ³¨æ„ACTION_DOWNç­‰äº‹ä»¶æ‰ä¼šèµ°éå†æ‰€æœ‰å­Viewçš„æµç¨‹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (actionMasked == MotionEvent.ACTION_DOWN&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    || (split &amp;amp;&amp;amp; actionMasked == MotionEvent.ACTION_POINTER_DOWN)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    || actionMasked == MotionEvent.ACTION_HOVER_MOVE) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;comment&#34;&gt;// å¼€å§‹éå†æ‰€æœ‰å­Viewå¼€å§‹é€ä¸ªåˆ†å‘äº‹ä»¶&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; childrenCount = mChildrenCount;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (childrenCount != &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; i = childrenCount - &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;; i &amp;gt;= &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;; i--) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                        &lt;span class=&#34;comment&#34;&gt;// åˆ¤æ–­è§¦æ‘¸ç‚¹æ˜¯å¦åœ¨è¿™ä¸ªViewçš„å†…éƒ¨&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                        &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; View child = children[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!canViewReceivePointerEvents(child)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                || !isTransformedTouchPointInView(x, y, child, &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                            &lt;span class=&#34;keyword&#34;&gt;continue&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                        &lt;span class=&#34;comment&#34;&gt;// äº‹ä»¶è¢«å­Viewæ¶ˆè´¹ï¼Œé€€å‡ºå¾ªç¯ï¼Œä¸å†ç»§ç»­åˆ†å‘ç»™å…¶ä»–å­View&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (dispatchTransformedTouchEvent(ev, &lt;span class=&#34;keyword&#34;&gt;false&lt;/span&gt;, child, idBitsToAssign)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                        &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                            &lt;span class=&#34;comment&#34;&gt;// addTouchTargetå†…éƒ¨å°†mFirstTouchTargetè®¾ç½®ä¸ºchildï¼Œå³ä¸ä¸ºnull&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                            newTouchTarget = addTouchTarget(child, idBitsToAssign);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                            alreadyDispatchedToNewTouchTarget = &lt;span class=&#34;keyword&#34;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                            &lt;span class=&#34;keyword&#34;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// äº‹ä»¶æœªè¢«ä»»ä½•å­Viewæ¶ˆè´¹ï¼Œè‡ªå·±å¤„ç†&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (mFirstTouchTarget == &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;// No touch targets so treat this as an ordinary view.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            handled = dispatchTransformedTouchEvent(ev, canceled, &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    TouchTarget.ALL_POINTER_IDS);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;// å°†MotionEvent.ACTION_DOWNåç»­äº‹ä»¶åˆ†å‘ç»™mFirstTouchTargetæŒ‡å‘çš„View&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            TouchTarget predecessor = &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            TouchTarget target = mFirstTouchTarget;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;while&lt;/span&gt; (target != &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; TouchTarget next = target.next;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;comment&#34;&gt;// å¦‚æœå·²ç»åœ¨ä¸Šé¢çš„éå†è¿‡ç¨‹ä¸­ä¼ é€’è¿‡äº‹ä»¶ï¼Œè·³è¿‡æœ¬æ¬¡ä¼ é€’&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (alreadyDispatchedToNewTouchTarget &amp;amp;&amp;amp; target == newTouchTarget) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    handled = &lt;span class=&#34;keyword&#34;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; cancelChild = resetCancelNextUpFlag(target.child)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                            || intercepted;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (dispatchTransformedTouchEvent(ev, cancelChild,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                            target.child, target.pointerIdBits)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                        handled = &lt;span class=&#34;keyword&#34;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                predecessor = target;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                target = next;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// Update list of touch targets for pointer up or cancel, if needed.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (canceled&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                || actionMasked == MotionEvent.ACTION_UP&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                || actionMasked == MotionEvent.ACTION_HOVER_MOVE) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            resetTouchState();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (split &amp;amp;&amp;amp; actionMasked == MotionEvent.ACTION_POINTER_UP) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; actionIndex = ev.getActionIndex();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; idBitsToRemove = &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; ev.getPointerId(actionIndex);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            removePointersFromTouchTargets(idBitsToRemove);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; handled;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;resetTouchState&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    clearTouchTargets();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    resetCancelNextUpFlag(&lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    mGroupFlags &amp;amp;= ~FLAG_DISALLOW_INTERCEPT;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;clearTouchTargets&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    TouchTarget target = mFirstTouchTarget;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (target != &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;do&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            TouchTarget next = target.next;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            target.recycle();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            target = next;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;while&lt;/span&gt; (target != &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        mFirstTouchTarget = &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; TouchTarget &lt;span class=&#34;title&#34;&gt;addTouchTarget&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(View child, &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; pointerIdBits)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    TouchTarget target = TouchTarget.obtain(child, pointerIdBits);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    target.next = mFirstTouchTarget;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    mFirstTouchTarget = target;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; target;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;dispatchTransformedTouchEvent&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(MotionEvent event, &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; cancel,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;                                              View child, &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; desiredPointerIdBits)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; handled;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// æ³¨æ„ä¼ å‚childä¸ºnullæ—¶ï¼Œè°ƒç”¨çš„æ˜¯è‡ªå·±çš„dispatchTouchEvent&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (child == &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        handled = &lt;span class=&#34;keyword&#34;&gt;super&lt;/span&gt;.dispatchTouchEvent(event);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        handled = child.dispatchTouchEvent(transformedEvent);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; handled;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onInterceptTouchEvent&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(MotionEvent ev)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// é»˜è®¤ä¸æ‹¦æˆªäº‹ä»¶&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;View:&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;dispatchTouchEvent&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(MotionEvent event)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (onFilterTouchEventForSecurity(event)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        	&lt;span class=&#34;comment&#34;&gt;// åˆ¤æ–­äº‹ä»¶æ˜¯å¦å…ˆäº¤ç»™ouTouchæ–¹æ³•å¤„ç†&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (mOnTouchListener != &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; (mViewFlags &amp;amp; ENABLED_MASK) == ENABLED &amp;amp;&amp;amp;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    mOnTouchListener.onTouch(&lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;, event)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;// onTouchæœªæ¶ˆè´¹äº‹ä»¶ï¼Œä¼ ç»™onTouchEvent&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (onTouchEvent(event)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;ç»¼ä¸Š&#34;&gt;ç»¼ä¸Š&lt;a title=&#34;#ç»¼ä¸Š&#34; href=&#34;#ç»¼ä¸Š&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;View äº‹ä»¶åˆ†å‘çš„æœ¬è´¨æ˜¯é€’å½’ã€‚&lt;/li&gt;
&lt;li&gt;é€’å½’çš„æœ¬è´¨æ˜¯ï¼Œä»»åŠ¡çš„ä¸‹å‘å’Œç»“æœçš„ä¸ŠæŠ¥ã€‚&lt;/li&gt;
&lt;li&gt;View äº‹ä»¶åˆ†å‘è®¾è®¡æˆé€’å½’ï¼Œæ˜¯ä¸ºäº†é…åˆ View çš„æ’ç‰ˆè§„åˆ™ï¼Œå½¢æˆç¬¦åˆç”¨æˆ·ç›´è§‰çš„è§¦æ§ä½“éªŒã€‚&lt;/li&gt;
&lt;li&gt;View äº‹ä»¶åˆ†å‘çš„å¯¹è±¡æ˜¯ä¸€ä¸ª MotionEventã€‚&lt;/li&gt;
&lt;li&gt;ä¸€æ¬¡ç”¨æˆ·è§¦æ§æ“ä½œåŒ…å«å¤šä¸ª MotionEventï¼ˆä¾‹å¦‚ä» ACTION_DOWN åˆ° ACTION_UP ï¼‰ï¼Œä¹Ÿå³ä¼šèµ°å¤šæ¬¡äº‹ä»¶åˆ†å‘æµç¨‹ã€‚&lt;/li&gt;
&lt;li&gt;ä¸€æ¬¡ View äº‹ä»¶åˆ†å‘æµç¨‹åŒ…å« â€œé€’â€ æµç¨‹å’Œ â€œå½’â€ æµç¨‹ï¼Œâ€œé€’â€ æµç¨‹å¯ä»¥å›  ViewGroup çš„æ‹¦æˆªè€Œæå‰æ­¥å…¥ â€œå½’â€ æµç¨‹ã€‚&lt;/li&gt;
&lt;li&gt;child å¯ä»¥é€šè¿‡ getParent.requestDisallowInterceptTouchEvent é˜»æ­¢çˆ¶å®¹å™¨çš„æ‹¦æˆªã€‚å› è€Œéœ€è¦å·®å¼‚åŒ–åœ°é…ç½®é˜ˆå€¼ï¼Œæ¥ç¡®ä¿ child æ‰§è¡Œ getParent.requestDisallowInterceptTouchEvent ä¼˜å…ˆäºçˆ¶å®¹å™¨ onInterceptTouchEvent è¿”å› trueï¼ˆä¸ç„¶éƒ½å…ˆè¢«æ‹¦æˆªäº†ï¼Œchild å“ªæœ‰æœºä¼šé˜»æ­¢ï¼Ÿï¼‰&lt;/li&gt;
&lt;li&gt;åœ¨â€œå½’â€æµç¨‹ä¸­ï¼Œå”¯æœ‰å½“å‰å±‚çº§çš„ super.dispatchTouchEvent è¿”å›äº† trueï¼Œæ‰è®¤å®šè¢«æ¶ˆè´¹ï¼Œè¢«æ¶ˆè´¹å‰ï¼Œä¸‹çº§éƒ½æœ‰å¹²æ´»ï¼Œåªæ˜¯ç»“æœä¸ OKã€‚è¢«æ¶ˆè´¹åï¼Œä¸Šçº§éƒ½ä¸éœ€è¦å¹²æ´»ï¼Œç›´æ¥å‘ä¸Šä¼ è¾¾æ¶ˆè´¹è€…çš„åŠŸã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;äº‹ä»¶å†²çªè§£å†³&#34;&gt;äº‹ä»¶å†²çªè§£å†³&lt;a title=&#34;#äº‹ä»¶å†²çªè§£å†³&#34; href=&#34;#äº‹ä»¶å†²çªè§£å†³&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ä»çˆ¶Viewç€æ‰‹, é‡å†™onInterceptTouchEventæ–¹æ³•ï¼Œåœ¨çˆ¶Viewéœ€è¦æ‹¦æˆªçš„æ—¶å€™æ‹¦æˆªï¼Œä¸è¦çš„æ—¶å€™è¿”å›false&lt;/li&gt;
&lt;li&gt;ä»å­Viewç€æ‰‹, é‡å†™å­ Viewçš„dispatchTouchEventæ–¹æ³•ï¼Œåœ¨Action_down åŠ¨ä½œä¸­é€šè¿‡æ–¹æ³• requestDisallowInterceptTouchEventï¼ˆtrueï¼‰ å…ˆè¯·æ±‚ çˆ¶ Viewä¸è¦æ‹¦æˆªäº‹ä»¶ï¼Œè¿™æ ·ä¿è¯å­ View èƒ½å¤Ÿæ¥å—åˆ° Action_move äº‹ä»¶ï¼Œå†åœ¨ Action_move åŠ¨ä½œä¸­æ ¹æ®è‡ªå·±çš„é€»è¾‘æ˜¯å¦è¦æ‹¦æˆªäº‹ä»¶ï¼Œä¸éœ€è¦æ‹¦æˆªäº‹ä»¶çš„è¯å†äº¤ç»™ çˆ¶ View å¤„ç†&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;refer&#34;&gt;Refer&lt;a title=&#34;#refer&#34; href=&#34;#refer&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://juejin.cn/post/6844903894103883789&#34; target=&#34;_blank&#34;&gt;å­¦ä¹  View äº‹ä»¶åˆ†å‘ï¼Œå°±åƒå¤–åœ°äººä¸Šäº†é»‘è½¦ï¼ - æ˜é‡‘ (juejin.cn)&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://juejin.cn/post/6965649194744807461&#34; target=&#34;_blank&#34;&gt;View äº‹ä»¶åˆ†å‘æœºåˆ¶ï¼Œçœ‹è¿™ä¸€ç¯‡å°±å¤Ÿäº† - æ˜é‡‘ (juejin.cn)&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://blog.csdn.net/u010289802/article/details/86169939&#34; target=&#34;_blank&#34;&gt;Android æ‰‹æŠŠæ‰‹è¿›é˜¶è‡ªå®šä¹‰Viewï¼ˆåï¼‰- äº‹ä»¶åˆ†å‘æœºåˆ¶è§£æ_lerendançš„åšå®¢-CSDNåšå®¢&lt;/a&gt;&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://onion99.github.io/2021/11/04/p4CRfuQemJ4TOlAs/</guid>
            <title>è‡ªå®šä¹‰View(8) - draw ç»˜åˆ¶è¿‡ç¨‹</title>
            <link>https://onion99.github.io/2021/11/04/p4CRfuQemJ4TOlAs/</link>
            <category>å›¾å½¢ç»˜åˆ¶</category>
            <pubDate>Thu, 04 Nov 2021 06:03:38 +0800</pubDate>
            <description><![CDATA[ &lt;blockquote&gt;
&lt;p&gt;Android é‡Œé¢çš„ç»˜åˆ¶éƒ½æ˜¯æŒ‰é¡ºåºçš„ï¼Œå…ˆç»˜åˆ¶çš„å†…å®¹ä¼šè¢«åç»˜åˆ¶çš„ç›–ä½&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/03/IES7KP.png&#34; alt=&#34;IES7KP.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;h3 id=&#34;draw-è¿‡ç¨‹è§£æ&#34;&gt;draw è¿‡ç¨‹è§£æ&lt;a title=&#34;#draw-è¿‡ç¨‹è§£æ&#34; href=&#34;#draw-è¿‡ç¨‹è§£æ&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;ä¸€ä¸ªå®Œæ•´çš„ç»˜åˆ¶è¿‡ç¨‹ä¼šä¾æ¬¡ç»˜åˆ¶ä»¥ä¸‹å‡ ä¸ªå†…å®¹ï¼š&lt;br&gt;
&lt;img src=&#34;https://z3.ax1x.com/2021/11/03/IEp3Ie.png&#34; alt=&#34;IEp3Ie.png&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;drawBackground()&lt;/code&gt;ç»˜åˆ¶èƒŒæ™¯
&lt;ul&gt;
&lt;li&gt;è¿™ä¸ªæ–¹æ³•æ˜¯ private çš„ï¼Œä¸èƒ½é‡å†™ï¼Œä½ å¦‚æœè¦è®¾ç½®èƒŒæ™¯ï¼Œåªèƒ½ç”¨è‡ªå¸¦çš„ API å»è®¾ç½®&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;onDraw()&lt;/code&gt;ç»˜åˆ¶ä¸»ä½“
&lt;ul&gt;
&lt;li&gt;è¿™ä¸ªæ–¹æ³•åœ¨ View å’Œ ViewGroup é‡Œéƒ½æ˜¯ç©ºå®ç°ï¼Œå› æ­¤è‡ªå®šä¹‰æ—¶éœ€è¦å¤å†™&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;dispatchDraw()&lt;/code&gt;ç»˜åˆ¶å­ View
&lt;ul&gt;
&lt;li&gt;åœ¨äºå•ä¸€ View ä¸­æ— å­ Viewï¼Œæ•…åœ¨ View ä¸­æ­¤æ–¹æ³•é»˜è®¤ä¸ºç©ºå®&lt;/li&gt;
&lt;li&gt;åœ¨ ViewGroupä¸­ç³»ç»Ÿå·²ç»å¤å†™å¥½æ­¤æ–¹æ³•å¯¹å…¶å­è§†å›¾è¿›è¡Œç»˜åˆ¶å› æ­¤æˆ‘ä»¬ä¸éœ€è¦å¤å†™&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;onDrawForeground()&lt;/code&gt;æ»‘åŠ¨è¾¹ç¼˜æ¸å˜å’Œæ»‘åŠ¨æ¡ä»¥åŠå‰æ™¯&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ViewGroupä¸­çš„&lt;code&gt;dispatchDraw()&lt;/code&gt;:&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;dispatchDraw&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(Canvas canvas)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; usingRenderNodeProperties = canvas.isRecordingFor(mRenderNode);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; childrenCount = mChildrenCount;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; View[] children = mChildren;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; flags = mGroupFlags;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// åŠ¨ç”»å¤„ç†&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; ((flags &amp;amp; FLAG_RUN_ANIMATION) != &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt; &amp;amp;&amp;amp; canAnimate()) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; buildCache = !isHardwareAccelerated();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;; i &amp;lt; childrenCount; i++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; View child = children[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; ((child.mViewFlags &amp;amp; VISIBILITY_MASK) == VISIBLE) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; LayoutParams params = child.getLayoutParams();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                attachLayoutAnimationParameters(child, params, i, childrenCount);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                bindLayoutAnimation(child);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// xxx&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        controller.start();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// é—´è·å¤„ç†&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; clipSaveCount = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; clipToPadding = (flags &amp;amp; CLIP_TO_PADDING_MASK) == CLIP_TO_PADDING_MASK;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (clipToPadding) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        clipSaveCount = canvas.save(Canvas.CLIP_SAVE_FLAG);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        canvas.clipRect(mScrollX + mPaddingLeft, mScrollY + mPaddingTop,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                mScrollX + mRight - mLeft - mPaddingRight,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                mScrollY + mBottom - mTop - mPaddingBottom);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// éå†å­View&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;; i &amp;lt; childrenCount; i++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; ((transientChild.mViewFlags &amp;amp; VISIBILITY_MASK) == VISIBLE ||transientChild.getAnimation() != &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;comment&#34;&gt;// 2. ç»˜åˆ¶å­Viewè§†å›¾    &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                more |= drawChild(canvas, transientChild, drawingTime);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;drawé¡ºåº&#34;&gt;drawé¡ºåº&lt;a title=&#34;#drawé¡ºåº&#34; href=&#34;#drawé¡ºåº&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;h4 id=&#34;ondraw()&#34;&gt;onDraw()&lt;a title=&#34;#ondraw()&#34; href=&#34;#ondraw()&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;è‡ªå®šä¹‰ç»˜åˆ¶æœ€åŸºæœ¬çš„å½¢æ€ï¼šç»§æ‰¿ View ç±»ï¼Œåœ¨ onDraw() ä¸­å®Œå…¨è‡ªå®šä¹‰å®ƒçš„ç»˜åˆ¶&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å®šä¹‰ View æ—¶ï¼Œç»˜åˆ¶ä»£ç å†™åœ¨ super.onDraw() çš„ä¸Šé¢è¿˜æ˜¯ä¸‹é¢éƒ½æ— æ‰€è°“,ä½†åŸºäºå·²æœ‰æ§ä»¶çš„è‡ªå®šä¹‰ç»˜åˆ¶ï¼Œå°±ä¸èƒ½ä¸è€ƒè™‘ &lt;code&gt;super.onDraw()&lt;/code&gt; äº†ï¼Œä½ éœ€è¦æ ¹æ®è‡ªå·±çš„éœ€æ±‚ï¼Œåˆ¤æ–­å‡ºä½ ç»˜åˆ¶çš„å†…å®¹éœ€è¦ç›–ä½æ§ä»¶åŸæœ‰çš„å†…å®¹è¿˜æ˜¯éœ€è¦è¢«æ§ä»¶åŸæœ‰çš„å†…å®¹ç›–ä½ï¼Œä»è€Œç¡®å®šä½ çš„ç»˜åˆ¶ä»£ç æ˜¯åº”è¯¥å†™åœ¨ super.onDraw() çš„ä¸Šé¢è¿˜æ˜¯ä¸‹é¢ã€‚&lt;/p&gt;
&lt;div class=&#34;Ï†bq&#34;&gt;&lt;div class=&#34;Ï†bs&#34;&gt;&lt;table&gt;&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;ä¸Šé¢&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;ä¸‹é¢&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/03/IEFrgH.png&#34; alt=&#34;IEFrgH.png&#34; loading=&#34;lazy&#34;&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/03/IEFHrn.png&#34; alt=&#34;IEFHrn.png&#34; loading=&#34;lazy&#34;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;&lt;/div&gt;&lt;/div&gt;&lt;h4 id=&#34;dispatchdraw()&#34;&gt;dispatchDraw()&lt;a title=&#34;#dispatchdraw()&#34; href=&#34;#dispatchdraw()&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;å¦‚æœæƒ³åœ¨ä¸€ä¸ªViewGroupä¸­æŒ‰ä¸Šé¢çš„åšæ³•åœ¨ä¸‹é¢æ·»åŠ ç»˜åˆ¶å†…å®¹åˆ™æ˜¯ä¸è¡Œçš„,å› ä¸ºåœ¨ç»˜åˆ¶è¿‡ç¨‹ä¸­æ¯ä¸€ä¸ª ViewGroup ä¼šå…ˆè°ƒç”¨è‡ªå·±çš„ onDraw() æ¥ç»˜åˆ¶å®Œè‡ªå·±çš„ä¸»ä½“ä¹‹åå†å»ç»˜åˆ¶å®ƒçš„å­ View,ä¼šè¦†ç›–å…¶ä¸»ä½“&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/03/IEEpH1.png&#34; alt=&#34;IEEpH1.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;SpottedLinearLayout&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;LinearLayout&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ...&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// æŠŠ onDraw() æ¢æˆäº† dispatchDraw()&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;dispatchDraw&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(Canvas canvas)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;       &lt;span class=&#34;keyword&#34;&gt;super&lt;/span&gt;.dispatchDraw(canvas);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;       ... &lt;span class=&#34;comment&#34;&gt;// ç»˜åˆ¶æ–‘ç‚¹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;è™½ç„¶ View å’Œ ViewGroup éƒ½æœ‰ dispatchDraw() æ–¹æ³•ï¼Œä¸è¿‡ç”±äº View æ˜¯æ²¡æœ‰å­ View çš„ï¼Œæ‰€ä»¥ä¸€èˆ¬æ¥è¯´ dispatchDraw() è¿™ä¸ªæ–¹æ³•åªå¯¹ ViewGroupï¼ˆä»¥åŠå®ƒçš„å­ç±»ï¼‰æœ‰æ„ä¹‰ã€‚&lt;/p&gt;
&lt;h4 id=&#34;ondrawforeground()&#34;&gt;onDrawForeground()&lt;a title=&#34;#ondrawforeground()&#34; href=&#34;#ondrawforeground()&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;å‰æ™¯å‰åå¤„ç†&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åœ¨ super.onDrawForeground() çš„ä¸Šé¢&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;AppImageView&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;ImageView&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ...&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onDrawForeground&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(Canvas canvas)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;       ... &lt;span class=&#34;comment&#34;&gt;// ç»˜åˆ¶ã€ŒNewã€æ ‡ç­¾&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;       &lt;span class=&#34;keyword&#34;&gt;super&lt;/span&gt;.onDrawForeground(canvas);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/03/IEVgSS.png&#34; alt=&#34;IEVgSS.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;p&gt;åœ¨ super.onDrawForeground() çš„ä¸‹é¢:&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;AppImageView&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;ImageView&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ...&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onDrawForeground&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(Canvas canvas)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;       &lt;span class=&#34;keyword&#34;&gt;super&lt;/span&gt;.onDrawForeground(canvas);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;       ... &lt;span class=&#34;comment&#34;&gt;// ç»˜åˆ¶ã€ŒNewã€æ ‡ç­¾&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/03/IEZV0A.png&#34; alt=&#34;IEZV0A.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;draw()&#34;&gt;draw()&lt;a title=&#34;#draw()&#34; href=&#34;#draw()&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;h3 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;a title=&#34;#æ€»ç»“&#34; href=&#34;#æ€»ç»“&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/03/IEZ1XQ.png&#34; alt=&#34;IEZ1XQ.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://onion99.github.io/2021/11/04/ZyOr4iLxJj7nAQxR/</guid>
            <title>è‡ªå®šä¹‰View(7) - layout å¸ƒå±€è¿‡ç¨‹</title>
            <link>https://onion99.github.io/2021/11/04/ZyOr4iLxJj7nAQxR/</link>
            <category>å›¾å½¢ç»˜åˆ¶</category>
            <pubDate>Thu, 04 Nov 2021 06:02:46 +0800</pubDate>
            <description><![CDATA[ &lt;p&gt;&lt;img src=&#34;https://s2.ax1x.com/2019/12/06/QJQEcR.jpg&#34; alt=&#34;viewasds&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;h3 id=&#34;layout-ç±»å‹&#34;&gt;layout ç±»å‹&lt;a title=&#34;#layout-ç±»å‹&#34; href=&#34;#layout-ç±»å‹&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/03/IA7tv4.png&#34; alt=&#34;IA7tv4.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;view-çš„-layout-è¿‡ç¨‹&#34;&gt;View çš„ layout è¿‡ç¨‹&lt;a title=&#34;#view-çš„-layout-è¿‡ç¨‹&#34; href=&#34;#view-çš„-layout-è¿‡ç¨‹&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// æŒ‡å®šè§†å›¾åŠå…¶æ‰€æœ‰å­è§†å›¾çš„å¤§å°å’Œä½ç½® è¿™æ˜¯å¸ƒå±€æœºåˆ¶çš„ç¬¬äºŒé˜¶æ®µ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;layout&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; l, &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; t, &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; r, &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; b)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// åˆ¤æ–­æ˜¯å¦measure,æ²¡æœ‰çš„è¯å†measureä¸€é&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; ((mPrivateFlags3 &amp;amp; PFLAG3_MEASURE_NEEDED_BEFORE_LAYOUT) != &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        onMeasure(mOldWidthMeasureSpec, mOldHeightMeasureSpec);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        mPrivateFlags3 &amp;amp;= ~PFLAG3_MEASURE_NEEDED_BEFORE_LAYOUT;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// å½“å‰è§†å›¾çš„å››ä¸ªé¡¶ç‚¹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; oldL = mLeft;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; oldT = mTop;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; oldB = mBottom;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; oldR = mRight;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// åˆ¤æ–­è§†å›¾å¤§å°æˆ–è€…ä½ç½®æ˜¯å¦å‘ç”Ÿæ”¹å˜&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; changed = isLayoutModeOptical(mParent) ?&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            setOpticalFrame(l, t, r, b) : setFrame(l, t, r, b);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// å‘ç”Ÿæ”¹å˜        &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (changed || (mPrivateFlags &amp;amp; PFLAG_LAYOUT_REQUIRED) == PFLAG_LAYOUT_REQUIRED) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        onLayout(changed, l, t, r, b);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// å¯¹äºå•ä¸€Viewçš„laytouè¿‡ç¨‹ï¼šç”±äºå•ä¸€Viewæ˜¯æ²¡æœ‰å­Viewçš„ï¼Œæ•…onLayoutï¼ˆï¼‰æ˜¯ä¸€ä¸ªç©ºå®ç°-&amp;gt;&amp;gt;åˆ†æ3&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// å¯¹äºViewGroupçš„laytouè¿‡ç¨‹ï¼šç”±äºç¡®å®šä½ç½®ä¸å…·ä½“å¸ƒå±€æœ‰å…³ï¼Œæ‰€ä»¥onLayoutï¼ˆï¼‰åœ¨ViewGroupä¸º1ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œéœ€é‡å†™å®ç°&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        ...&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ...&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/03/IAqjZd.png&#34; alt=&#34;IAqjZd.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;viewgroup-çš„-layout-è¿‡ç¨‹&#34;&gt;ViewGroup çš„ layout è¿‡ç¨‹&lt;a title=&#34;#viewgroup-çš„-layout-è¿‡ç¨‹&#34; href=&#34;#viewgroup-çš„-layout-è¿‡ç¨‹&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;ViewGroup çš„ layout è¿‡ç¨‹ç¡®å®šä½ç½®ä¸å…·ä½“çš„å¸ƒå±€æœ‰å…³ï¼Œæ‰€ä»¥åœ¨ ViewGroup ä¸­æ˜¯ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œéœ€è¦é‡å†™å®ç°&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¤å†™&lt;code&gt; onLayout()&lt;/code&gt;æ­¥éª¤:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;éå†æ‰€æœ‰å­ View&lt;/li&gt;
&lt;li&gt;æ ¹æ®è‡ªèº«éœ€æ±‚è®¡ç®—å½“å‰å­ View çš„å››ä¸ªä½ç½®å€¼ï¼ˆéœ€è‡ªèº«å®ç°ï¼‰&lt;/li&gt;
&lt;li&gt;æ ¹æ®ä¸Šè¿° 4 ä¸ªä½ç½®çš„è®¡ç®—å€¼ï¼Œè®¾ç½®å­ View çš„ 4 ä¸ªé¡¶ç‚¹ï¼šè°ƒç”¨å­ View çš„ layout æ–¹æ³•ï¼Œå³ç¡®å®šäº†å­ View åœ¨çˆ¶å®¹å™¨é‡Œçš„ä½ç½®&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// ViewGroupçš„onLayoutå®ç°çš„å¤§è‡´æ€è·¯&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onLayout&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; changed, &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; left, &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; top, &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; right, &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; bottom)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   &lt;span class=&#34;comment&#34;&gt;// å‚æ•°è¯´æ˜&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   &lt;span class=&#34;comment&#34;&gt;// changed å½“å‰Viewçš„å¤§å°å’Œä½ç½®æ”¹å˜äº† &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   &lt;span class=&#34;comment&#34;&gt;// left å·¦éƒ¨ä½ç½®  top é¡¶éƒ¨ä½ç½®  right å³éƒ¨ä½ç½®  bottom åº•éƒ¨ä½ç½®&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   &lt;span class=&#34;comment&#34;&gt;// 1. éå†å­Viewï¼šå¾ªç¯æ‰€æœ‰å­View&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; i=&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;; i&amp;lt;getChildCount(); i++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;         View child = getChildAt(i);   &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;         &lt;span class=&#34;comment&#34;&gt;// 2. è®¡ç®—å½“å‰å­Viewçš„å››ä¸ªä½ç½®å€¼&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;         &lt;span class=&#34;comment&#34;&gt;// 2.1 ä½ç½®çš„è®¡ç®—é€»è¾‘éœ€è‡ªå·±å®ç°ï¼Œä¹Ÿæ˜¯è‡ªå®šä¹‰Viewçš„å…³é”®&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;         calculate();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;         &lt;span class=&#34;comment&#34;&gt;// 2.2 å¯¹è®¡ç®—åçš„ä½ç½®å€¼è¿›è¡Œèµ‹å€¼&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;         &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; mLeft  = Left&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;         &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; mTop  = Top&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;         &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; mRight = Right&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;         &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; mBottom = Bottom&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;       &lt;span class=&#34;comment&#34;&gt;// 3. æ ¹æ®ä¸Šè¿°4ä¸ªä½ç½®çš„è®¡ç®—å€¼è®¾ç½®å­Viewçš„4ä¸ªé¡¶ç‚¹ï¼šè°ƒç”¨å­viewçš„layout() &amp;amp; ä¼ é€’è®¡ç®—è¿‡çš„å‚æ•°&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;       &lt;span class=&#34;comment&#34;&gt;// å³ç¡®å®šäº†å­Viewåœ¨çˆ¶å®¹å™¨çš„ä½ç½®&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;       child.layout(mLeft, mTop, mRight, mBottom);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;       &lt;span class=&#34;comment&#34;&gt;// è¯¥è¿‡ç¨‹ç±»ä¼¼äºå•ä¸€Viewçš„layoutè¿‡ç¨‹ä¸­çš„layout()å’ŒonLayout()&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/03/IAL1L4.png&#34; alt=&#34;IAL1L4.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;viewgroup-å­ç±»ï¼ˆlinearlayoutï¼‰çš„-layout-è¿‡ç¨‹åˆ†æ&#34;&gt;ViewGroup å­ç±»ï¼ˆLinearLayoutï¼‰çš„ layout è¿‡ç¨‹åˆ†æ&lt;a title=&#34;#viewgroup-å­ç±»ï¼ˆlinearlayoutï¼‰çš„-layout-è¿‡ç¨‹åˆ†æ&#34; href=&#34;#viewgroup-å­ç±»ï¼ˆlinearlayoutï¼‰çš„-layout-è¿‡ç¨‹åˆ†æ&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onLayout&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; changed, &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; l, &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; t, &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; r, &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; b)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// æ ¹æ®è‡ªèº«æ–¹å‘å±æ€§ï¼Œè€Œé€‰æ‹©ä¸åŒçš„å¤„ç†æ–¹å¼&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (mOrientation == VERTICAL) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        layoutVertical(l, t, r, b);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        layoutHorizontal(l, t, r, b);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æ ¹æ® LinearLayout çš„æ–¹å‘ï¼ˆverticalã€horizontalï¼‰è¿›å…¥ä¸åŒçš„å¸ƒå±€è¿‡ç¨‹ï¼Œè¿™é‡Œæˆ‘ä»¬åªé€‰å‚ç›´æ–¹å‘çš„å¸ƒå±€è¿‡ç¨‹ï¼Œå³layoutVertical()&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;layoutVertical&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; left, &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; top, &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; right, &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; bottom)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// å­Viewçš„æ•°é‡&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; count = getVirtualChildCount();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// 1. éå†å­View&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;; i &amp;lt; count; i++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; View child = getVirtualChildAt(i);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (child == &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            childTop += measureNullChild(i);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (child.getVisibility() != GONE) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;// 2. è®¡ç®—å­Viewçš„æµ‹é‡å®½ / é«˜å€¼&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; childWidth = child.getMeasuredWidth();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; childHeight = child.getMeasuredHeight();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;// 3. ç¡®å®šè‡ªèº«å­Viewçš„ä½ç½®&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;// å³ï¼šé€’å½’è°ƒç”¨å­Viewçš„setChildFrame()ï¼Œå®é™…ä¸Šæ˜¯è°ƒç”¨äº†å­Viewçš„layout() -&amp;gt;&amp;gt;åˆ†æ2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            setChildFrame(child, childLeft, childTop + getLocationOffset(child), childWidth, childHeight);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;// childTopé€æ¸å¢å¤§ï¼Œå³åé¢çš„å­å…ƒç´ ä¼šè¢«æ”¾ç½®åœ¨é ä¸‹çš„ä½ç½®&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;// è¿™ç¬¦åˆå‚ç›´æ–¹å‘çš„LinearLayoutçš„ç‰¹æ€§&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            childTop += childHeight + lp.bottomMargin + getNextLocationOffset(child);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            i += getChildrenSkipCount(child, i);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;setChildFrame&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;( View child, &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; left, &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; top, &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; width, &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; height)&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// setChildFrameï¼ˆï¼‰ä»…ä»…åªæ˜¯è°ƒç”¨äº†å­Viewçš„layoutï¼ˆï¼‰è€Œå·²&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    child.layout(left, top, left ++ width, top + height);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// åœ¨å­Viewçš„layoutï¼ˆï¼‰åˆé€šè¿‡è°ƒç”¨setFrameï¼ˆï¼‰ç¡®å®šViewçš„å››ä¸ªé¡¶ç‚¹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// å³ç¡®å®šäº†å­Viewçš„ä½ç½®&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// å¦‚æ­¤ä¸æ–­å¾ªç¯ç¡®å®šæ‰€æœ‰å­Viewçš„ä½ç½®ï¼Œæœ€ç»ˆç¡®å®šViewGroupçš„ä½ç½®&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;getmeasurewidth-å’Œ-getwidth-åŒºåˆ«&#34;&gt;getMeasureWidth å’Œ getWidth åŒºåˆ«&lt;a title=&#34;#getmeasurewidth-å’Œ-getwidth-åŒºåˆ«&#34; href=&#34;#getmeasurewidth-å’Œ-getwidth-åŒºåˆ«&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;æŸäº›æƒ…å†µä¸‹ï¼ŒView éœ€è¦å¤šæ¬¡ measure æ‰èƒ½ç¡®å®šè‡ªå·±çš„æµ‹é‡å®½é«˜ï¼Œåœ¨å‰å‡ æ¬¡çš„æµ‹é‡è¿‡ç¨‹ä¸­ï¼Œå…¶å¾—å‡ºçš„æµ‹é‡å®½é«˜æœ‰å¯èƒ½å’Œæœ€ç»ˆå®½é«˜ä¸ä¸€è‡´.ï¼Œä½†æœ€ç»ˆæ¥è¯´ï¼Œæµ‹é‡å®½é«˜è¿˜æ˜¯å’Œæœ€ç»ˆå®½é«˜ç›¸åŒã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/03/IAjrmF.png&#34; alt=&#34;IAjrmF.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://onion99.github.io/2021/11/04/Qj9f1VMJJowv5Lfb/</guid>
            <title>è‡ªå®šä¹‰View(6) - measure æµ‹é‡è¿‡ç¨‹</title>
            <link>https://onion99.github.io/2021/11/04/Qj9f1VMJJowv5Lfb/</link>
            <category>å›¾å½¢ç»˜åˆ¶</category>
            <pubDate>Thu, 04 Nov 2021 06:00:58 +0800</pubDate>
            <description><![CDATA[ &lt;p&gt;&lt;img src=&#34;https://s2.ax1x.com/2019/12/06/QJQEcR.jpg&#34; alt=&#34;QJQEcR.jpg&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;h3 id=&#34;measurespec&#34;&gt;MeasureSpec&lt;a title=&#34;#measurespec&#34; href=&#34;#measurespec&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;MeasureSpec ä»£è¡¨æµ‹é‡è§„æ ¼ï¼Œæ˜¯ä¸€ä¸ª 32 ä½çš„ int å€¼ï¼Œé«˜ 2 ä½ä»£è¡¨ SpecModeï¼ˆæµ‹é‡æ¨¡å¼ï¼‰ï¼Œä½ 30 ä½ä»£è¡¨ SpecSizeï¼ˆæµ‹é‡å¤§å°ï¼‰&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/02/IF7OM9.png&#34; alt=&#34;IF7OM9.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;p&gt;MeasureSpec é€šè¿‡å°† SpecMode å’Œ SpecSize æ‰“åŒ…æˆä¸€ä¸ª int å€¼æ¥é¿å…è¿‡å¤šçš„å†…å­˜åˆ†é…ï¼Œå¹¶æä¾›äº†æ‰“åŒ…å’Œè§£åŒ…çš„æ–¹æ³•&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onMeasure&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; widthMeasureSpec, &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; heightMeasureSpec)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; widthMode = MeasureSpec.getMode(widthMeasureSpec);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; widthSize = MeasureSpec.getSize(widthMeasureSpec);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; heightMode = MeasureSpec.getMode(heightMeasureSpec);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; heightSize = MeasureSpec.getSize(heightMeasureSpec);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ...&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;specmode&#34;&gt;SpecMode&lt;a title=&#34;#specmode&#34; href=&#34;#specmode&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/02/IFbTc4.png&#34; alt=&#34;IFbTc4.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;measurespecå€¼è®¡ç®—&#34;&gt;MeasureSpecå€¼è®¡ç®—&lt;a title=&#34;#measurespecå€¼è®¡ç®—&#34; href=&#34;#measurespecå€¼è®¡ç®—&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;View çš„ MeasureSpec å€¼æ˜¯ç”± View çš„å¸ƒå±€å‚æ•°å’Œçˆ¶å®¹å™¨ çš„ MeasureSpec å€¼è®¡ç®—&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/03/IAVp1e.png&#34; alt=&#34;IAVp1e.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;81&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;/**&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; * æºç åˆ†æï¼šgetChildMeasureSpecï¼ˆï¼‰&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; * ä½œç”¨ï¼šæ ¹æ®çˆ¶è§†å›¾çš„MeasureSpec &amp;amp; å¸ƒå±€å‚æ•°LayoutParamsï¼Œè®¡ç®—å•ä¸ªå­Viewçš„MeasureSpec&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; * æ³¨ï¼šå­viewçš„å¤§å°ç”±çˆ¶viewçš„MeasureSpecå€¼ å’Œ å­viewçš„LayoutParamså±æ€§ å…±åŒå†³å®š&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; * å‚æ•°è¯´æ˜&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; * &lt;span class=&#34;doctag&#34;&gt;@param&lt;/span&gt; spec           çˆ¶viewçš„è¯¦ç»†æµ‹é‡å€¼ (MeasureSpec)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; * &lt;span class=&#34;doctag&#34;&gt;@param&lt;/span&gt; padding        viewå½“å‰å°ºå¯¸çš„çš„å†…è¾¹è·å’Œå¤–è¾¹è·(padding, margin)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; * &lt;span class=&#34;doctag&#34;&gt;@param&lt;/span&gt; childDimension å­è§†å›¾çš„å¸ƒå±€å‚æ•°ï¼ˆå®½ / é«˜ï¼‰&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; **/&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;getChildMeasureSpec&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; spec, &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; padding, &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; childDimension)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//çˆ¶viewçš„æµ‹é‡æ¨¡å¼&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; specMode = MeasureSpec.getMode(spec);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//çˆ¶viewçš„å¤§å°&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; specSize = MeasureSpec.getSize(spec);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//é€šè¿‡çˆ¶viewè®¡ç®—å‡ºçš„å­viewå¤§å° = çˆ¶å¤§å°-è¾¹è·ï¼ˆçˆ¶è¦æ±‚çš„å¤§å°ï¼Œä½†å­viewä¸ä¸€å®šç”¨è¿™ä¸ªå€¼ï¼‰   &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; size = Math.max(&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, specSize - padding);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//å­viewæƒ³è¦çš„å®é™…å¤§å°å’Œæ¨¡å¼ï¼ˆéœ€è¦è®¡ç®—ï¼‰  &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; resultSize = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; resultMode = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//é€šè¿‡çˆ¶viewçš„MeasureSpecå’Œå­viewçš„LayoutParamsç¡®å®šå­viewçš„å¤§å°  &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;switch&lt;/span&gt; (specMode) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//å½“çˆ¶viewçš„æ¨¡å¼ä¸ºEXACITYæ—¶ï¼Œçˆ¶viewå¼ºåŠ ç»™å­viewç¡®åˆ‡çš„å€¼&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//ä¸€èˆ¬æ˜¯çˆ¶viewè®¾ç½®ä¸ºmatch_parentæˆ–è€…å›ºå®šå€¼çš„ViewGroup &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;case&lt;/span&gt; MeasureSpec.EXACTLY:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;// å½“å­viewçš„LayoutParams&amp;gt;0ï¼Œå³æœ‰ç¡®åˆ‡çš„å€¼  &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (childDimension &amp;gt;= &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;comment&#34;&gt;//å­viewå¤§å°ä¸ºå­è‡ªèº«æ‰€èµ‹çš„å€¼ï¼Œæ¨¡å¼å¤§å°ä¸ºEXACTLY  &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                resultSize = childDimension;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                resultMode = MeasureSpec.EXACTLY;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;comment&#34;&gt;//å½“å­viewçš„LayoutParamsä¸ºMATCH_PARENTæ—¶(-1)  &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (childDimension == LayoutParams.MATCH_PARENT) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;comment&#34;&gt;//å­viewå¤§å°ä¸ºçˆ¶viewå¤§å°ï¼Œæ¨¡å¼ä¸ºEXACTLY  &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                resultSize = size;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                resultMode = MeasureSpec.EXACTLY;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;comment&#34;&gt;// å½“å­viewçš„LayoutParamsä¸ºWRAP_CONTENTæ—¶(-2)      &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (childDimension == LayoutParams.WRAP_CONTENT) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;comment&#34;&gt;//å­viewå†³å®šè‡ªå·±çš„å¤§å°ï¼Œä½†æœ€å¤§ä¸èƒ½è¶…è¿‡çˆ¶viewï¼Œæ¨¡å¼ä¸ºAT_MOST  &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                resultSize = size;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                resultMode = MeasureSpec.AT_MOST;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// å½“çˆ¶viewçš„æ¨¡å¼ä¸ºAT_MOSTæ—¶ï¼Œçˆ¶viewå¼ºåŠ ç»™å­viewä¸€ä¸ªæœ€å¤§çš„å€¼ã€‚ï¼ˆä¸€èˆ¬æ˜¯çˆ¶viewè®¾ç½®ä¸ºwrap_contentï¼‰  &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;case&lt;/span&gt; MeasureSpec.AT_MOST:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;// é“ç†åŒä¸Š  &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (childDimension &amp;gt;= &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                resultSize = childDimension;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                resultMode = MeasureSpec.EXACTLY;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (childDimension == LayoutParams.MATCH_PARENT) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                resultSize = size;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                resultMode = MeasureSpec.AT_MOST;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (childDimension == LayoutParams.WRAP_CONTENT) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                resultSize = size;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                resultMode = MeasureSpec.AT_MOST;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// å½“çˆ¶viewçš„æ¨¡å¼ä¸ºUNSPECIFIEDæ—¶ï¼Œçˆ¶å®¹å™¨ä¸å¯¹viewæœ‰ä»»ä½•é™åˆ¶ï¼Œè¦å¤šå¤§ç»™å¤šå¤§&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// å¤šè§äºListViewã€GridView  &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;case&lt;/span&gt; MeasureSpec.UNSPECIFIED:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (childDimension &amp;gt;= &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;comment&#34;&gt;// å­viewå¤§å°ä¸ºå­è‡ªèº«æ‰€èµ‹çš„å€¼  &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                resultSize = childDimension;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                resultMode = MeasureSpec.EXACTLY;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (childDimension == LayoutParams.MATCH_PARENT) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;comment&#34;&gt;// å› ä¸ºçˆ¶viewä¸ºUNSPECIFIEDï¼Œæ‰€ä»¥MATCH_PARENTçš„è¯å­ç±»å¤§å°ä¸º0  &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                resultSize = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                resultMode = MeasureSpec.UNSPECIFIED;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (childDimension == LayoutParams.WRAP_CONTENT) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;comment&#34;&gt;// å› ä¸ºçˆ¶viewä¸ºUNSPECIFIEDï¼Œæ‰€ä»¥WRAP_CONTENTçš„è¯å­ç±»å¤§å°ä¸º0  &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                resultSize = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                resultMode = MeasureSpec.UNSPECIFIED;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; MeasureSpec.makeMeasureSpec(resultSize, resultMode);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/03/IAemLj.png&#34; alt=&#34;IAemLj.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;measure-è¿‡ç¨‹&#34;&gt;Measure è¿‡ç¨‹&lt;a title=&#34;#measure-è¿‡ç¨‹&#34; href=&#34;#measure-è¿‡ç¨‹&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/03/IAuMTA.png&#34; alt=&#34;IAuMTA.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¸ƒå±€è¿‡ç¨‹è‡ªå®šä¹‰çš„æ–¹å¼&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;é‡å†™  &lt;code&gt;onMeasure()&lt;/code&gt;  æ¥ä¿®æ”¹å·²æœ‰çš„  &lt;code&gt;View&lt;/code&gt;  çš„å°ºå¯¸ï¼›&lt;/li&gt;
&lt;li&gt;é‡å†™  &lt;code&gt;onMeasure()&lt;/code&gt;  æ¥å…¨æ–°å®šåˆ¶è‡ªå®šä¹‰  &lt;code&gt;View&lt;/code&gt;  çš„å°ºå¯¸ï¼›&lt;/li&gt;
&lt;li&gt;é‡å†™  &lt;code&gt;onMeasure()&lt;/code&gt;  å’Œ  &lt;code&gt;onLayout()&lt;/code&gt;  æ¥å…¨æ–°å®šåˆ¶è‡ªå®šä¹‰  &lt;code&gt;ViewGroup&lt;/code&gt;  çš„å†…éƒ¨å¸ƒå±€ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;viewçš„measure&#34;&gt;Viewçš„measure&lt;a title=&#34;#viewçš„measure&#34; href=&#34;#viewçš„measure&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;View çš„ measure è¿‡ç¨‹ç”±å…¶&lt;code&gt;measure()&lt;/code&gt; æ–¹æ³•å®Œæˆï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;/**&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;* æºç åˆ†æï¼šmeasureï¼ˆï¼‰&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;* å®šä¹‰ï¼šMeasureè¿‡ç¨‹çš„å…¥å£ï¼›å±äºView.javaç±» &amp;amp; finalç±»å‹ï¼Œå³å­ç±»ä¸èƒ½é‡å†™æ­¤æ–¹æ³•&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;* ä½œç”¨ï¼šåŸºæœ¬æµ‹é‡é€»è¾‘çš„åˆ¤æ–­&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;**/&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;measure&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; widthMeasureSpec, &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; heightMeasureSpec)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ...&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// åˆ¤æ–­æ˜¯å¦éœ€è¦é‡æ–°æµ‹é‡           &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (forceLayout || needsLayout) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        ...&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// åˆ¤æ–­æ˜¯å¦æœ‰ç¼“å­˜&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; cacheIndex = forceLayout ? -&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt; : mMeasureCache.indexOfKey(key);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (cacheIndex &amp;lt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt; || sIgnoreMeasureCache) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;// å¼€å§‹æµ‹é‡&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            onMeasure(widthMeasureSpec, heightMeasureSpec);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            mPrivateFlags3 &amp;amp;= ~PFLAG3_MEASURE_NEEDED_BEFORE_LAYOUT;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;long&lt;/span&gt; value = mMeasureCache.valueAt(cacheIndex);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;// Casting a long to int drops the high 32 bits, no mask needed&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            setMeasuredDimensionRaw((&lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt;) (value &amp;gt;&amp;gt; &lt;span class=&#34;number&#34;&gt;32&lt;/span&gt;), (&lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt;) value);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            mPrivateFlags3 |= PFLAG3_MEASURE_NEEDED_BEFORE_LAYOUT;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        ...&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ...&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;  &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;code&gt;setMeasuredDimension()&lt;/code&gt;æ–¹æ³•ä¼šè®¾ç½® View çš„å®½/é«˜çš„æµ‹é‡å€¼ï¼Œå› æ­¤æˆ‘ä»¬åªéœ€è¦çœ‹&lt;code&gt;getDefaultSize()&lt;/code&gt; æ–¹æ³•å³å¯&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/03/IAGYZT.png&#34; alt=&#34;IAGYZT.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;/**&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; * onMeasureï¼ˆï¼‰è¦çš„åšæ˜¯äº‹æƒ…&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; * 1. æ ¹æ®Viewå®½/é«˜çš„æµ‹é‡è§„æ ¼è®¡ç®—Viewçš„å®½/é«˜å€¼ï¼šgetDefaultSize()&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; * 2. å­˜å‚¨æµ‹é‡åçš„Viewå®½ / é«˜ï¼šsetMeasuredDimension()&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; **/&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onMeasure&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; widthMeasureSpec, &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; heightMeasureSpec)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     setMeasuredDimension(getDefaultSize(getSuggestedMinimumWidth(), widthMeasureSpec),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;             getDefaultSize(getSuggestedMinimumHeight(), heightMeasureSpec));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;comment&#34;&gt;/**&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;  * &lt;span class=&#34;doctag&#34;&gt;@param&lt;/span&gt; size        æä¾›çš„é»˜è®¤å¤§å°&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;  * &lt;span class=&#34;doctag&#34;&gt;@param&lt;/span&gt; measureSpec å®½/é«˜çš„æµ‹é‡è§„æ ¼&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;  */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;getDefaultSize&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; size, &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; measureSpec)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;comment&#34;&gt;// è®¾ç½®é»˜è®¤å¤§å°&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; result = size;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;comment&#34;&gt;// è·å–å®½/é«˜æµ‹é‡è§„æ ¼çš„æ¨¡å¼ &amp;amp; æµ‹é‡å¤§å°&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; specMode = MeasureSpec.getMode(measureSpec);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; specSize = MeasureSpec.getSize(measureSpec);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;keyword&#34;&gt;switch&lt;/span&gt; (specMode) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;       &lt;span class=&#34;comment&#34;&gt;// æ¨¡å¼ä¸ºUNSPECIFIEDæ—¶ï¼Œä½¿ç”¨æä¾›çš„é»˜è®¤å¤§å° = å‚æ•°Size&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;       &lt;span class=&#34;keyword&#34;&gt;case&lt;/span&gt; MeasureSpec.UNSPECIFIED:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;         result = size;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;         &lt;span class=&#34;keyword&#34;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;       &lt;span class=&#34;comment&#34;&gt;// æ¨¡å¼ä¸ºAT_MOST,EXACTLYæ—¶ï¼Œä½¿ç”¨Viewæµ‹é‡åçš„å®½/é«˜å€¼ = measureSpecä¸­çš„Size  &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;       &lt;span class=&#34;keyword&#34;&gt;case&lt;/span&gt; MeasureSpec.AT_MOST:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;       &lt;span class=&#34;keyword&#34;&gt;case&lt;/span&gt; MeasureSpec.EXACTLY:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;         result = specSize;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;         &lt;span class=&#34;keyword&#34;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;comment&#34;&gt;// è¿”å›Viewçš„å®½/é«˜å€¼&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; result;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#125;  &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å½“æ¨¡å¼æ˜¯ UNSPECIFIED æ—¶ï¼Œä½¿ç”¨çš„æ˜¯æä¾›çš„é»˜è®¤å¤§å°:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è‹¥ View æ— è®¾ç½®èƒŒæ™¯ï¼Œé‚£ä¹ˆ View çš„å®½åº¦ = mMinWidthã€‚mMinWidthä¸º android:minWidthå±æ€§æ‰€æŒ‡å®šçš„å€¼ï¼Œé»˜è®¤ä¸º 0&lt;/li&gt;
&lt;li&gt;è‹¥ Viewè®¾ç½®äº†èƒŒæ™¯ï¼ŒView çš„å®½åº¦ä¸º mMinWidth å’Œ mBackground.getMinimumWidth()ä¸­çš„æœ€å¤§å€¼ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;getSuggestedMinimumWidth&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; (mBackground == &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;) ? mMinWidth : max(mMinWidth, mBackground.getMinimumWidth());&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;div class=&#34;Ï†bq&#34;&gt;&lt;div class=&#34;Ï†bs&#34;&gt;&lt;table&gt;&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;è¿‡ç¨‹&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;è¡Œä¸ºä½œç”¨&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/03/IAJ9mV.png&#34; alt=&#34;IAJ9mV.png&#34; loading=&#34;lazy&#34;&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/03/IAJ1te.png&#34; alt=&#34;IAJ1te.png&#34; loading=&#34;lazy&#34;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;&lt;/div&gt;&lt;/div&gt;&lt;h4 id=&#34;viewgroupçš„measure&#34;&gt;ViewGroupçš„measure&lt;a title=&#34;#viewgroupçš„measure&#34; href=&#34;#viewgroupçš„measure&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;ViewGroupæ˜¯ä¸ªæŠ½è±¡ç±»,ä¸åŒViewGroupçš„onMeasureçš„å®ç°éƒ½ä¸ªä¸ç›¸åŒ,é™¤äº†å®Œæˆè‡ªå·±çš„ measure è¿‡ç¨‹ä»¥å¤–ï¼Œè¿˜ä¼šéå†å»è°ƒç”¨æ‰€æœ‰å­å…ƒç´ çš„ measure æ–¹æ³•ï¼Œå„ä¸ªå­å…ƒç´ å†é€’å½’å»æ‰§è¡Œè¿™ä¸ªè¿‡ç¨‹&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol&gt;
&lt;li&gt;éå†æ‰€æœ‰å­ View &amp;amp; æµ‹é‡ï¼šmeasureChildren()&lt;/li&gt;
&lt;li&gt;åˆå¹¶æ‰€æœ‰å­ View çš„å°ºå¯¸å¤§å°ï¼Œæœ€ç»ˆå¾—åˆ° ViewGroup çš„æµ‹é‡å€¼ï¼ˆéœ€è‡ªèº«å®ç°ï¼‰&lt;/li&gt;
&lt;li&gt;å­˜å‚¨æµ‹é‡å View å®½/é«˜çš„å€¼ï¼šè°ƒç”¨ setMeasuredDimension()&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onMeasure&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; widthMeasureSpec, &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; heightMeasureSpec)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;comment&#34;&gt;// å®šä¹‰å­˜æ”¾æµ‹é‡åçš„Viewå®½/é«˜çš„å˜é‡&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; widthMeasure ;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; heightMeasure ;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;comment&#34;&gt;// 1. éå†æ‰€æœ‰å­ View &amp;amp; æµ‹é‡(measureChildren())&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      measureChildren(widthMeasureSpec, heightMeasureSpec)ï¼›&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;comment&#34;&gt;// 2. åˆå¹¶æ‰€æœ‰å­Viewçš„å°ºå¯¸å¤§å°ï¼Œæœ€ç»ˆå¾—åˆ°ViewGroupçˆ¶è§†å›¾çš„æµ‹é‡å€¼&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;comment&#34;&gt;// éœ€è‡ªèº«å®ç°&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      measureMerge();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;comment&#34;&gt;// 3. å­˜å‚¨æµ‹é‡åViewå®½/é«˜çš„å€¼ï¼šè°ƒç”¨setMeasuredDimension()&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;comment&#34;&gt;// ç±»ä¼¼å•ä¸€Viewçš„è¿‡ç¨‹ï¼Œæ­¤å¤„ä¸ä½œè¿‡å¤šæè¿°&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      setMeasuredDimension(widthMeasure,  heightMeasure);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;code&gt;measureChildren()&lt;/code&gt;éå†å­ View å¹¶ä¸”è°ƒç”¨ measureChild() è¿›è¡Œä¸‹ä¸€æ­¥æµ‹é‡&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;measureChildren&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; widthMeasureSpec, &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; heightMeasureSpec)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// è¦æ±‚è¯¥è§†å›¾çš„æ‰€æœ‰å­è§†å›¾åº¦é‡è‡ªå·±ï¼ŒåŒæ—¶è€ƒè™‘è¯¥è§†å›¾çš„MeasureSpecè¦æ±‚åŠå…¶å¡«å……ã€‚æˆ‘ä»¬è·³è¿‡äº†å¤„äºGONEçŠ¶æ€çš„å­èŠ‚ç‚¹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; size = mChildrenCount;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; View[] children = mChildren;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;; i &amp;lt; size; ++i) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; View child = children[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; ((child.mViewFlags &amp;amp; VISIBILITY_MASK) != GONE) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            measureChild(child, widthMeasureSpec, heightMeasureSpec);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;div class=&#34;Ï†bq&#34;&gt;&lt;div class=&#34;Ï†bs&#34;&gt;&lt;table&gt;&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;è¿‡ç¨‹&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;è¡Œä¸ºä½œç”¨&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/03/IAokqI.png&#34; alt=&#34;IAokqI.png&#34; loading=&#34;lazy&#34;&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/03/IAo1Ln.png&#34; alt=&#34;IAo1Ln.png&#34; loading=&#34;lazy&#34;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;&lt;/div&gt;&lt;/div&gt;&lt;h5 id=&#34;linearlayout-measureåˆ†æ&#34;&gt;LinearLayout measureåˆ†æ&lt;a title=&#34;#linearlayout-measureåˆ†æ&#34; href=&#34;#linearlayout-measureåˆ†æ&#34;&gt;&lt;/a&gt;&lt;/h5&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;63&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onMeasure&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; widthMeasureSpec, &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; heightMeasureSpec)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// æ ¹æ®ä¸åŒçš„å¸ƒå±€å±æ€§è¿›è¡Œä¸åŒçš„è®¡ç®—&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (mOrientation == VERTICAL) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        measureVertical(widthMeasureSpec, heightMeasureSpec);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        measureHorizontal(widthMeasureSpec, heightMeasureSpec);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;measureVertical&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; widthMeasureSpec, &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; heightMeasureSpec)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// è·å–å‚ç›´æ–¹å‘ä¸Šçš„å­Viewä¸ªæ•°&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; count = getVirtualChildCount();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// éå†å­Viewè·å–å…¶é«˜åº¦ï¼Œå¹¶è®°å½•ä¸‹å­Viewä¸­æœ€é«˜çš„é«˜åº¦æ•°å€¼&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;; i &amp;lt; count; ++i) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; View child = getVirtualChildAt(i);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// å­Viewä¸å¯è§ï¼Œç›´æ¥è·³è¿‡è¯¥Viewçš„measureè¿‡ç¨‹ï¼ŒgetChildrenSkipCount()è¿”å›å€¼æ’ä¸º0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// æ³¨ï¼šè‹¥viewçš„å¯è§å±æ€§è®¾ç½®ä¸ºVIEW.INVISIBLEï¼Œè¿˜æ˜¯ä¼šè®¡ç®—è¯¥viewå¤§å°&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (child.getVisibility() == View.GONE) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;           i += getChildrenSkipCount(child, i);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;           &lt;span class=&#34;keyword&#34;&gt;continue&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// è®°å½•å­Viewæ˜¯å¦æœ‰weightå±æ€§è®¾ç½®ï¼Œç”¨äºåé¢åˆ¤æ–­æ˜¯å¦éœ€è¦äºŒæ¬¡measure&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        totalWeight += lp.weight;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (heightMode == MeasureSpec.EXACTLY &amp;amp;&amp;amp; lp.height == &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt; &amp;amp;&amp;amp; lp.weight &amp;gt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;// å¦‚æœLinearLayoutçš„specModeä¸ºEXACTLYä¸”å­Viewè®¾ç½®äº†weightå±æ€§ï¼Œåœ¨è¿™é‡Œä¼šè·³è¿‡å­Viewçš„measureè¿‡ç¨‹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;// åŒæ—¶æ ‡è®°skippedMeasureå±æ€§ä¸ºtrueï¼Œåé¢ä¼šæ ¹æ®è¯¥å±æ€§å†³å®šæ˜¯å¦è¿›è¡Œç¬¬äºŒæ¬¡measure&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;// è‹¥LinearLayoutçš„å­Viewè®¾ç½®äº†weightï¼Œä¼šè¿›è¡Œä¸¤æ¬¡measureè®¡ç®—ï¼Œæ¯”è¾ƒè€—æ—¶&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;// è¿™å°±æ˜¯ä¸ºä»€ä¹ˆLinearLayoutçš„å­Viewéœ€è¦ä½¿ç”¨weightå±æ€§æ—¶å€™ï¼Œæœ€å¥½æ›¿æ¢æˆRelativeLayoutå¸ƒå±€&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; totalLength = mTotalLength;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            mTotalLength = Math.max(totalLength, totalLength + lp.topMargin + lp.bottomMargin);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            skippedMeasure = &lt;span class=&#34;keyword&#34;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; oldHeight = Integer.MIN_VALUE;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;// æ­¥éª¤1ï¼šéå†æ‰€æœ‰å­View &amp;amp; æµ‹é‡ï¼šmeasureChildrenï¼ˆï¼‰&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;// æ³¨ï¼šè¯¥æ–¹æ³•å†…éƒ¨ï¼Œæœ€ç»ˆä¼šè°ƒç”¨measureChildrenï¼ˆï¼‰ï¼Œä»è€Œ éå†æ‰€æœ‰å­View &amp;amp; æµ‹é‡&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            measureChildBeforeLayout(child, i, widthMeasureSpec, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, heightMeasureSpec, totalWeight == &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt; ? mTotalLength : &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                   ...&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;//æ­¥éª¤2ï¼šåˆå¹¶æ‰€æœ‰å­Viewçš„å°ºå¯¸å¤§å°,æœ€ç»ˆå¾—åˆ°ViewGroupçˆ¶è§†å›¾çš„æµ‹é‡å€¼ï¼ˆè‡ªèº«å®ç°ï¼‰&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; childHeight = child.getMeasuredHeight();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;// 1. mTotalLengthç”¨äºå­˜å‚¨LinearLayoutåœ¨ç«–ç›´æ–¹å‘çš„é«˜åº¦&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; totalLength = mTotalLength;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;// 2. æ¯æµ‹é‡ä¸€ä¸ªå­Viewçš„é«˜åº¦ï¼Œ mTotalLengthå°±ä¼šå¢åŠ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            mTotalLength = Math.max(totalLength, totalLength + childHeight + lp.topMargin +&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                           lp.bottomMargin + getNextLocationOffset(child));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// 3. è®°å½•LinearLayoutå ç”¨çš„æ€»é«˜åº¦&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// å³é™¤äº†å­Viewçš„é«˜åº¦ï¼Œè¿˜æœ‰æœ¬èº«çš„paddingå±æ€§å€¼&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    mTotalLength += mPaddingTop + mPaddingBottom;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; heightSize = mTotalLength;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; heightSizeAndState = resolveSizeAndState(heightSize, heightMeasureSpec, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//æ­¥éª¤3ï¼šå­˜å‚¨æµ‹é‡åViewå®½/é«˜çš„å€¼ï¼šè°ƒç”¨setMeasuredDimension()&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    setMeasuredDimension(resolveSizeAndState(maxWidth, widthMeasureSpec, childState), heightSizeAndState);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ...&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;è·å–viewçš„å®½é«˜&#34;&gt;è·å–Viewçš„å®½é«˜&lt;a title=&#34;#è·å–viewçš„å®½é«˜&#34; href=&#34;#è·å–viewçš„å®½é«˜&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;Activity å¯åŠ¨æ—¶ï¼Œåœ¨ onCreate()ã€onStart()ã€onResume() ä¸­å‡æ— æ³•æ­£ç¡®çš„å¾—åˆ°æŸä¸ª View çš„å®½é«˜ä¿¡æ¯ï¼Œè¿™æ˜¯å› ä¸º View çš„ measure è¿‡ç¨‹å’Œ Activity çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¸æ˜¯åŒæ­¥æ‰§è¡Œçš„&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;onWindowFocusChanged()
&lt;ul&gt;
&lt;li&gt;éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒonWindowFocusChanged() ä¼šè¢«è°ƒç”¨å¤šæ¬¡ï¼Œå½“ Activity çš„çª—å£å¾—åˆ°ç„¦ç‚¹å’Œå¤±å»ç„¦ç‚¹æ—¶å‡ä¼šè¢«è°ƒç”¨ä¸€æ¬¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;View.post(runnable)&lt;/li&gt;
&lt;li&gt;ViewTreeObserver&lt;/li&gt;
&lt;li&gt;æ‰‹åŠ¨è°ƒç”¨ View çš„ measure æ–¹æ³•&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;refer&#34;&gt;Refer&lt;a title=&#34;#refer&#34; href=&#34;#refer&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/u010289802/article/details/80183142&#34; target=&#34;_blank&#34;&gt;Android çŸ¥è¯†ä½“ç³»å­¦ä¹ ç›®å½•_lerendançš„åšå®¢-CSDNåšå®¢&lt;/a&gt;&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://onion99.github.io/2021/11/04/SA664RldODNgeCrz/</guid>
            <title>è‡ªå®šä¹‰View(5) - åŠ¨ç”»</title>
            <link>https://onion99.github.io/2021/11/04/SA664RldODNgeCrz/</link>
            <category>å›¾å½¢ç»˜åˆ¶</category>
            <pubDate>Thu, 04 Nov 2021 05:59:44 +0800</pubDate>
            <description><![CDATA[ &lt;blockquote&gt;
&lt;p&gt;ä¸‰è€…æ€§èƒ½æ˜¯ä¸€æ ·çš„ï¼Œå› ä¸º ViewPropertyAnimator å’Œ ObjectAnimator çš„å†…éƒ¨å®ç°å…¶å®éƒ½æ˜¯ ValueAnimatorï¼ŒObjectAnimator æ›´æ˜¯æœ¬æ¥å°±æ˜¯ ValueAnimator çš„å­ç±»ï¼Œå·®åˆ«åªæ˜¯ä½¿ç”¨çš„ä¾¿æ·æ€§ä»¥åŠåŠŸèƒ½çš„çµæ´»æ€§ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/02/IFf4h9.gif&#34; alt=&#34;IFf4h9.gif&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;h3 id=&#34;viewpropertyanimator&#34;&gt;ViewPropertyAnimator&lt;a title=&#34;#viewpropertyanimator&#34; href=&#34;#viewpropertyanimator&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;view.animate()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        .scaleX(&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        .scaleY(&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        .alpha(&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;objectanimator&#34;&gt;ObjectAnimator&lt;a title=&#34;#objectanimator&#34; href=&#34;#objectanimator&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;å¤šä¸ªåŠ¨ç”»é…åˆæ‰§è¡Œ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;PropertyValuesHolder holder1 = PropertyValuesHolder.ofFloat(&lt;span class=&#34;string&#34;&gt;&amp;quot;scaleX&amp;quot;&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;PropertyValuesHolder holder2 = PropertyValuesHolder.ofFloat(&lt;span class=&#34;string&#34;&gt;&amp;quot;scaleY&amp;quot;&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;PropertyValuesHolder holder3 = PropertyValuesHolder.ofFloat(&lt;span class=&#34;string&#34;&gt;&amp;quot;alpha&amp;quot;&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ObjectAnimator animator = ObjectAnimator.ofPropertyValuesHolder(view, holder1, holder2, holder3)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;animator.start();&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;valueanimator&#34;&gt;ValueAnimator&lt;a title=&#34;#valueanimator&#34; href=&#34;#valueanimator&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;ValueAnimator æœ¬èº«ä¸ä½œç”¨äºä»»ä½•ä¸€ä¸ªå±æ€§ï¼Œä¹Ÿä¸æä¾›ä»»ä½•ä¸€ç§åŠ¨ç”»ã€‚å®ƒå°±æ˜¯ä¸€ä¸ªæ•°å€¼å‘ç”Ÿå™¨ï¼Œå¯ä»¥äº§ç”Ÿæƒ³è¦çš„å„ç§æ•°å€¼&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ValueAnimator å¹¶ä¸å¸¸ç”¨ï¼Œå› ä¸ºå®ƒçš„åŠŸèƒ½å¤ªåŸºç¡€äº†ã€‚ValueAnimator æ˜¯ ObjectAnimator çš„çˆ¶ç±»ï¼Œå®é™…ä¸Šï¼ŒValueAnimator å°±æ˜¯ä¸€ä¸ªä¸èƒ½æŒ‡å®šç›®æ ‡å¯¹è±¡ç‰ˆæœ¬çš„ ObjectAnimato&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://onion99.github.io/2021/11/04/ZOnr24kULe7cQgsc/</guid>
            <title>è‡ªå®šä¹‰View(4) - Canvasç›¸å…³</title>
            <link>https://onion99.github.io/2021/11/04/ZOnr24kULe7cQgsc/</link>
            <category>å›¾å½¢ç»˜åˆ¶</category>
            <pubDate>Thu, 04 Nov 2021 05:58:53 +0800</pubDate>
            <description><![CDATA[ &lt;h3 id=&#34;èŒƒå›´è£åˆ‡&#34;&gt;èŒƒå›´è£åˆ‡&lt;a title=&#34;#èŒƒå›´è£åˆ‡&#34; href=&#34;#èŒƒå›´è£åˆ‡&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;h4 id=&#34;cliprect&#34;&gt;clipRect&lt;a title=&#34;#cliprect&#34; href=&#34;#cliprect&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/02/IFKTER.png&#34; alt=&#34;IFKTER.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;canvas.clipRect(left, top, right, bottom);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;canvas.drawBitmap(bitmap, x, y, paint);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// åŠ ä¸Š Canvas.save() å’Œ Canvas.restore() æ¥åŠæ—¶æ¢å¤ç»˜åˆ¶èŒƒå›´&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;canvas.save();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;canvas.clipRect(left, top, right, bottom);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;canvas.drawBitmap(bitmap, x, y, paint);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;canvas.restore();&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;h4 id=&#34;clippath&#34;&gt;clipPath&lt;a title=&#34;#clippath&#34; href=&#34;#clippath&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/02/IFM9UI.md.png&#34; alt=&#34;IFM9UI.md.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;canvas.save();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;canvas.clipPath(path1);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;canvas.drawBitmap(bitmap, point1.x, point1.y, paint);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;canvas.restore();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;canvas.save();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;canvas.clipPath(path2);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;canvas.drawBitmap(bitmap, point2.x, point2.y, paint);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;canvas.restore();&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;å‡ ä½•å˜æ¢&#34;&gt;å‡ ä½•å˜æ¢&lt;a title=&#34;#å‡ ä½•å˜æ¢&#34; href=&#34;#å‡ ä½•å˜æ¢&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;h4 id=&#34;äºŒç»´å˜æ¢&#34;&gt;äºŒç»´å˜æ¢&lt;a title=&#34;#äºŒç»´å˜æ¢&#34; href=&#34;#äºŒç»´å˜æ¢&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;å¤„ç†å¸¸è§çš„äºŒç»´å˜æ¢&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Canvas.translate()&lt;/code&gt; å¹³ç§»&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Canvas.rotate()&lt;/code&gt; æ—‹è½¬&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Canvas.scale()&lt;/code&gt; ç¼©æ”¾&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Canvas.skew()&lt;/code&gt; é”™åˆ‡&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;matrixå˜æ¢&#34;&gt;Matrixå˜æ¢&lt;a title=&#34;#matrixå˜æ¢&#34; href=&#34;#matrixå˜æ¢&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;ç”¨æ¥å¤„ç†ä¸å¸¸è§çš„äºŒç»´å˜æ¢&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/02/IFn6qs.png&#34; alt=&#34;IFn6qs.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Canvas.setMatrix(matrix)&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;ç”¨ &lt;code&gt;Matrix&lt;/code&gt; ç›´æ¥æ›¿æ¢ &lt;code&gt;Canvas&lt;/code&gt; å½“å‰çš„å˜æ¢çŸ©é˜µï¼Œå³æŠ›å¼ƒ &lt;code&gt;Canvas&lt;/code&gt; å½“å‰çš„å˜æ¢&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Canvas.concat(matrix)&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;ç”¨ &lt;code&gt;Canvas&lt;/code&gt; å½“å‰çš„å˜æ¢çŸ©é˜µå’Œ &lt;code&gt;Matrix&lt;/code&gt; ç›¸ä¹˜ï¼Œå³åŸºäº &lt;code&gt;Canvas&lt;/code&gt; å½“å‰çš„å˜æ¢ï¼Œå åŠ ä¸Š &lt;code&gt;Matrix&lt;/code&gt; ä¸­çš„å˜æ¢&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;Matrix matrix = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; Matrix();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;float&lt;/span&gt; pointsSrc = &amp;#123;left, top, right, top, left, bottom, right, bottom&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;float&lt;/span&gt; pointsDst = &amp;#123;left - &lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;, top + &lt;span class=&#34;number&#34;&gt;50&lt;/span&gt;, right + &lt;span class=&#34;number&#34;&gt;120&lt;/span&gt;, top - &lt;span class=&#34;number&#34;&gt;90&lt;/span&gt;, left + &lt;span class=&#34;number&#34;&gt;20&lt;/span&gt;, bottom + &lt;span class=&#34;number&#34;&gt;30&lt;/span&gt;, right + &lt;span class=&#34;number&#34;&gt;20&lt;/span&gt;, bottom + &lt;span class=&#34;number&#34;&gt;60&lt;/span&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;...&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;matrix.reset();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;matrix.setPolyToPoly(pointsSrc, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, pointsDst, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;4&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;canvas.save();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;canvas.concat(matrix);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;canvas.drawBitmap(bitmap, x, y, paint);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;canvas.restore();&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;camera&#34;&gt;Camera&lt;a title=&#34;#camera&#34; href=&#34;#camera&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;å¤„ç†ä¸‰ç»´æ—‹è½¬&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h5 id=&#34;camera.rotate*&#34;&gt;Camera.rotate*&lt;a title=&#34;#camera.rotate*&#34; href=&#34;#camera.rotate*&#34;&gt;&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/02/IFZoMd.md.png&#34; alt=&#34;IFZoMd.md.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;Camera camera =  &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt;  Camera();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Point point1 = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; Point(&lt;span class=&#34;number&#34;&gt;200&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;100&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Point point2 = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; Point(&lt;span class=&#34;number&#34;&gt;600&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;200&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onDraw&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(Canvas canvas)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   canvas.save();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   camera.save(); &lt;span class=&#34;comment&#34;&gt;// ä¿å­˜ Camera çš„çŠ¶æ€&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   camera.rotateX(&lt;span class=&#34;number&#34;&gt;30&lt;/span&gt;); &lt;span class=&#34;comment&#34;&gt;// æ—‹è½¬ Camera çš„ä¸‰ç»´ç©ºé—´&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   camera.applyToCanvas(canvas); &lt;span class=&#34;comment&#34;&gt;// æŠŠæ—‹è½¬æŠ•å½±åˆ° Canvas&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   camera.restore(); &lt;span class=&#34;comment&#34;&gt;// æ¢å¤ Camera çš„çŠ¶æ€&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   canvas.drawBitmap(bitmap, point1.x, point1.y, paint);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   canvas.restore();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å±…ä¸­å¤„ç†:&lt;br&gt;
&lt;img src=&#34;https://z3.ax1x.com/2021/11/02/IFesfS.png&#34; alt=&#34;IFesfS.png&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; bitmapWidth = bitmap.getWidth();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; bitmapHeight = bitmap.getHeight();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; center1X = point1.x + bitmapWidth / &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; center1Y = point1.y + bitmapHeight / &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; center2X = point2.x + bitmapWidth / &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; center2Y = point2.y + bitmapHeight / &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;camera.save();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;matrix.reset();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;camera.rotateX(&lt;span class=&#34;number&#34;&gt;30&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;camera.getMatrix(matrix);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;camera.restore();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;matrix.preTranslate(-center1X, -center1Y);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;matrix.postTranslate(center1X, center1Y);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;canvas.save();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;canvas.concat(matrix);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;canvas.drawBitmap(bitmap, point1.x, point1.y, paint);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;canvas.restore();&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h5 id=&#34;camera.translate&#34;&gt;Camera.translate&lt;a title=&#34;#camera.translate&#34; href=&#34;#camera.translate&#34;&gt;&lt;/a&gt;&lt;/h5&gt;
&lt;h5 id=&#34;camera.setlocation&#34;&gt;Camera.setLocation&lt;a title=&#34;#camera.setlocation&#34; href=&#34;#camera.setlocation&#34;&gt;&lt;/a&gt;&lt;/h5&gt;
&lt;blockquote&gt;
&lt;p&gt;è®¾ç½®è™šæ‹Ÿç›¸æœºçš„ä½ç½®&lt;/p&gt;
&lt;/blockquote&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://onion99.github.io/2021/11/04/VjI1fQxy8MSFqUqm/</guid>
            <title>è‡ªå®šä¹‰View(3) - Textç›¸å…³</title>
            <link>https://onion99.github.io/2021/11/04/VjI1fQxy8MSFqUqm/</link>
            <category>å›¾å½¢ç»˜åˆ¶</category>
            <pubDate>Thu, 04 Nov 2021 05:57:48 +0800</pubDate>
            <description><![CDATA[ &lt;h3 id=&#34;æ–‡å­—ç»˜åˆ¶(canvas)&#34;&gt;æ–‡å­—ç»˜åˆ¶(Canvas)&lt;a title=&#34;#æ–‡å­—ç»˜åˆ¶(canvas)&#34; href=&#34;#æ–‡å­—ç»˜åˆ¶(canvas)&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;h4 id=&#34;ç»˜åˆ¶æ–¹å¼&#34;&gt;ç»˜åˆ¶æ–¹å¼&lt;a title=&#34;#ç»˜åˆ¶æ–¹å¼&#34; href=&#34;#ç»˜åˆ¶æ–¹å¼&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;h5 id=&#34;drawtext&#34;&gt;drawText&lt;a title=&#34;#drawtext&#34; href=&#34;#drawtext&#34;&gt;&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/02/IiheJA.png&#34; alt=&#34;IiheJA.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;String text = &lt;span class=&#34;string&#34;&gt;&amp;quot;Hello HenCoder&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;...&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;canvas.drawText(text, &lt;span class=&#34;number&#34;&gt;200&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;100&lt;/span&gt;, paint);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h5 id=&#34;drawtextrun&#34;&gt;drawTextRun&lt;a title=&#34;#drawtextrun&#34; href=&#34;#drawtextrun&#34;&gt;&lt;/a&gt;&lt;/h5&gt;
&lt;h5 id=&#34;drawtextonpath&#34;&gt;drawTextOnPath&lt;a title=&#34;#drawtextonpath&#34; href=&#34;#drawtextonpath&#34;&gt;&lt;/a&gt;&lt;/h5&gt;
&lt;blockquote&gt;
&lt;p&gt;æ²¿ç€ä¸€æ¡ Path æ¥ç»˜åˆ¶æ–‡å­—&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/02/IihNzq.png&#34; alt=&#34;IihNzq.png&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;code&gt;drawTextOnPath()&lt;/code&gt; ä½¿ç”¨çš„ &lt;code&gt;Path&lt;/code&gt; ï¼Œæ‹å¼¯å¤„å…¨ç”¨åœ†è§’ï¼Œåˆ«ç”¨å°–è§’&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;canvas.drawPath(path, paint); &lt;span class=&#34;comment&#34;&gt;// æŠŠ Path ä¹Ÿç»˜åˆ¶å‡ºæ¥ï¼Œç†è§£èµ·æ¥æ›´æ–¹ä¾¿&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;canvas.drawTextOnPath(&lt;span class=&#34;string&#34;&gt;&amp;quot;Hello HeCoder&amp;quot;&lt;/span&gt;, path, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, paint);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h5 id=&#34;staticlayout&#34;&gt;StaticLayout&lt;a title=&#34;#staticlayout&#34; href=&#34;#staticlayout&#34;&gt;&lt;/a&gt;&lt;/h5&gt;
&lt;blockquote&gt;
&lt;p&gt;è¿›è¡Œå¤šè¡Œæ–‡å­—çš„ç»˜åˆ¶&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;View çš„è¾¹ç¼˜è‡ªåŠ¨æŠ˜è¡Œ&lt;/li&gt;
&lt;li&gt;åœ¨æ¢è¡Œç¬¦ &lt;code&gt;\n&lt;/code&gt; å¤„æ¢è¡Œ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/02/Iih7Yd.md.png&#34; alt=&#34;Iih7Yd.md.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;String text1 = &lt;span class=&#34;string&#34;&gt;&amp;quot;Lorem Ipsum is simply dummy text of the printing and typesetting industry.&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;StaticLayout staticLayout1 = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; StaticLayout(text1, paint, &lt;span class=&#34;number&#34;&gt;600&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        Layout.Alignment.ALIGN_NORMAL, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;keyword&#34;&gt;true&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;String text2 = &lt;span class=&#34;string&#34;&gt;&amp;quot;a\nbc\ndefghi\njklm\nnopqrst\nuvwx\nyz&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;StaticLayout staticLayout2 = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; StaticLayout(text2, paint, &lt;span class=&#34;number&#34;&gt;600&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        Layout.Alignment.ALIGN_NORMAL, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;keyword&#34;&gt;true&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;...&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;canvas.save();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;canvas.translate(&lt;span class=&#34;number&#34;&gt;50&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;100&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;staticLayout1.draw(canvas);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;canvas.translate(&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;200&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;staticLayout2.draw(canvas);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;canvas.restore();&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;æ–‡å­—ç»˜åˆ¶è¾…åŠ©(paint)&#34;&gt;æ–‡å­—ç»˜åˆ¶è¾…åŠ©(Paint)&lt;a title=&#34;#æ–‡å­—ç»˜åˆ¶è¾…åŠ©(paint)&#34; href=&#34;#æ–‡å­—ç»˜åˆ¶è¾…åŠ©(paint)&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;h4 id=&#34;æ ·å¼è®¾ç½®&#34;&gt;æ ·å¼è®¾ç½®&lt;a title=&#34;#æ ·å¼è®¾ç½®&#34; href=&#34;#æ ·å¼è®¾ç½®&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;setTextSize(float textSize)&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;setTypeface(Typeface typeface)&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;setFakeBoldText(boolean fakeBoldText)&lt;/code&gt;æ˜¯å¦ä½¿ç”¨ä¼ªç²—ä½“&lt;/li&gt;
&lt;li&gt;&lt;code&gt;setStrikeThruText(boolean strikeThruText)&lt;/code&gt;æ˜¯å¦åŠ åˆ é™¤çº¿&lt;/li&gt;
&lt;li&gt;&lt;code&gt;setUnderlineText(boolean underlineText)&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;setTextSkewX(float skewX)&lt;/code&gt; æ–‡å­—æ¨ªåˆ‡è§’åº¦&lt;/li&gt;
&lt;li&gt;&lt;code&gt;setTextScaleX(float scaleX)&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;setLetterSpacing(float letterSpacing)&lt;/code&gt; å­—ç¬¦é—´è·&lt;/li&gt;
&lt;li&gt;&lt;code&gt;setFontFeatureSettings(String settings)&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;setTextAlign(Paint.Align align)&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;setTextLocale(Locale locale)&lt;/code&gt;è¯­è¨€åŒºåŸŸ&lt;/li&gt;
&lt;li&gt;&lt;code&gt;setHinting(int mode)&lt;/code&gt;å­—ä½“å¾®è°ƒ&lt;/li&gt;
&lt;li&gt;&lt;code&gt;setSubpixelText(boolean subpixelText)&lt;/code&gt;æ˜¯å¦å¼€å¯åƒç´ çº§çš„æŠ—é”¯é½¿&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;æµ‹é‡&#34;&gt;æµ‹é‡&lt;a title=&#34;#æµ‹é‡&#34; href=&#34;#æµ‹é‡&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;getFontSpacing()&lt;/code&gt; è·å–æ¨èçš„è¡Œè·
&lt;ul&gt;
&lt;li&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/02/IiboRg.png&#34; alt=&#34;IiboRg.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;getFontMetrics()&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/02/IibtM9.png&#34; alt=&#34;IibtM9.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;getTextBounds()&lt;/code&gt; è·å–æ–‡å­—èŒƒå›´&lt;/li&gt;
&lt;li&gt;&lt;code&gt;measureText()&lt;/code&gt;æµ‹é‡æ–‡å­—çš„å®½åº¦å¹¶è¿”å›&lt;/li&gt;
&lt;li&gt;&lt;code&gt;getTextWidths()&lt;/code&gt;è·å–å­—ç¬¦ä¸²ä¸­æ¯ä¸ªå­—ç¬¦çš„å®½åº¦&lt;/li&gt;
&lt;li&gt;&lt;code&gt;breakText()&lt;/code&gt; å’Œ &lt;code&gt;measureText()&lt;/code&gt; çš„åŒºåˆ«æ˜¯ï¼Œ breakText() æ˜¯åœ¨ç»™å‡ºå®½åº¦ä¸Šé™çš„å‰æä¸‹æµ‹é‡æ–‡å­—çš„å®½åº¦ã€‚å¦‚æœæ–‡å­—çš„å®½åº¦è¶…å‡ºäº†ä¸Šé™ï¼Œé‚£ä¹ˆåœ¨ä¸´è¿‘è¶…é™çš„ä½ç½®æˆªæ–­æ–‡å­—&lt;/li&gt;
&lt;li&gt;å…‰æ ‡ç›¸å…³
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;getRunAdvance()&lt;/code&gt;è®¡ç®—å‡ºæŸä¸ªå­—ç¬¦å¤„å…‰æ ‡çš„ &lt;code&gt;x&lt;/code&gt; åæ ‡
&lt;ul&gt;
&lt;li&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/02/Iibnrn.png&#34; alt=&#34;Iibnrn.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/li&gt;
&lt;li&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/02/IibMV0.md.png&#34; alt=&#34;IibMV0.md.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;getOffsetForAdvance&lt;/code&gt; è®¡ç®—ç¬¬å‡ ä¸ªå­—ç¬¦æœ€æ¥è¿‘è¿™ä¸ªåæ ‡&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;hasGlyph()&lt;/code&gt;æ£€æŸ¥æŒ‡å®šçš„å­—ç¬¦ä¸²ä¸­æ˜¯å¦æ˜¯ä¸€ä¸ªå•ç‹¬çš„å­—å½¢
&lt;ul&gt;
&lt;li&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/02/IiH9tU.png&#34; alt=&#34;IiH9tU.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://onion99.github.io/2021/11/02/weRgrdLnBqIUWkcH/</guid>
            <title>è‡ªå®šä¹‰View(2) - Paintç›¸å…³</title>
            <link>https://onion99.github.io/2021/11/02/weRgrdLnBqIUWkcH/</link>
            <category>å›¾å½¢ç»˜åˆ¶</category>
            <pubDate>Tue, 02 Nov 2021 06:19:10 +0800</pubDate>
            <description><![CDATA[ &lt;h3 id=&#34;color&#34;&gt;Color&lt;a title=&#34;#color&#34; href=&#34;#color&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;h4 id=&#34;åŸºæœ¬é¢œè‰²&#34;&gt;åŸºæœ¬é¢œè‰²&lt;a title=&#34;#åŸºæœ¬é¢œè‰²&#34; href=&#34;#åŸºæœ¬é¢œè‰²&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;setColor(int color):&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;paint.setColor(Color.parseColor(&lt;span class=&#34;string&#34;&gt;&amp;quot;#009688&amp;quot;&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;canvas.drawRect(&lt;span class=&#34;number&#34;&gt;30&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;30&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;230&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;180&lt;/span&gt;, paint);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;p&gt;setARGB(int a, int r, int g, int b)&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;paint.setARGB(&lt;span class=&#34;number&#34;&gt;100&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;canvas.drawLine(&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;200&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;200&lt;/span&gt;, paint);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;shader&#34;&gt;Shader&lt;a title=&#34;#shader&#34; href=&#34;#shader&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;h5 id=&#34;lineargradient(çº¿æ€§æ¸å˜)&#34;&gt;LinearGradient(çº¿æ€§æ¸å˜)&lt;a title=&#34;#lineargradient(çº¿æ€§æ¸å˜)&#34; href=&#34;#lineargradient(çº¿æ€§æ¸å˜)&#34;&gt;&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/01/ICK7e1.png&#34; alt=&#34;ICK7e1.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;Shader shader = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; LinearGradient(&lt;span class=&#34;number&#34;&gt;100&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;100&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;500&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;500&lt;/span&gt;, Color.parseColor(&lt;span class=&#34;string&#34;&gt;&amp;quot;#E91E63&amp;quot;&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        Color.parseColor(&lt;span class=&#34;string&#34;&gt;&amp;quot;#2196F3&amp;quot;&lt;/span&gt;), Shader.TileMode.CLAMP);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;paint.setShader(shader);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;...&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;canvas.drawCircle(&lt;span class=&#34;number&#34;&gt;300&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;300&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;200&lt;/span&gt;, paint);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;div class=&#34;Ï†bq&#34;&gt;&lt;div class=&#34;Ï†bs&#34;&gt;&lt;table&gt;&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;CLAMP&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;MIRROR&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;REPEAT&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/01/ICuIVP.png&#34; alt=&#34;ICuIVP.png&#34; loading=&#34;lazy&#34;&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/01/ICKWJU.png&#34; alt=&#34;ICKWJU.png&#34; loading=&#34;lazy&#34;&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/01/ICK5QJ.png&#34; alt=&#34;ICK5QJ.png&#34; loading=&#34;lazy&#34;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;&lt;/div&gt;&lt;/div&gt;&lt;h5 id=&#34;radialgradient(è¾å°„æ¸å˜)&#34;&gt;RadialGradient(è¾å°„æ¸å˜)&lt;a title=&#34;#radialgradient(è¾å°„æ¸å˜)&#34; href=&#34;#radialgradient(è¾å°„æ¸å˜)&#34;&gt;&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/01/IClQRU.png&#34; alt=&#34;IClQRU.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;Shader shader = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; RadialGradient(&lt;span class=&#34;number&#34;&gt;300&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;300&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;200&lt;/span&gt;, Color.parseColor(&lt;span class=&#34;string&#34;&gt;&amp;quot;#E91E63&amp;quot;&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        Color.parseColor(&lt;span class=&#34;string&#34;&gt;&amp;quot;#2196F3&amp;quot;&lt;/span&gt;), Shader.TileMode.CLAMP);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;paint.setShader(shader);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;...&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;canvas.drawCircle(&lt;span class=&#34;number&#34;&gt;300&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;300&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;200&lt;/span&gt;, paint);  &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;div class=&#34;Ï†bq&#34;&gt;&lt;div class=&#34;Ï†bs&#34;&gt;&lt;table&gt;&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;CLAMP&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;MIRROR&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;REPEAT&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/01/IClfW8.png&#34; alt=&#34;IClfW8.png&#34; loading=&#34;lazy&#34;&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/01/IC1SOJ.png&#34; alt=&#34;IC1SOJ.png&#34; loading=&#34;lazy&#34;&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/01/IC1SOJ.png&#34; alt=&#34;IC1SOJ.png&#34; loading=&#34;lazy&#34;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;&lt;/div&gt;&lt;/div&gt;&lt;h5 id=&#34;sweepgradient(æ‰«ææ¸å˜)&#34;&gt;SweepGradient(æ‰«ææ¸å˜)&lt;a title=&#34;#sweepgradient(æ‰«ææ¸å˜)&#34; href=&#34;#sweepgradient(æ‰«ææ¸å˜)&#34;&gt;&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/01/IC3N8K.png&#34; alt=&#34;IC3N8K.png&#34; loading=&#34;lazy&#34;&gt;]&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;Shader shader = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; SweepGradient(&lt;span class=&#34;number&#34;&gt;300&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;300&lt;/span&gt;, Color.parseColor(&lt;span class=&#34;string&#34;&gt;&amp;quot;#E91E63&amp;quot;&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        Color.parseColor(&lt;span class=&#34;string&#34;&gt;&amp;quot;#2196F3&amp;quot;&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;paint.setShader(shader);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;...&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;canvas.drawCircle(&lt;span class=&#34;number&#34;&gt;300&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;300&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;200&lt;/span&gt;, paint);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h5 id=&#34;bitmapshader&#34;&gt;BitmapShader&lt;a title=&#34;#bitmapshader&#34; href=&#34;#bitmapshader&#34;&gt;&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/01/IC8dJ0.png&#34; alt=&#34;IC8dJ0.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;Bitmap bitmap = BitmapFactory.decodeResource(getResources(), R.drawable.batman);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Shader shader = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; BitmapShader(bitmap, Shader.TileMode.CLAMP, Shader.TileMode.CLAMP);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;paint.setShader(shader);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;...&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;canvas.drawCircle(&lt;span class=&#34;number&#34;&gt;300&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;300&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;200&lt;/span&gt;, paint);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;div class=&#34;Ï†bq&#34;&gt;&lt;div class=&#34;Ï†bs&#34;&gt;&lt;table&gt;&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;CLAMP&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;MIRROR&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;REPEAT&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/01/ICGhAs.png&#34; alt=&#34;ICGhAs.png&#34; loading=&#34;lazy&#34;&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/01/ICG7cT.png&#34; alt=&#34;ICG7cT.png&#34; loading=&#34;lazy&#34;&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/01/ICGLB4.png&#34; alt=&#34;ICGLB4.png&#34; loading=&#34;lazy&#34;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;&lt;/div&gt;&lt;/div&gt;&lt;h5 id=&#34;composeshader-æ··åˆç€è‰²å™¨&#34;&gt;ComposeShader æ··åˆç€è‰²å™¨&lt;a title=&#34;#composeshader-æ··åˆç€è‰²å™¨&#34; href=&#34;#composeshader-æ··åˆç€è‰²å™¨&#34;&gt;&lt;/a&gt;&lt;/h5&gt;
&lt;blockquote&gt;
&lt;p&gt;æ‰€è°“æ··åˆï¼Œå°±æ˜¯æŠŠä¸¤ä¸ª Shader ä¸€èµ·ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/01/ICUmdg.png&#34; alt=&#34;ICUmdg.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// ç¬¬ä¸€ä¸ª Shaderï¼šå¤´åƒçš„ Bitmap&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Bitmap bitmap1 = BitmapFactory.decodeResource(getResources(), R.drawable.batman);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Shader shader1 = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; BitmapShader(bitmap1, Shader.TileMode.CLAMP, Shader.TileMode.CLAMP);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// ç¬¬äºŒä¸ª Shaderï¼šä»ä¸Šåˆ°ä¸‹çš„çº¿æ€§æ¸å˜ï¼ˆç”±é€æ˜åˆ°é»‘è‰²ï¼‰&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Bitmap bitmap2 = BitmapFactory.decodeResource(getResources(), R.drawable.batman_logo);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Shader shader2 = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; BitmapShader(bitmap2, Shader.TileMode.CLAMP, Shader.TileMode.CLAMP);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// ComposeShaderï¼šç»“åˆä¸¤ä¸ª Shader&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Shader shader = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; ComposeShader(shader1, shader2, PorterDuff.Mode.SRC_OVER);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;paint.setShader(shader);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;...&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;canvas.drawCircle(&lt;span class=&#34;number&#34;&gt;300&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;300&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;300&lt;/span&gt;, paint);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;porterduff&#34;&gt;PorterDuff&lt;a title=&#34;#porterduff&#34; href=&#34;#porterduff&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;h3 id=&#34;patheffect&#34;&gt;PathEffect&lt;a title=&#34;#patheffect&#34; href=&#34;#patheffect&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;h4 id=&#34;style&#34;&gt;Style&lt;a title=&#34;#style&#34; href=&#34;#style&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;&lt;code&gt;Paint.setStrokeWidth&lt;/code&gt;:çº¿æ¡å®½åº¦&lt;br&gt;
&lt;img src=&#34;https://z3.ax1x.com/2021/11/01/ICvqQe.png&#34; alt=&#34;ICvqQe.png&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;paint.setStyle(Paint.Style.STROKE);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;paint.setStrokeWidth(&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;canvas.drawCircle(&lt;span class=&#34;number&#34;&gt;150&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;125&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;100&lt;/span&gt;, paint);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;paint.setStrokeWidth(&lt;span class=&#34;number&#34;&gt;5&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;canvas.drawCircle(&lt;span class=&#34;number&#34;&gt;400&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;125&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;100&lt;/span&gt;, paint);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;paint.setStrokeWidth(&lt;span class=&#34;number&#34;&gt;40&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;canvas.drawCircle(&lt;span class=&#34;number&#34;&gt;650&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;125&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;100&lt;/span&gt;, paint);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;code&gt;Paint.setStrokeCap&lt;/code&gt;:çº¿æ¡å½¢çŠ¶&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/01/ICxkLj.png&#34; alt=&#34;ICxkLj.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Paint.setStrokeJoin&lt;/code&gt;:æ‹è§’å½¢çŠ¶&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/01/ICxQlF.png&#34; alt=&#34;ICxQlF.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Paint.setStrokeMiter&lt;/code&gt;:æ‹è§’è¾¹ç¼˜&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/01/ICzenH.png&#34; alt=&#34;image&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;filter&#34;&gt;Filter&lt;a title=&#34;#filter&#34; href=&#34;#filter&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;&lt;code&gt;PathEffect.setDither()&lt;/code&gt;:å›¾åƒæŠ–åŠ¨&lt;br&gt;
&lt;img src=&#34;https://z3.ax1x.com/2021/11/01/ICL31H.png&#34; alt=&#34;ICL31H.png&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;PathEffect.setFilterBitmap()&lt;/code&gt;:åŒçº¿æ€§è¿‡æ»¤&lt;br&gt;
&lt;img src=&#34;https://z3.ax1x.com/2021/11/01/ICvZ8O.png&#34; alt=&#34;ICvZ8O.png&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;effect&#34;&gt;Effect&lt;a title=&#34;#effect&#34; href=&#34;#effect&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;div class=&#34;Ï†bq&#34;&gt;&lt;div class=&#34;Ï†bs&#34;&gt;&lt;table&gt;&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;Name&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;Effect&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;CornerPathEffect&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/01/ICgRkq.png&#34; alt=&#34;ICgRkq.png&#34; loading=&#34;lazy&#34;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;DiscretePathEffect&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/01/ICgGOH.png&#34; alt=&#34;ICgGOH.png&#34; loading=&#34;lazy&#34;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;DashPathEffect&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/01/ICcXQg.png&#34; alt=&#34;ICcXQg.png&#34; loading=&#34;lazy&#34;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;PathDashPathEffect&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/01/IC6T8U.png&#34; alt=&#34;IC6T8U.png&#34; loading=&#34;lazy&#34;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;SumPathEffect&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/01/ICyBpF.png&#34; alt=&#34;ICyBpF.png&#34; loading=&#34;lazy&#34;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;ComposePathEffect&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/01/ICy8yj.png&#34; alt=&#34;ICy8yj.png&#34; loading=&#34;lazy&#34;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;&lt;/div&gt;&lt;/div&gt;&lt;h4 id=&#34;shadowlayer&#34;&gt;ShadowLayer&lt;a title=&#34;#shadowlayer&#34; href=&#34;#shadowlayer&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»˜åˆ¶å±‚ä¸‹æ–¹çš„é˜´å½±æ•ˆæœ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/01/ICstPO.png&#34; alt=&#34;ICstPO.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;paint.setShadowLayer(&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, Color.RED);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;canvas.drawText(text, &lt;span class=&#34;number&#34;&gt;80&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;300&lt;/span&gt;, paint);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;maskfilter&#34;&gt;MaskFilter&lt;a title=&#34;#maskfilter&#34; href=&#34;#maskfilter&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»˜åˆ¶å±‚ä¸Šæ–¹çš„é™„åŠ æ•ˆæœ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;BlurMaskFilter(æ¨¡ç³Šæ•ˆæœ):&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/01/ICrhE6.md.png&#34; alt=&#34;ICrhE6.md.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;paint.setMaskFilter(&lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; BlurMaskFilter(&lt;span class=&#34;number&#34;&gt;50&lt;/span&gt;, BlurMaskFilter.Blur.NORMAL));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;canvas.drawBitmap(bitmap, &lt;span class=&#34;number&#34;&gt;100&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;100&lt;/span&gt;, paint);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;EmbossMaskFilter(æµ®é›•æ•ˆæœ):&lt;br&gt;
&lt;img src=&#34;https://z3.ax1x.com/2021/11/01/ICr0EV.png&#34; alt=&#34;ICr0EV.png&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// æ•°ç»„:å…‰æºæ–¹å‘,å…‰å¼ºåº¦,ç‚«å…‰ç³»æ•°,åº”ç”¨å…‰çº¿èŒƒå›´ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;paint.setMaskFilter(&lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; EmbossMaskFilter(&lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;float&lt;/span&gt;[]&amp;#123;&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;&amp;#125;, &lt;span class=&#34;number&#34;&gt;0.2f&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;8&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;canvas.drawBitmap(bitmap, &lt;span class=&#34;number&#34;&gt;100&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;100&lt;/span&gt;, paint);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;getpath&#34;&gt;getPath&lt;a title=&#34;#getpath&#34; href=&#34;#getpath&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;&lt;code&gt;PathEffect.getFillPath()&lt;/code&gt;è·å–å›¾å½¢Path&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/01/ICDOtU.md.png&#34; alt=&#34;ICDOtU.md.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;PathEffect.getTextPath()&lt;/code&gt;è·å–å›¾å½¢Path&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/01/ICDAQs.png&#34; alt=&#34;ICDAQs.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;refer&#34;&gt;Refer&lt;a title=&#34;#refer&#34; href=&#34;#refer&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://rengwuxian.com/ui-1-2/&#34; target=&#34;_blank&#34;&gt;HenCoder Android å¼€å‘è¿›é˜¶: è‡ªå®šä¹‰ View 1-2 Paint è¯¦è§£ (rengwuxian.com)&lt;/a&gt;&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://onion99.github.io/2021/11/02/K0uh0dFU4QBtZ8Wm/</guid>
            <title>è‡ªå®šä¹‰View(1) - åŸºæœ¬ç»˜åˆ¶</title>
            <link>https://onion99.github.io/2021/11/02/K0uh0dFU4QBtZ8Wm/</link>
            <category>å›¾å½¢ç»˜åˆ¶</category>
            <pubDate>Tue, 02 Nov 2021 06:17:37 +0800</pubDate>
            <description><![CDATA[ &lt;blockquote&gt;
&lt;p&gt;ç®€å•çš„ç»˜åˆ¶åŸºæœ¬ç”±&lt;code&gt;Canvas.drawxxx()&lt;/code&gt;å’ŒPaintçš„é…ç½®ç»„æˆ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/01/IC9uZj.png&#34; alt=&#34;IC9uZj.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight kotlin&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;PaintView&lt;/span&gt; &lt;span class=&#34;meta&#34;&gt;@JvmOverloads&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;constructor&lt;/span&gt;&lt;/span&gt;(context: Context, attrs: AttributeSet? = &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;, defStyleAttr: &lt;span class=&#34;built_in&#34;&gt;Int&lt;/span&gt; = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;) : View(context, attrs, defStyleAttr) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;val&lt;/span&gt; mPaint &lt;span class=&#34;keyword&#34;&gt;by&lt;/span&gt; lazy &amp;#123; Paint() &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;override&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onDraw&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(canvas: &lt;span class=&#34;type&#34;&gt;Canvas&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt; &amp;#123;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;super&lt;/span&gt;.onDraw(canvas)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    paint.setColor(Color.RED)&lt;span class=&#34;comment&#34;&gt;// è®¾ç½®ä¸ºçº¢è‰²&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    canvas.drawCircle(&lt;span class=&#34;number&#34;&gt;300&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;300&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;200&lt;/span&gt;, paint)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;h3 id=&#34;canvas&#34;&gt;Canvas&lt;a title=&#34;#canvas&#34; href=&#34;#canvas&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Canvas.drawArc()&lt;/code&gt; ç»˜åˆ¶å¼§å½¢æˆ–æ‰‡å½¢&lt;br&gt;
+ &lt;code&gt;left&lt;/code&gt;, &lt;code&gt;top&lt;/code&gt;, &lt;code&gt;right&lt;/code&gt;, &lt;code&gt;bottom&lt;/code&gt; æè¿°çš„æ˜¯è¿™ä¸ªå¼§å½¢æ‰€åœ¨çš„æ¤­åœ†&lt;br&gt;
+ &lt;code&gt;startAngle&lt;/code&gt; æ˜¯å¼§å½¢çš„èµ·å§‹è§’åº¦&lt;br&gt;
+ &lt;code&gt;sweepAngle&lt;/code&gt; æ˜¯å¼§å½¢åˆ’è¿‡çš„è§’åº¦&lt;br&gt;
+ &lt;code&gt;useCenter&lt;/code&gt; è¡¨ç¤ºæ˜¯å¦è¿æ¥åˆ°åœ†å¿ƒï¼Œå¦‚æœä¸è¿æ¥åˆ°åœ†å¿ƒï¼Œå°±æ˜¯å¼§å½¢ï¼Œå¦‚æœè¿æ¥åˆ°åœ†å¿ƒï¼Œå°±æ˜¯æ‰‡å½¢&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Canvas.drawPath()&lt;/code&gt; ç»„åˆå›¾å½¢&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;paint&#34;&gt;Paint&lt;a title=&#34;#paint&#34; href=&#34;#paint&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Paint.setStyle(Style style)&lt;/code&gt;  è®¾ç½®ç»˜åˆ¶æ¨¡å¼&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Paint.setColor(int color)&lt;/code&gt;  è®¾ç½®é¢œè‰²&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Paint.setStrokeWidth(float width)&lt;/code&gt;  è®¾ç½®çº¿æ¡å®½åº¦&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Paint.setTextSize(float textSize)&lt;/code&gt;  è®¾ç½®æ–‡å­—å¤§å°&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Paint.setAntiAlias(boolean aa)&lt;/code&gt;  è®¾ç½®æŠ—é”¯é½¿å¼€å…³&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;path&#34;&gt;Path&lt;a title=&#34;#path&#34; href=&#34;#path&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;å¦‚æœåªç”»ä¸€ä¸ªåœ†ï¼Œæ²¡å¿…è¦ç”¨ Pathï¼Œç›´æ¥ç”¨ drawCircle() å°±è¡Œäº†ã€‚drawPath() ä¸€èˆ¬æ˜¯åœ¨ç»˜åˆ¶ç»„åˆå›¾å½¢æ—¶æ‰ä¼šç”¨åˆ°çš„&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;path.addxxx&#34;&gt;Path.addXxx&lt;a title=&#34;#path.addxxx&#34; href=&#34;#path.addxxx&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;æ·»åŠ å­å›¾å½¢&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;code&gt;path.addCircle(300, 300, 200, Path.Direction.CW)&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&#34;path.xxxto&#34;&gt;Path.xxxTo&lt;a title=&#34;#path.xxxto&#34; href=&#34;#path.xxxto&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;ç”¨äºç”»çº¿ï¼ˆç›´çº¿æˆ–æ›²çº¿ï¼‰&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;code&gt;lineTo(float x, float y) / rLineTo(float x, float y) &lt;/code&gt;ç”»ç›´çº¿:&lt;br&gt;
&lt;img src=&#34;https://z3.ax1x.com/2021/11/01/ICkWGR.png&#34; alt=&#34;ICkWGR.png&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;paint.setStyle(Style.STROKE);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;path.lineTo(&lt;span class=&#34;number&#34;&gt;100&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;100&lt;/span&gt;); &lt;span class=&#34;comment&#34;&gt;// ç”±å½“å‰ä½ç½® (0, 0) å‘ (100, 100) ç”»ä¸€æ¡ç›´çº¿&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;path.rLineTo(&lt;span class=&#34;number&#34;&gt;100&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;); &lt;span class=&#34;comment&#34;&gt;// ç”±å½“å‰ä½ç½® (100, 100) å‘æ­£å³æ–¹ 100 åƒç´ çš„ä½ç½®ç”»ä¸€æ¡ç›´çº¿&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/01/ICASL8.png&#34; alt=&#34;ICASL8.png&#34; loading=&#34;lazy&#34;&gt;]&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;paint.setStyle(Style.STROKE);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;path.lineTo(&lt;span class=&#34;number&#34;&gt;100&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;100&lt;/span&gt;); &lt;span class=&#34;comment&#34;&gt;// ç”»æ–œçº¿&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;path.moveTo(&lt;span class=&#34;number&#34;&gt;200&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;100&lt;/span&gt;); &lt;span class=&#34;comment&#34;&gt;// æˆ‘ç§»~~&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;path.lineTo(&lt;span class=&#34;number&#34;&gt;200&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;); &lt;span class=&#34;comment&#34;&gt;// ç”»ç«–çº¿&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;code&gt;arcTo()&lt;/code&gt; å’Œ &lt;code&gt;addArc()&lt;/code&gt;ç”»å¼§çº¿:&lt;/p&gt;
&lt;div class=&#34;Ï†bq&#34;&gt;&lt;div class=&#34;Ï†bs&#34;&gt;&lt;table&gt;&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;true&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;false&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/01/ICEuct.png&#34; alt=&#34;ICEuct.png&#34; loading=&#34;lazy&#34;&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/01/ICEinK.png&#34; alt=&#34;ICEinK.png&#34; loading=&#34;lazy&#34;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;&lt;/div&gt;&lt;/div&gt;&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;paint.setStyle(Style.STROKE);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;path.lineTo(&lt;span class=&#34;number&#34;&gt;100&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;100&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// true ç›´æ¥è¿çº¿è¿åˆ°å¼§å½¢èµ·ç‚¹ï¼ˆæœ‰ç—•è¿¹ï¼‰&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// false å¼ºåˆ¶ç§»åŠ¨åˆ°å¼§å½¢èµ·ç‚¹ï¼ˆæ— ç—•è¿¹ï¼‰&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;path.arcTo(&lt;span class=&#34;number&#34;&gt;100&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;100&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;300&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;300&lt;/span&gt;, -&lt;span class=&#34;number&#34;&gt;90&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;90&lt;/span&gt;, &lt;span class=&#34;keyword&#34;&gt;true&lt;/span&gt;/&lt;span class=&#34;keyword&#34;&gt;false&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// ç­‰åŒä¸Šé¢&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;paint.setStyle(Style.STROKE);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;path.lineTo(&lt;span class=&#34;number&#34;&gt;100&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;100&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;path.addArc(&lt;span class=&#34;number&#34;&gt;100&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;100&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;300&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;300&lt;/span&gt;, -&lt;span class=&#34;number&#34;&gt;90&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;90&lt;/span&gt;); &lt;span class=&#34;comment&#34;&gt;// addArc() åªæ˜¯ä¸€ä¸ªç›´æ¥ä½¿ç”¨äº† forceMoveTo = true çš„ç®€åŒ–ç‰ˆ arcTo()&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;code&gt;close() &lt;/code&gt;å°é—­å½“å‰å­å›¾å½¢:&lt;/p&gt;
&lt;div class=&#34;Ï†bq&#34;&gt;&lt;div class=&#34;Ï†bs&#34;&gt;&lt;table&gt;&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;no close&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;close&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/01/ICVaPH.png&#34; alt=&#34;ICVaPH.png&#34; loading=&#34;lazy&#34;&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/01/ICVgIg.png&#34; alt=&#34;ICVgIg.png&#34; loading=&#34;lazy&#34;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;&lt;/div&gt;&lt;/div&gt;&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;paint.setStyle(Style.STROKE);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;path.moveTo(&lt;span class=&#34;number&#34;&gt;100&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;100&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;path.lineTo(&lt;span class=&#34;number&#34;&gt;200&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;100&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;path.lineTo(&lt;span class=&#34;number&#34;&gt;150&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;150&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;path.close(); &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;path.setfilltype&#34;&gt;Path.setFillType&lt;a title=&#34;#path.setfilltype&#34; href=&#34;#path.setfilltype&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;è®¾ç½®å¡«å……æ–¹å¼&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/01/ICFucV.png&#34; alt=&#34;ICFucV.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;div class=&#34;Ï†bq&#34;&gt;&lt;div class=&#34;Ï†bs&#34;&gt;&lt;table&gt;&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;EVEN_ODD:even-odd rule ï¼ˆå¥‡å¶åŸåˆ™ï¼‰&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;WINDING: non-zero winding rule ï¼ˆéé›¶ç¯ç»•æ•°åŸåˆ™ï¼‰&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/01/ICFKXT.png&#34; alt=&#34;ICFKXT.png&#34; loading=&#34;lazy&#34;&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/11/01/ICFJhR.png&#34; alt=&#34;ICFJhR.png&#34; loading=&#34;lazy&#34;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;&lt;/div&gt;&lt;/div&gt; ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://onion99.github.io/2021/11/01/15jfHwStpctgCeeA/</guid>
            <title>æºç å­¦ä¹  - Glide</title>
            <link>https://onion99.github.io/2021/11/01/15jfHwStpctgCeeA/</link>
            <category>æºç è§£æ</category>
            <pubDate>Mon, 01 Nov 2021 05:29:17 +0800</pubDate>
            <description><![CDATA[ &lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;Glide.with(fragment)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    .load(myUrl)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    .into(imageView);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/10/26/5oUW5R.png&#34; alt=&#34;5oUW5R.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;with()&#34;&gt;with()&lt;a title=&#34;#with()&#34; href=&#34;#with()&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;ç”¨Methodåˆå§‹åŒ–glideçš„ä¸€äº›å¿…éœ€çš„ç¯å¢ƒï¼Œç„¶åè°ƒç”¨Requestmanagerretriverçš„&lt;code&gt;get()&lt;/code&gt;è·å–requestManagerã€‚å¦‚æœä¼ å…¥çš„å¯¹è±¡æ˜¯å…¨å±€Contextï¼Œä½ å°±ä¸éœ€è¦å¤„ç†ç”Ÿå‘½å‘¨æœŸ;å¦‚æœè¾“å…¥æ˜¯å…·æœ‰ç”Ÿå‘½å‘¨æœŸçš„View(åŒ…å«Frgæˆ–Act)åˆ™å°†æ·»åŠ ä¸€ä¸ªéšè—çš„Fragmentæ¥æ„ŸçŸ¥ç”Ÿå‘½å‘¨æœŸ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;static&lt;/span&gt; RequestManager &lt;span class=&#34;title&#34;&gt;with&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; Context context)&lt;/span&gt; &lt;/span&gt;&amp;#123;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; getRetriever(context).get(context);  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;getretriever()&#34;&gt;getRetriever()&lt;a title=&#34;#getretriever()&#34; href=&#34;#getretriever()&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;RequestManagerRetriever,ç”¨äºåˆ›å»ºæ–°çš„RequestManageræˆ–ä»Activityå’ŒFragmentä¸­æ£€ç´¢ç°æœ‰çš„&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;static&lt;/span&gt; RequestManagerRetriever &lt;span class=&#34;title&#34;&gt;getRetriever&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;meta&#34;&gt;@Nullable&lt;/span&gt; Context context)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;comment&#34;&gt;// ç”±äºå…¶ä»–åŸå› ï¼Œä¸Šä¸‹æ–‡å¯èƒ½ä¸ºç©ºï¼ˆå³ç”¨æˆ·ä¼ å…¥ç©ºå€¼ï¼‰ï¼Œä½†å®é™…ä¸Šå®ƒåªä¼šç”±äº Fragment ç”Ÿå‘½å‘¨æœŸçš„é”™è¯¯è€Œå‘ç”Ÿã€‚&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  Preconditions.checkNotNull(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      context,&lt;span class=&#34;string&#34;&gt;&amp;quot;You cannot start a load on a not yet attached View or a Fragment where getActivity() &amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;          + &lt;span class=&#34;string&#34;&gt;&amp;quot;returns null (which usually occurs when getActivity() is called before the Fragment &amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;          + &lt;span class=&#34;string&#34;&gt;&amp;quot;is attached or after the Fragment is destroyed).&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;comment&#34;&gt;// è·å–RequestManagerRetriever&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; Glide.get(context).getRequestManagerRetriever();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;get()&#34;&gt;get()&lt;a title=&#34;#get()&#34; href=&#34;#get()&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;å•ä¾‹å®ç°Glideçš„åˆå§‹åŒ–&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&#34;highlight kotlin&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//åŒé‡æ£€æŸ¥é”å®šåœ¨è¿™é‡Œæ˜¯å®‰å…¨çš„&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; static Glide &lt;span class=&#34;keyword&#34;&gt;get&lt;/span&gt;(&lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; Context context) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (glide == &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// é€šè¿‡åå°„GeneratedAppGlideModuleImplå®ä¾‹åŒ–Glide&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    GeneratedAppGlideModule annotationGeneratedModule =&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        getAnnotationGeneratedGlideModules(context.getApplicationContext()); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    synchronized (Glide.&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (glide == &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        checkAndInitializeGlide(context, annotationGeneratedModule);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; glide;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;requestmanagerretriever.get()&#34;&gt;RequestManagerRetriever.get()&lt;a title=&#34;#requestmanagerretriever.get()&#34; href=&#34;#requestmanagerretriever.get()&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;åˆ›å»ºå¯¹åº”ç”Ÿå‘½å‘¨æœŸçš„RequestManager&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;é¦–å…ˆåˆ¤æ–­æ˜¯åœ¨å­çº¿ç¨‹,åˆ™æ‹¿ä¸€ä¸ªå…¨Contextç„¶ååœ¨å·¥å‚æ¨¡å¼åˆ›å»ºä¸‹RequestManager,æ‰€ä»¥æ¨èä¸è¦åœ¨å­çº¿ç¨‹æ‰§è¡Œæ­¤æ“ä½œ&lt;/li&gt;
&lt;li&gt;å¦‚ä¸ºFragmentActivity,åˆ™é€šè¿‡FragmentManager,åˆ›å»ºä¸€ä¸ªç©ºFragmentæ”¾è¿›å½“å‰&lt;code&gt;Fragment&lt;/code&gt;æˆ–è€…&lt;code&gt;Activity&lt;/code&gt;,è¿™æ ·å°±å¯ä»¥æ„ŸçŸ¥å®¿ä¸»çš„ç”Ÿå‘½å‘¨æœŸ,ç„¶ååœ¨å·¥å‚æ¨¡å¼åˆ›å»ºä¸‹RequestManager&lt;/li&gt;
&lt;li&gt;å¦‚ä¸ºActivityâ€¦&lt;/li&gt;
&lt;li&gt;å¦‚ä¸ºContextWrapperâ€¦&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; RequestManager &lt;span class=&#34;title&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; Activity activity)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (Util.isOnBackgroundThread()) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; get(activity.getApplicationContext());&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (activity &lt;span class=&#34;keyword&#34;&gt;instanceof&lt;/span&gt; FragmentActivity) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; get((FragmentActivity) activity);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    assertNotDestroyed(activity);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    frameWaiter.registerSelf(activity);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    android.app.FragmentManager fm = activity.getFragmentManager();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; fragmentGet(activity, fm, &lt;span class=&#34;comment&#34;&gt;/*parentHint=*/&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;, isActivityVisible(activity));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// FragmentActivity Simple &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; RequestManager &lt;span class=&#34;title&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; FragmentActivity activity)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (Util.isOnBackgroundThread()) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; get(activity.getApplicationContext());&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    assertNotDestroyed(activity);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    frameWaiter.registerSelf(activity);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    FragmentManager fm = activity.getSupportFragmentManager();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; supportFragmentGet(activity, fm, &lt;span class=&#34;comment&#34;&gt;/*parentHint=*/&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;, isActivityVisible(activity));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// é€šè¿‡supportFragmentæ„ŸçŸ¥åˆ›å»º&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; RequestManager &lt;span class=&#34;title&#34;&gt;supportFragmentGet&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; Context context,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; FragmentManager fm,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Nullable&lt;/span&gt; Fragment parentHint,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; isParentVisible)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  SupportRequestManagerFragment current = getSupportRequestManagerFragment(fm, parentHint);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  RequestManager requestManager = current.getRequestManager();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (requestManager == &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// å·¥å‚æ¨¡å¼åˆ›å»º&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    Glide glide = Glide.get(context);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    requestManager =&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        factory.build(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            glide, current.getGlideLifecycle(), current.getRequestManagerTreeNode(), context);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// è¿™æ˜¯ä¸€ä¸ªå°æŠ€å·§ï¼Œæˆ‘ä»¬å°†å¯åŠ¨ RequestManagerï¼Œè€Œä¸æ˜¯ç›¸åº”çš„ Lifecycleã€‚å¯åŠ¨ RequestManager æ˜¯å®‰å…¨çš„ï¼Œä½†å¯åŠ¨ Lifecycle å¯èƒ½ä¼šå¼•å‘å†…å­˜æ³„æ¼&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (isParentVisible) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      requestManager.onStart();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    current.setRequestManager(requestManager);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; requestManager;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;load()&#34;&gt;load()&lt;a title=&#34;#load()&#34; href=&#34;#load()&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;å¯¹å…¨å±€å˜é‡èµ‹å€¼,æ„å»ºReqeustBuilder&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// Drawable Simple&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; RequestBuilder&amp;lt;Drawable&amp;gt; &lt;span class=&#34;title&#34;&gt;load&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;meta&#34;&gt;@Nullable&lt;/span&gt; Drawable drawable)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; asDrawable().load(drawable);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;into()&#34;&gt;into()&lt;a title=&#34;#into()&#34; href=&#34;#into()&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;è®¾ç½®èµ„æºåˆ°åŠ è½½çš„ImageViewä¸­ ï¼Œå–æ¶ˆä»»ä½•ç°æœ‰çš„åŠ è½½ï¼Œå¹¶é‡Šæ”¾ Glide ä¹‹å‰å¯èƒ½åŠ è½½åˆ°ImageViewçš„ä»»ä½•èµ„æºï¼Œä»¥ä¾¿å®ƒä»¬å¯ä»¥è¢«é‡ç”¨&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// è®¾ç½®èµ„æºé…ç½®åˆ°TargetView&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; ViewTarget&amp;lt;ImageView, TranscodeType&amp;gt; &lt;span class=&#34;title&#34;&gt;into&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; ImageView view)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    Util.assertMainThread();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    Â·Â·Â·&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; into(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        glideContext.buildImageViewTarget(view, transcodeClass),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;/*targetListener=*/&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        requestOptions,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        Executors.mainThreadExecutor());&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// åˆ›å»ºTargetView&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &amp;lt;X&amp;gt; &lt;span class=&#34;function&#34;&gt;ViewTarget&amp;lt;ImageView, X&amp;gt; &lt;span class=&#34;title&#34;&gt;buildImageViewTarget&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;      &lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; ImageView imageView, &lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; Class&amp;lt;X&amp;gt; transcodeClass)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; imageViewTargetFactory.buildTarget(imageView, transcodeClass);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// è´Ÿè´£ä¸ºæŒ‡å®šçš„android.view.Viewå­ç±»ç”Ÿæˆæ­£ç¡®ç±»å‹çš„Targetå·¥å‚&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;ImageViewTargetFactory&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;meta&#34;&gt;@SuppressWarnings(&amp;quot;unchecked&amp;quot;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &amp;lt;Z&amp;gt; &lt;span class=&#34;function&#34;&gt;ViewTarget&amp;lt;ImageView, Z&amp;gt; &lt;span class=&#34;title&#34;&gt;buildTarget&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;      &lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; ImageView view, &lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; Class&amp;lt;Z&amp;gt; clazz)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (Bitmap.class.equals(clazz)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; (ViewTarget&amp;lt;ImageView, Z&amp;gt;) &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; BitmapImageViewTarget(view);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (Drawable.class.isAssignableFrom(clazz)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; (ViewTarget&amp;lt;ImageView, Z&amp;gt;) &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; DrawableImageViewTarget(view);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;throw&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; IllegalArgumentException(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;          &lt;span class=&#34;string&#34;&gt;&amp;quot;Unhandled class: &amp;quot;&lt;/span&gt; + clazz + &lt;span class=&#34;string&#34;&gt;&amp;quot;, try .as*(Class).transcode(ResourceTranscoder)&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;into()-1&#34;&gt;into()&lt;a title=&#34;#into()-1&#34; href=&#34;#into()-1&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;æ ¸å¿ƒä»£ç åŠ è½½ä»£ç ï¼Œçœ‹èµ·æ¥ç®€å•ä½†å®ç°èµ·æ¥å¤æ‚ã€‚&lt;br&gt;
é¦–å…ˆçœ‹çœ‹ buildRequest å¦‚ä½•åˆå§‹åŒ– request&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &amp;lt;Y extends Target&amp;lt;TranscodeType&amp;gt;&amp;gt; &lt;span class=&#34;function&#34;&gt;Y &lt;span class=&#34;title&#34;&gt;into&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; Y target, &lt;span class=&#34;meta&#34;&gt;@Nullable&lt;/span&gt; RequestListener&amp;lt;TranscodeType&amp;gt; targetListener, BaseRequestOptions&amp;lt;?&amp;gt; options, Executor callbackExecutor)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  Preconditions.checkNotNull(target);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!isModelSet) &amp;#123; &lt;span class=&#34;keyword&#34;&gt;throw&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; IllegalArgumentException(&lt;span class=&#34;string&#34;&gt;&amp;quot;You must call #load() before calling #into()&amp;quot;&lt;/span&gt;); &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;comment&#34;&gt;// ç°åœ¨çš„è¯·æ±‚&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  Request request = buildRequest(target, targetListener, options, callbackExecutor);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;comment&#34;&gt;// ä¹‹å‰çš„è¯·æ±‚&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  Request previous = target.getRequest();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;comment&#34;&gt;// å¦‚æœä¹‹å‰çš„è¯·æ±‚å®Œæˆï¼Œé‡æ–°å¼€å§‹ä»¥é‡æ–°ä¼ é€’ç»“æœï¼Œè§¦å‘ RequestListeners å’Œ Targetsã€‚å¦‚æœè¯·æ±‚å¤±è´¥ï¼Œå°†é‡æ–°è¯·æ±‚ï¼Œ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (request.isEquivalentTo(previous) &amp;amp;&amp;amp; !isSkipMemoryCacheWithCompletePreviousRequest(options, previous)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// å¦‚æœä¹‹å‰çš„è¯·æ±‚å·²ç»åœ¨è¿è¡Œï¼Œæˆ‘ä»¬å¯ä»¥è®©å®ƒç»§ç»­è¿è¡Œè€Œä¸ä¸­æ–­&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!Preconditions.checkNotNull(previous).isRunning()) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;comment&#34;&gt;// ä½¿ç”¨å…ˆå‰çš„è¯·æ±‚è€Œä¸æ˜¯æ–°çš„è¯·æ±‚æ¥ä¼˜åŒ–ï¼Œä¾‹å¦‚è·³è¿‡è®¾ç½®å ä½ç¬¦ã€è·Ÿè¸ªå’Œå–æ¶ˆè·Ÿè¸ªç›®æ ‡ä»¥åŠè·å–åœ¨å•ä¸ªè¯·æ±‚ä¸­å®Œæˆçš„è§†å›¾ç»´åº¦&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      previous.begin();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; target;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  requestManager.clear(target);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  target.setRequest(request);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  requestManager.track(target, request);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; target;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;requestbuilder.buildrequest()&#34;&gt;RequestBuilder.buildRequest()&lt;a title=&#34;#requestbuilder.buildrequest()&#34; href=&#34;#requestbuilder.buildrequest()&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;æ ¹æ®å­˜åœ¨çš„åœºæ™¯å»ºç«‹ä¸åŒRequest&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; Request &lt;span class=&#34;title&#34;&gt;buildRequest&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(Target&amp;lt;TranscodeType&amp;gt; target, &lt;span class=&#34;meta&#34;&gt;@Nullable&lt;/span&gt; RequestListener&amp;lt;TranscodeType&amp;gt; targetListener, BaseRequestOptions&amp;lt;?&amp;gt; requestOptions, Executor callbackExecutor)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; buildRequestRecursive(&lt;span class=&#34;comment&#34;&gt;/*requestLock=*/&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; Object(), target, targetListener,&lt;span class=&#34;comment&#34;&gt;/*parentCoordinator=*/&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;, transitionOptions, requestOptions.getPriority(), requestOptions.getOverrideWidth(), requestOptions.getOverrideHeight(), requestOptions, callbackExecutor);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; Request &lt;span class=&#34;title&#34;&gt;buildRequestRecursive&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(Object requestLock, Target&amp;lt;TranscodeType&amp;gt; target, &lt;span class=&#34;meta&#34;&gt;@Nullable&lt;/span&gt; RequestListener&amp;lt;TranscodeType&amp;gt; targetListener, &lt;span class=&#34;meta&#34;&gt;@Nullable&lt;/span&gt; RequestCoordinator parentCoordinator, TransitionOptions&amp;lt;?, ? &lt;span class=&#34;keyword&#34;&gt;super&lt;/span&gt; TranscodeType&amp;gt; transitionOptions, Priority priority, &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; overrideWidth, &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; overrideHeight, BaseRequestOptions&amp;lt;?&amp;gt; requestOptions, Executor callbackExecutor)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;comment&#34;&gt;// å¦‚æœ‰å¿…è¦é¦–å…ˆæ„å»º ErrorRequestCoordinatorï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥æ›´æ–° parentCoordinatorã€‚&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  ErrorRequestCoordinator errorRequestCoordinator = &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (errorBuilder != &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    errorRequestCoordinator = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; ErrorRequestCoordinator(requestLock, parentCoordinator);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    parentCoordinator = errorRequestCoordinator;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  Request mainRequest = buildThumbnailRequestRecursive(requestLock, target, targetListener, parentCoordinator, transitionOptions, priority, overrideWidth, overrideHeight, requestOptions, callbackExecutor);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (errorRequestCoordinator == &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;) &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; mainRequest;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; errorOverrideWidth = errorBuilder.getOverrideWidth();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; errorOverrideHeight = errorBuilder.getOverrideHeight();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (Util.isValidDimensions(overrideWidth, overrideHeight) &amp;amp;&amp;amp; !errorBuilder.isValidOverride()) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    errorOverrideWidth = requestOptions.getOverrideWidth();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    errorOverrideHeight = requestOptions.getOverrideHeight();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  Request errorRequest = errorBuilder.buildRequestRecursive(requestLock, target, targetListener, errorRequestCoordinator, errorBuilder.transitionOptions, errorBuilder.getPriority(), errorOverrideWidth, errorOverrideHeight, errorBuilder, callbackExecutor);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  errorRequestCoordinator.setRequests(mainRequest, errorRequest);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; errorRequestCoordinator;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;requestbuilder.buildthumbnailrequestrecursive()&#34;&gt;RequestBuilder.buildThumbnailRequestRecursive()&lt;a title=&#34;#requestbuilder.buildthumbnailrequestrecursive()&#34; href=&#34;#requestbuilder.buildthumbnailrequestrecursive()&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;æ ¹æ®æ˜¯å¦éœ€è¦ç¼©ç•¥å›¾,ç”Ÿæˆå„ç§ä¸åŒçš„Request&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™é‡Œç»è¿‡ä¸€å±‚åˆä¸€å±‚æœ€ç»ˆæ‹¿åˆ°ä¸€ä¸ª&lt;code&gt;SingleRequest&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; Request &lt;span class=&#34;title&#34;&gt;buildThumbnailRequestRecursive&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(Object requestLock, Target&amp;lt;TranscodeType&amp;gt; target, RequestListener&amp;lt;TranscodeType&amp;gt; targetListener, &lt;span class=&#34;meta&#34;&gt;@Nullable&lt;/span&gt; RequestCoordinator parentCoordinator, TransitionOptions&amp;lt;?, ? &lt;span class=&#34;keyword&#34;&gt;super&lt;/span&gt; TranscodeType&amp;gt; transitionOptions, Priority priority, &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; overrideWidth, &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; overrideHeight, BaseRequestOptions&amp;lt;?&amp;gt; requestOptions, Executor callbackExecutor)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (thumbnailBuilder != &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// é€’å½’æ¡ˆä¾‹ï¼šåŒ…å«ä¸€ä¸ªæ½œåœ¨çš„é€’å½’ç¼©ç•¥å›¾Request Builder&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (isThumbnailBuilt) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;throw&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; IllegalStateException(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;          &lt;span class=&#34;string&#34;&gt;&amp;quot;You cannot use a request as both the main request and a &amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;              + &lt;span class=&#34;string&#34;&gt;&amp;quot;thumbnail, consider using clone() on the request(s) passed to thumbnail()&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    TransitionOptions&amp;lt;?, ? &lt;span class=&#34;keyword&#34;&gt;super&lt;/span&gt; TranscodeType&amp;gt; thumbTransitionOptions = thumbnailBuilder.transitionOptions;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// é»˜è®¤æƒ…å†µä¸‹æˆ‘ä»¬çš„å°†è¿‡æ¸¡ç”¨åœ¨ç¼©ç•¥å›¾ï¼Œä½†é¿å…è¦†ç›–å¯èƒ½å·²æ˜ç¡®åº”ç”¨äºç¼©ç•¥å›¾è¯·æ±‚çš„è‡ªå®šä¹‰é€‰é¡¹ã€‚&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (thumbnailBuilder.isDefaultTransitionOptionsSet) thumbTransitionOptions = transitionOptions;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    Priority thumbPriority = thumbnailBuilder.isPrioritySet() ? thumbnailBuilder.getPriority() : getThumbnailPriority(priority);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; thumbOverrideWidth = thumbnailBuilder.getOverrideWidth();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; thumbOverrideHeight = thumbnailBuilder.getOverrideHeight();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (Util.isValidDimensions(overrideWidth, overrideHeight) &amp;amp;&amp;amp; !thumbnailBuilder.isValidOverride()) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      thumbOverrideWidth = requestOptions.getOverrideWidth();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      thumbOverrideHeight = requestOptions.getOverrideHeight();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ThumbnailRequestCoordinator coordinator = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; ThumbnailRequestCoordinator(requestLock, parentCoordinator);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    Request fullRequest = obtainRequest(requestLock, target, targetListener, requestOptions, coordinator, transitionOptions, priority, overrideWidth, overrideHeight, callbackExecutor);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    isThumbnailBuilt = &lt;span class=&#34;keyword&#34;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// é€’å½’ç”Ÿæˆç¼©ç•¥å›¾è¯·æ±‚&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    Request thumbRequest = thumbnailBuilder.buildRequestRecursive(requestLock, target,targetListener, coordinator, thumbTransitionOptions, thumbPriority, thumbOverrideWidth, thumbOverrideHeight, thumbnailBuilder, callbackExecutor);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    isThumbnailBuilt = &lt;span class=&#34;keyword&#34;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    coordinator.setRequests(fullRequest, thumbRequest);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; coordinator;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (thumbSizeMultiplier != &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// åŸºæœ¬æƒ…å†µï¼šç¼©ç•¥å›¾Multiplierç”Ÿæˆç¼©ç•¥å›¾è¯·æ±‚ï¼Œä½†ä¸èƒ½é€’å½’ã€‚&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ThumbnailRequestCoordinator coordinator = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; ThumbnailRequestCoordinator(requestLock, parentCoordinator);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    Request fullRequest = obtainRequest(requestLock, target, targetListener, requestOptions, coordinator, transitionOptions, priority, overrideWidth, overrideHeight, callbackExecutor);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    BaseRequestOptions&amp;lt;?&amp;gt; thumbnailOptions = requestOptions.clone().sizeMultiplier(thumbSizeMultiplier);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    Request thumbnailRequest = obtainRequest(requestLock, target, targetListener, thumbnailOptions, coordinator, transitionOptions, getThumbnailPriority(priority), overrideWidth, overrideHeight, callbackExecutor);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    coordinator.setRequests(fullRequest, thumbnailRequest);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; coordinator;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// åŸºæœ¬æƒ…å†µï¼šæ²¡æœ‰ç¼©ç•¥å›¾&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; obtainRequest(requestLock, target, targetListener, requestOptions, parentCoordinator, transitionOptions, priority, overrideWidth, overrideHeight, callbackExecutor);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; Request &lt;span class=&#34;title&#34;&gt;obtainRequest&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(Object requestLock, Target&amp;lt;TranscodeType&amp;gt; target, RequestListener&amp;lt;TranscodeType&amp;gt; targetListener, BaseRequestOptions&amp;lt;?&amp;gt; requestOptions, RequestCoordinator requestCoordinator, TransitionOptions&amp;lt;?, ? &lt;span class=&#34;keyword&#34;&gt;super&lt;/span&gt; TranscodeType&amp;gt; transitionOptions, Priority priority, &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; overrideWidth, &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; overrideHeight, Executor callbackExecutor)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; SingleRequest.obtain(context, glideContext, requestLock, model, transcodeClass, requestOptions, overrideWidth, overrideHeight, priority, target, targetListener, requestListeners, requestCoordinator, glideContext.getEngine(), transitionOptions.getTransitionFactory(), callbackExecutor);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;requestmanager.track()&#34;&gt;RequestManager.track()&lt;a title=&#34;#requestmanager.track()&#34; href=&#34;#requestmanager.track()&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;è¿™é‡ŒGlideå°†åˆ¤æ–­è¯·æ±‚æ˜¯å¦éœ€è¦æ˜¾ç¤ºï¼Œå¦‚æœå®ƒéœ€è¦ç°åœ¨æ˜¾ç¤ºåˆ™å¼€å§‹æ‰§è¡Œï¼Œå¦åˆ™clear( )ï¼Œå¹¶å°†è¯·æ±‚æ”¾å…¥é˜Ÿåˆ—ã€‚è¿™ç§è®¾è®¡æ›´ç²¾å·§ï¼Œçœç”µ&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;synchronized&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;track&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; Target&amp;lt;?&amp;gt; target, &lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; Request request)&lt;/span&gt; &lt;/span&gt;&amp;#123;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  targetTracker.track(target);  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  requestTracker.runRequest(request);  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;/** å¼€å§‹è·Ÿè¸ªç»™å®šçš„è¯·æ±‚ */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;runRequest&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; Request request)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  requests.add(request);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!isPaused) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// å¯åŠ¨å¼‚æ­¥åŠ è½½&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    request.begin();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// é˜²æ­¢ä»ä»¥å‰çš„è¯·æ±‚åŠ è½½ä»»ä½•ä½å›¾ï¼Œé‡Šæ”¾æ­¤è¯·æ±‚æŒæœ‰çš„ä»»ä½•èµ„æºï¼Œæ˜¾ç¤ºå½“å‰å ä½ç¬¦ï¼ˆå¦‚æœæä¾›ï¼‰ï¼Œå¹¶å°†è¯·æ±‚æ ‡è®°ä¸ºå·²å–æ¶ˆ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    request.clear();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    pendingRequests.add(request);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;singlerequest.begin()&#34;&gt;SingleRequest.begin()&lt;a title=&#34;#singlerequest.begin()&#34; href=&#34;#singlerequest.begin()&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;begin&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;synchronized&lt;/span&gt; (requestLock) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    assertNotCallingCallbacks();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    stateVerifier.throwIfRecycled();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    startTime = LogTime.getLogTime();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (model == &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (Util.isValidDimensions(overrideWidth, overrideHeight)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        width = overrideWidth;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        height = overrideHeight;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;comment&#34;&gt;// å¦‚æœç”¨æˆ·è®¾ç½®å¯å›è°ƒçš„Drawables,è¿™é‡Œè¿›è¡Œæ—¥å¿—åé¦ˆ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; logLevel = getFallbackDrawable() == &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt; ? Log.WARN : Log.DEBUG;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      onLoadFailed(&lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; GlideException(&lt;span class=&#34;string&#34;&gt;&amp;quot;Received null model&amp;quot;&lt;/span&gt;), logLevel);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (status == Status.RUNNING) &lt;span class=&#34;keyword&#34;&gt;throw&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; IllegalArgumentException(&lt;span class=&#34;string&#34;&gt;&amp;quot;Cannot restart a running request&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// å¦‚æœæˆ‘ä»¬åœ¨å®Œæˆåé‡æ–°å¯åŠ¨(é€šå¸¸æ˜¯é€šè¿‡notifyDataSetChangedä¹‹ç±»çš„æ–¹å¼ï¼Œå‘ç›¸åŒçš„ç›®æ ‡æˆ–è§†å›¾å¯åŠ¨ç›¸åŒçš„è¯·æ±‚)ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°ä½¿ç”¨ä¸Šæ¬¡æ£€ç´¢åˆ°çš„èµ„æºå’Œå¤§å°ï¼Œè€Œè·³è¿‡è·å–ä¸€ä¸ªæ–°çš„å¤§å°ï¼Œå¼€å§‹ä¸€ä¸ªæ–°çš„åŠ è½½ç­‰(è¿™æ„å‘³ç€å¸Œæœ›é‡æ–°å¯åŠ¨åŠ è½½çš„ç”¨æˆ·éœ€è¦åœ¨å¼€å§‹æ–°çš„åŠ è½½ä¹‹å‰æ˜¾å¼åœ°æ¸…é™¤viewæˆ–Targetï¼Œå› ä¸ºä»–ä»¬è§‰å¾—è§†å›¾å¤§å°å·²ç»æ”¹å˜ã€‚)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (status == Status.COMPLETE) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      onResourceReady(resource, DataSource.MEMORY_CACHE, &lt;span class=&#34;comment&#34;&gt;/* isLoadedFromAlternateCacheKey= */&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;false&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// å¯¹äºæ—¢æœªå®Œæˆä¹Ÿæœªè¿è¡Œçš„è¯·æ±‚ï¼Œé‡æ–°å¯åŠ¨å¯ä»¥è¢«è§†ä¸ºæ–°è¯·æ±‚ï¼Œå¹¶å¯ä»¥ä»å¤´å¼€å§‹è¿è¡Œ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    cookie = GlideTrace.beginSectionAsync(TAG);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    status = Status.WAITING_FOR_SIZE;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// å¦‚æœå®½é«˜å·²æŒ‡å®š,åˆ™å›è°ƒonSizeReady ,å¦åˆ™å†è·å–å®½é«˜&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (Util.isValidDimensions(overrideWidth, overrideHeight)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      onSizeReady(overrideWidth, overrideHeight);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      target.getSize(&lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; ((status == Status.RUNNING || status == Status.WAITING_FOR_SIZE) &amp;amp;&amp;amp; canNotifyStatusChanged()) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      target.onLoadStarted(getPlaceholderDrawable());&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;onLoadFailed : å›¾ç‰‡æˆ–è€…èµ„æºä¸ºç©º,æŠ¥é”™å›è°ƒ&lt;/li&gt;
&lt;li&gt;onResourceReady: æœ€ç»ˆé€šè¿‡&lt;code&gt;Engine.release( )&lt;/code&gt;,é‡Šæ”¾èµ„æº&lt;/li&gt;
&lt;li&gt;onSizeReady: Viewå¤§å°å·²æ˜ç¡® , æ‰§è¡Œ&lt;code&gt;Engine.load()&lt;/code&gt;åŠ è½½èµ„æº&lt;/li&gt;
&lt;li&gt;getSize: è·å–Viewå¤§å°&lt;/li&gt;
&lt;li&gt;onLoadStarted: ç­‰å¾…æˆ–è¿è¡Œä¸­,å ä½å›¾å¤„ç†&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;singlerequest.onsizeready(-)&#34;&gt;SingleRequest.onSizeReady( )&lt;a title=&#34;#singlerequest.onsizeready(-)&#34; href=&#34;#singlerequest.onsizeready(-)&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;å¯åŠ¨ç»™å®šå‚æ•°è¿›è¡Œå›¾ç‰‡çš„åŠ è½½, å¿…é¡»åœ¨ä¸»çº¿ç¨‹ä¸Šè°ƒç”¨&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;onSizeReady&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; width, &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; height)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  stateVerifier.throwIfRecycled();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;synchronized&lt;/span&gt; (requestLock) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (status != Status.WAITING_FOR_SIZE) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    status = Status.RUNNING;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;float&lt;/span&gt; sizeMultiplier = requestOptions.getSizeMultiplier();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;.width = maybeApplySizeMultiplier(width, sizeMultiplier);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;.height = maybeApplySizeMultiplier(height, sizeMultiplier);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    loadStatus = engine.load(glideContext, model, requestOptions.getSignature(), &lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;.width, &lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;.height, requestOptions.getResourceClass(), transcodeClass, priority, requestOptions.getDiskCacheStrategy(), requestOptions.getTransformations(), requestOptions.isTransformationRequired(), requestOptions.isScaleOnlyOrNoTransform(), requestOptions.getOptions(), requestOptions.isMemoryCacheable(), requestOptions.getUseUnlimitedSourceGeneratorsPool(), requestOptions.getUseAnimationPool(), requestOptions.getOnlyRetrieveFromCache(), &lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;, callbackExecutor);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;engine.load(-)&#34;&gt;Engine.load( )&lt;a title=&#34;#engine.load(-)&#34; href=&#34;#engine.load(-)&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;åˆ°è¿™é‡Œæƒ³éƒ½ä¸ç”¨æƒ³äº†,Engineæ‰æ˜¯çœŸæ­£åŠ è½½å›¾ç‰‡çš„Class,&lt;br&gt;
Engineè´Ÿè´£æ‰§è¡Œå›¾ç‰‡åŠ è½½å’Œç®¡ç†æ´»åŠ¨èµ„æºå’Œç¼“å­˜èµ„æºã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ´»åŠ¨èµ„æºæ˜¯æŒ‡é‚£äº›è‡³å°‘æä¾›ä¸€ä¸ªè¯·æ±‚ä½†æœªé‡Šæ”¾çš„èµ„æºã€‚ä¸€æ—¦èµ„æºçš„æ‰€æœ‰ä½¿ç”¨è€…éƒ½é‡Šæ”¾äº†è¯¥èµ„æºï¼Œè¯¥èµ„æºå°±ä¼šè¿›å…¥ç¼“å­˜ã€‚å¦‚æœèµ„æºä»ç¼“å­˜ä¸­è¿”å›ç»™æ–°çš„ä½¿ç”¨è€…ï¼Œå®ƒå°†è¢«é‡æ–°æ·»åŠ åˆ°æ´»åŠ¨èµ„æºä¸­ã€‚&lt;br&gt;
å¦‚æœä»ç¼“å­˜ä¸­ç§»é™¤èµ„æºï¼Œå®ƒçš„èµ„æºå°†è¢«å›æ”¶å’Œé‡ç”¨(å¦‚æœå¯èƒ½çš„è¯)ï¼Œèµ„æºå°†è¢«ä¸¢å¼ƒã€‚æ²¡æœ‰ä¸¥æ ¼è¦æ±‚æ¶ˆè´¹è€…é‡Šæ”¾ä»–ä»¬çš„èµ„æºï¼Œæ‰€ä»¥æ´»è·ƒçš„èµ„æºè¢«å¼±æŒæœ‰ã€‚&lt;/p&gt;
&lt;p&gt;è¯·æ±‚æµç¨‹:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ£€æŸ¥å½“å‰ä½¿ç”¨çš„èµ„æºé›†ï¼Œè¿”å›æ´»åŠ¨èµ„æºï¼ˆå¦‚æœå­˜åœ¨ï¼‰ï¼Œå¹¶å°†ä»»ä½•æ–°çš„éæ´»åŠ¨èµ„æºç§»åŠ¨åˆ°å†…å­˜ç¼“å­˜ä¸­&lt;/li&gt;
&lt;li&gt;æ£€æŸ¥å†…å­˜ç¼“å­˜å¹¶æä¾›ç¼“å­˜èµ„æºï¼ˆå¦‚æœå­˜åœ¨ï¼‰&lt;/li&gt;
&lt;li&gt;æ£€æŸ¥å½“å‰çš„ä¸€ç»„æ­£åœ¨è¿›è¡Œçš„åŠ è½½å¹¶å°† cb æ·»åŠ åˆ°è¿›è¡Œä¸­çš„åŠ è½½ï¼ˆå¦‚æœå­˜åœ¨ï¼‰&lt;/li&gt;
&lt;li&gt;å¼€å§‹åŠ è½½&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &amp;lt;R&amp;gt; &lt;span class=&#34;function&#34;&gt;LoadStatus &lt;span class=&#34;title&#34;&gt;load&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(GlideContext glideContext, Object model, Key signature, &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; width, &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; height, Class&amp;lt;?&amp;gt; resourceClass, Class&amp;lt;R&amp;gt; transcodeClass, Priority priority, DiskCacheStrategy diskCacheStrategy, Map&amp;lt;Class&amp;lt;?&amp;gt;, Transformation&amp;lt;?&amp;gt;&amp;gt; transformations, &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; isTransformationRequired, &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; isScaleOnlyOrNoTransform, Options options, &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; isMemoryCacheable, &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; useUnlimitedSourceExecutorPool, &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; useAnimationPool, &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; onlyRetrieveFromCache, ResourceCallback cb, Executor callbackExecutor)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;long&lt;/span&gt; startTime = VERBOSE_IS_LOGGABLE ? LogTime.getLogTime() : &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  EngineKey key = keyFactory.buildKey(model, signature, width, height, transformations,resourceClass, transcodeClass, options);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  EngineResource&amp;lt;?&amp;gt; memoryResource;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;synchronized&lt;/span&gt; (&lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    memoryResource = loadFromMemory(key, isMemoryCacheable, startTime);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// åˆ¤æ–­æ˜¯å¦æœ‰ç¼“å­˜,æœ‰åˆ™ç›´æ¥åŠ è½½&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (memoryResource == &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; waitForExistingOrStartNewJob(glideContext, model, signature, width, height, resourceClass, transcodeClass, priority, diskCacheStrategy, transformations, isTransformationRequired, isScaleOnlyOrNoTransform, options, isMemoryCacheable, useUnlimitedSourceExecutorPool, useAnimationPool, onlyRetrieveFromCache, cb, callbackExecutor, key, startTime);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;comment&#34;&gt;// é¿å…åœ¨ä¿æŒEngineé”æ—¶å›è°ƒï¼Œå› ä¸ºè¿™æ ·åšä¼šæ›´å®¹æ˜“æ­»é”&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  cb.onResourceReady(memoryResource, DataSource.MEMORY_CACHE, &lt;span class=&#34;comment&#34;&gt;/* isLoadedFromAlternateCacheKey= */&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;false&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;engine.waitforexistingorstartnewjob(-)&#34;&gt;Engine.waitForExistingOrStartNewJob( )&lt;a title=&#34;#engine.waitforexistingorstartnewjob(-)&#34; href=&#34;#engine.waitforexistingorstartnewjob(-)&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;ç­‰å¾…æˆ–è€…æ‰§è¡Œä»»åŠ¡&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &amp;lt;R&amp;gt; &lt;span class=&#34;function&#34;&gt;LoadStatus &lt;span class=&#34;title&#34;&gt;waitForExistingOrStartNewJob&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(GlideContext glideContext, Object model, Key signature, &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; width, &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; height, Class&amp;lt;?&amp;gt; resourceClass, Class&amp;lt;R&amp;gt; transcodeClass, Priority priority, DiskCacheStrategy diskCacheStrategy, Map&amp;lt;Class&amp;lt;?&amp;gt;, Transformation&amp;lt;?&amp;gt;&amp;gt; transformations, &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; isTransformationRequired, &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; isScaleOnlyOrNoTransform, Options options, &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; isMemoryCacheable, &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; useUnlimitedSourceExecutorPool, &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; useAnimationPool, &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; onlyRetrieveFromCache, ResourceCallback cb, Executor callbackExecutor, EngineKey key, &lt;span class=&#34;keyword&#34;&gt;long&lt;/span&gt; startTime)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  EngineJob&amp;lt;?&amp;gt; current = jobs.get(key, onlyRetrieveFromCache);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (current != &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    current.addCallback(cb, callbackExecutor);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; LoadStatus(cb, current);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  EngineJob&amp;lt;R&amp;gt; engineJob = engineJobFactory.build(key, isMemoryCacheable, useUnlimitedSourceExecutorPool, useAnimationPool, onlyRetrieveFromCache);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  DecodeJob&amp;lt;R&amp;gt; decodeJob = decodeJobFactory.build(glideContext, model, key, signature, width, height, resourceClass, transcodeClass, priority, diskCacheStrategy, transformations, isTransformationRequired, isScaleOnlyOrNoTransform, onlyRetrieveFromCache, options, engineJob);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  jobs.put(key, engineJob);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  engineJob.addCallback(cb, callbackExecutor);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  engineJob.start(decodeJob);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (VERBOSE_IS_LOGGABLE)  logWithTimeAndKey(&lt;span class=&#34;string&#34;&gt;&amp;quot;Started new load&amp;quot;&lt;/span&gt;, startTime, key);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; LoadStatus(cb, engineJob);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;decodejob&#34;&gt;DecodeJob&lt;a title=&#34;#decodejob&#34; href=&#34;#decodejob&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;è´Ÿè´£ä»ç¼“å­˜æ•°æ®æˆ–åŸå§‹æºä¸­è§£ç èµ„æºå¹¶åº”ç”¨è½¬æ¢å’Œè½¬ç çš„ç±»&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;run&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (isCancelled) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      notifyFailed();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    runWrapped();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;runWrapped&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;comment&#34;&gt;// ä¸ºäº†åˆ¤æ–­è¿è¡ŒåŸå› ,è¿™é‡Œåšäº†ä¸‰ä¸ªåˆ¤æ–­&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;switch&lt;/span&gt; (runReason) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;case&lt;/span&gt; INITIALIZE:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;comment&#34;&gt;// è·å–å½“å‰è§£ç æ•°æ®çš„é˜¶æ®µ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      stage = getNextStage(Stage.INITIALIZE);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;comment&#34;&gt;// è·å–æ•°æ®ç”Ÿæˆå™¨&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      currentGenerator = getNextGenerator();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      runGenerators();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;case&lt;/span&gt; SWITCH_TO_SOURCE_SERVICE:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      runGenerators();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;case&lt;/span&gt; DECODE_DATA:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      decodeFromRetrievedData();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;default&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;throw&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; IllegalStateException(&lt;span class=&#34;string&#34;&gt;&amp;quot;Unrecognized run reason: &amp;quot;&lt;/span&gt; + runReason);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h5 id=&#34;rungenerators(-)&#34;&gt;runGenerators( )&lt;a title=&#34;#rungenerators(-)&#34; href=&#34;#rungenerators(-)&#34;&gt;&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;currentGeneratorå®ç°DataFetcherGeneratoræ¥å£ï¼Œè¿™ä¸ªæ¥å£ä¸»è¦ç”¨æ¥ç”Ÿæˆä¸€ç³»åˆ—çš„modelLoaderå’Œmodel&lt;/p&gt;
&lt;p&gt;ç›®å‰Glideæœ‰ä¸‰ç§ç±»ç”Ÿæˆå™¨&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ResourceCacheGenerator&lt;/li&gt;
&lt;li&gt;DataCacheGenerator&lt;/li&gt;
&lt;li&gt;SourceGenerator&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;runGenerators&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  currentThread = Thread.currentThread();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  startFetchTime = LogTime.getLogTime();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; isStarted = &lt;span class=&#34;keyword&#34;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;comment&#34;&gt;// startNext -&amp;gt; å°è¯•å•ä¸ªæ–°çš„DataFetcherï¼Œå¦‚æœDataFetcherå·²å¯åŠ¨åˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›false&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;while&lt;/span&gt; (!isCancelled &amp;amp;&amp;amp; currentGenerator != &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; !(isStarted = currentGenerator.startNext())) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    stage = getNextStage(stage);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    currentGenerator = getNextGenerator();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (stage == Stage.SOURCE) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      reschedule();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;comment&#34;&gt;// We&amp;#x27;ve run out of stages and generators, give up.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; ((stage == Stage.FINISHED || isCancelled) &amp;amp;&amp;amp; !isStarted) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    notifyFailed();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; DataFetcherGenerator &lt;span class=&#34;title&#34;&gt;getNextGenerator&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;switch&lt;/span&gt; (stage) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;case&lt;/span&gt; RESOURCE_CACHE:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; ResourceCacheGenerator(decodeHelper, &lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;case&lt;/span&gt; DATA_CACHE:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; DataCacheGenerator(decodeHelper, &lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;case&lt;/span&gt; SOURCE:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; SourceGenerator(decodeHelper, &lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;case&lt;/span&gt; FINISHED:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;default&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;throw&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; IllegalStateException(&lt;span class=&#34;string&#34;&gt;&amp;quot;Unrecognized stage: &amp;quot;&lt;/span&gt; + stage);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h6 id=&#34;sourcegenerator.startnext()&#34;&gt;SourceGenerator.startNext()&lt;a title=&#34;#sourcegenerator.startnext()&#34; href=&#34;#sourcegenerator.startnext()&#34;&gt;&lt;/a&gt;&lt;/h6&gt;
&lt;p&gt;å°†é¦–å…ˆåˆ¤æ–­ï¼Œç¼“å­˜å¦‚æœå®ƒä¸æ˜¯ç©ºçš„ï¼Œè°ƒç”¨ cacheData; å¦åˆ™ï¼Œè·å– loadDataï¼Œç„¶åæ‰§è¡Œ startNextLoad ()&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;startNext&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (dataToCache != &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    Object data = dataToCache;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    dataToCache = &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;try&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; isDataInCache = cacheData(data);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;comment&#34;&gt;// å¦‚æœæˆ‘ä»¬æ²¡æœ‰å°†æ•°æ®å†™å…¥ç¼“å­˜ï¼ŒcacheDataæ–¹æ³•å°†å°è¯•ç›´æ¥è§£ç åŸå§‹æ•°æ®ï¼Œè€Œä¸æ˜¯é€šè¿‡ç£ç›˜ç¼“å­˜ã€‚å› ä¸ºæ­¤æ—¶cacheDataå·²ç»è°ƒç”¨äº†æˆ‘ä»¬çš„å›è°ƒå‡½æ•°ï¼Œæ‰€ä»¥é™¤äº†è¿”å›ï¼Œæ²¡æœ‰å…¶ä»–äº‹æƒ…å¯åšäº†&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!isDataInCache) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;comment&#34;&gt;// å¦‚æœæˆ‘ä»¬èƒ½å¤ŸæˆåŠŸåœ°å°†æ•°æ®å†™å…¥ç¼“å­˜ï¼Œé‚£ä¹ˆç°åœ¨éœ€è¦ç»§ç»­è°ƒç”¨ä¸‹é¢çš„sourceCacheGeneratoræ¥ä»ç¼“å­˜åŠ è½½æ•°æ®&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;span class=&#34;keyword&#34;&gt;catch&lt;/span&gt; (IOException e) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;comment&#34;&gt;// IOExceptionæ„å‘³ç€æˆ‘ä»¬æ— æ³•å°†æ•°æ®å†™å…¥ç¼“å­˜ï¼Œæˆ–è€…åœ¨ç£ç›˜ç¼“å­˜å†™å…¥å¤±è´¥åæ— æ³•å€’å¸¦æ•°æ®ã€‚æ— è®ºå“ªç§æƒ…å†µï¼Œæˆ‘ä»¬éƒ½å¯ä»¥ç»§ç»­å°è¯•ä¸‹é¢çš„ä¸‹ä¸€ä¸ªå–å›&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (Log.isLoggable(TAG, Log.DEBUG)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        Log.d(TAG, &lt;span class=&#34;string&#34;&gt;&amp;quot;Failed to properly rewind or write data to cache&amp;quot;&lt;/span&gt;, e);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (sourceCacheGenerator != &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; sourceCacheGenerator.startNext()) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  sourceCacheGenerator = &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  loadData = &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; started = &lt;span class=&#34;keyword&#34;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;while&lt;/span&gt; (!started &amp;amp;&amp;amp; hasNextModelLoader()) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    loadData = helper.getLoadData().get(loadDataListIndex++);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (loadData != &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;amp;&amp;amp; (helper.getDiskCacheStrategy().isDataCacheable(loadData.fetcher.getDataSource())&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            || helper.hasLoadPath(loadData.fetcher.getDataClass()))) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      started = &lt;span class=&#34;keyword&#34;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      startNextLoad(loadData);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; started;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h6 id=&#34;sourcegenerator.cachedata&#34;&gt;SourceGenerator.cacheData&lt;a title=&#34;#sourcegenerator.cachedata&#34; href=&#34;#sourcegenerator.cachedata&#34;&gt;&lt;/a&gt;&lt;/h6&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;/**&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; * å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿç¼“å­˜æ•°æ®ï¼Œåº”è¯¥å°è¯•ç›´æ¥ä»ç¼“å­˜è§£ç æ•°æ®ï¼Œå¦‚æœæˆ‘ä»¬ä¸èƒ½ç¼“å­˜æ•°æ®ï¼Œåº”è¯¥å°è¯•ä»æºè§£ç ï¼Œåˆ™è¿”å›false&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;cacheData&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(Object dataToCache)&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;throws&lt;/span&gt; IOException &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; isLoadingFromSourceData = &lt;span class=&#34;keyword&#34;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;try&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    DataRewinder&amp;lt;Object&amp;gt; rewinder = helper.getRewinder(dataToCache);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    Object data = rewinder.rewindAndGet();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    Encoder&amp;lt;Object&amp;gt; encoder = helper.getSourceEncoder(data);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    DataCacheWriter&amp;lt;Object&amp;gt; writer = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; DataCacheWriter&amp;lt;&amp;gt;(encoder, data, helper.getOptions());&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    DataCacheKey newOriginalKey = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; DataCacheKey(loadData.sourceKey, helper.getSignature());&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    DiskCache diskCache = helper.getDiskCache();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    diskCache.put(newOriginalKey, writer);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (diskCache.get(newOriginalKey) != &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      originalKey = newOriginalKey;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      sourceCacheGenerator = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; DataCacheGenerator(Collections.singletonList(loadData.sourceKey), helper, &lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;comment&#34;&gt;// æˆ‘ä»¬èƒ½å¤Ÿå°†æ•°æ®å†™å…¥ç¼“å­˜&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      isLoadingFromSourceData = &lt;span class=&#34;keyword&#34;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      cb.onDataFetcherReady(loadData.sourceKey, rewinder.rewindAndGet(), loadData.fetcher, loadData.fetcher.getDataSource(), loadData.sourceKey);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// å†™å…¥æ•°æ®åˆ°ç¼“å­˜å¤±è´¥çš„å¤„ç†&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125; &lt;span class=&#34;keyword&#34;&gt;finally&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!isLoadingFromSourceData) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      loadData.fetcher.cleanup();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h6 id=&#34;decodehelper.getsourceencoder()&#34;&gt;DecodeHelper.getSourceEncoder()&lt;a title=&#34;#decodehelper.getsourceencoder()&#34; href=&#34;#decodehelper.getsourceencoder()&#34;&gt;&lt;/a&gt;&lt;/h6&gt;
&lt;p&gt;DecodeHelper.java&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&amp;lt;X&amp;gt; &lt;span class=&#34;function&#34;&gt;Encoder&amp;lt;X&amp;gt; &lt;span class=&#34;title&#34;&gt;getSourceEncoder&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(X data)&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;throws&lt;/span&gt; Registry.NoSourceEncoderAvailableException &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; glideContext.getRegistry().getSourceEncoder(data);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Registry.java&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &amp;lt;X&amp;gt; &lt;span class=&#34;function&#34;&gt;Encoder&amp;lt;X&amp;gt; &lt;span class=&#34;title&#34;&gt;getSourceEncoder&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;meta&#34;&gt;@NonNull&lt;/span&gt; X data)&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;throws&lt;/span&gt; NoSourceEncoderAvailableException &lt;/span&gt;&amp;#123;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  Encoder&amp;lt;X&amp;gt; encoder = encoderRegistry.getEncoder((Class&amp;lt;X&amp;gt;) data.getClass());  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(encoder != &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;) &amp;#123;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; encoder;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;throw&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; NoSourceEncoderAvailableException(data.getClass());  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h6 id=&#34;register&#34;&gt;Register&lt;a title=&#34;#register&#34; href=&#34;#register&#34;&gt;&lt;/a&gt;&lt;/h6&gt;
&lt;blockquote&gt;
&lt;p&gt;æ¯ä¸ªæ•°æ®ç±»å‹å¯¹åº”ä¸€ä¸ªç¼–ç å™¨,Registerå°±æ˜¯ç”¨æ¥è®°å½•è¿™äº›çš„&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;registry&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        .append(ByteBuffer.class, &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; ByteBufferEncoder())&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        .append(InputStream.class, &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; StreamEncoder(arrayPool))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        .append(Registry.BUCKET_BITMAP, ByteBuffer.class, Bitmap.class, byteBufferBitmapDecoder)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        .append(Registry.BUCKET_BITMAP, InputStream.class, Bitmap.class, streamBitmapDecoder);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h5 id=&#34;decodefromretrieveddata()&#34;&gt;decodeFromRetrievedData()&lt;a title=&#34;#decodefromretrieveddata()&#34; href=&#34;#decodefromretrieveddata()&#34;&gt;&lt;/a&gt;&lt;/h5&gt;
&lt;blockquote&gt;
&lt;p&gt;å¤„ç†è¿”å›çš„æ•°æ®&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/10/26/5oU7rD.png&#34; alt=&#34;5oU7rD.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &amp;lt;Data&amp;gt; &lt;span class=&#34;function&#34;&gt;Resource&amp;lt;R&amp;gt; &lt;span class=&#34;title&#34;&gt;decodeFromData&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;function&#34;&gt;    DataFetcher&amp;lt;?&amp;gt; fetcher, Data data, DataSource dataSource)&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;throws&lt;/span&gt; GlideException &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;try&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (data == &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;long&lt;/span&gt; startTime = LogTime.getLogTime();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    Resource&amp;lt;R&amp;gt; result = decodeFromFetcher(data, dataSource);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (Log.isLoggable(TAG, Log.VERBOSE)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      logWithTimeAndKey(&lt;span class=&#34;string&#34;&gt;&amp;quot;Decoded result &amp;quot;&lt;/span&gt; + result, startTime);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; result;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125; &lt;span class=&#34;keyword&#34;&gt;finally&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    fetcher.cleanup();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@SuppressWarnings(&amp;quot;unchecked&amp;quot;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &amp;lt;Data&amp;gt; &lt;span class=&#34;function&#34;&gt;Resource&amp;lt;R&amp;gt; &lt;span class=&#34;title&#34;&gt;decodeFromFetcher&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(Data data, DataSource dataSource)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;throws&lt;/span&gt; GlideException &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  LoadPath&amp;lt;Data, ?, R&amp;gt; path = decodeHelper.getLoadPath((Class&amp;lt;Data&amp;gt;) data.getClass());&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; runLoadPath(data, dataSource, path);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;enginejob&#34;&gt;EngineJob&lt;a title=&#34;#enginejob&#34; href=&#34;#enginejob&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;é€šè¿‡æ·»åŠ å’Œåˆ é™¤åŠ è½½å›è°ƒå¹¶åœ¨åŠ è½½å®Œæˆæ—¶é€šçŸ¥å›è°ƒæ¥ç®¡ç†åŠ è½½çš„ç±»(ç®¡ç†åŠ è½½è¿‡ç¨‹ä¸­çš„ä¸€äº›å›è°ƒ)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;GlideExecutoræ˜¯ä¸€ä¸ªç»§æ‰¿çš„Executorserviceç±»ï¼Œå®ƒæ˜¾ç„¶æ˜¯ä¸€ä¸ªçº¿ç¨‹æ± ã€‚è¿™é‡Œé€šè¿‡decodeJobæ¥ç¡®å®šæ˜¯å¦ä»ç¼“å­˜è§£æï¼Œå¦‚æœæ˜¯ä»ç¼“å­˜è§£æï¼Œè°ƒç”¨diskCacheExecutorï¼Œå¦åˆ™ï¼Œè°ƒç”¨getActiveSourceExecutor&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;willDecodeFromCache
&lt;ul&gt;
&lt;li&gt;å¦‚æœæ­¤ä½œä¸šå°†å°è¯•ä»ç£ç›˜ç¼“å­˜è§£ç èµ„æºï¼Œåˆ™è¿”å›true&lt;/li&gt;
&lt;li&gt;å¦‚æœå§‹ç»ˆä»æºè§£ç ï¼Œåˆ™è¿”å›false&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;synchronized&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;start&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(DecodeJob&amp;lt;R&amp;gt; decodeJob)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;.decodeJob = decodeJob;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  GlideExecutor executor = decodeJob.willDecodeFromCache() ? diskCacheExecutor : getActiveSourceExecutor();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;comment&#34;&gt;// æ‰§è¡ŒdecodeJobçº¿ç¨‹ä»»åŠ¡&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  executor.execute(decodeJob);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://onion99.github.io/2021/11/01/4SVquTFcR8Wyv4GV/</guid>
            <title>æºç å­¦ä¹  - OkHttp</title>
            <link>https://onion99.github.io/2021/11/01/4SVquTFcR8Wyv4GV/</link>
            <category>æºç è§£æ</category>
            <pubDate>Mon, 01 Nov 2021 05:28:18 +0800</pubDate>
            <description><![CDATA[ &lt;blockquote&gt;
&lt;p&gt;httpçš„è¿æ¥æœ¬è´¨ä¸Šæ˜¯ä¸ªsocketï¼Œæ ¹æ®httpåè®®ï¼Œé€šè¿‡socketåŒ…è£…å‘é€è¯·æ±‚å¹¶è·å¾—è¿”å›ç»“æœ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç½‘è·¯è¿æ¥åº“ä¸€å¼€å§‹çš„æ ·å­å¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼Œå…¶å®åªè¦ç¬¦åˆHttpåè®®çš„è¯·æ±‚ï¼Œå°±å¯ä»¥å’Œç½‘ç»œè¿›è¡Œäº¤äº’ï¼Œç±»ä¼¼äºOkHttpçš„ç½‘ç»œè¯·æ±‚åº“ï¼Œå¸®åŠ©å¼€å‘è€…æ–¹ä¾¿å’Œå±è”½äº†Httpåè®®ä¸­ç±»ä¼¼äºè¯·æ±‚å¤´ï¼Œé‡è¿ã€åˆå¹¶ã€ä»£ç†ã€è¿”å›ç»“æœè§£æç­‰ç­‰Httpåè®®ç»†èŠ‚çš„åº”ç”¨å±‚å®ç°ã€‚&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;val path = &lt;span class=&#34;string&#34;&gt;&amp;quot;http://www.baidu.com/&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        val host = &lt;span class=&#34;string&#34;&gt;&amp;quot;www.baidu.com&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; socket: Socket? = &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; streamWriter: OutputStreamWriter? = &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; bufferedWriter: BufferedWriter? = &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;try&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            socket = Socket(host, &lt;span class=&#34;number&#34;&gt;80&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            streamWriter = OutputStreamWriter(socket.getOutputStream())&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            bufferedWriter = BufferedWriter(streamWriter)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            bufferedWriter.write(&lt;span class=&#34;string&#34;&gt;&amp;quot;GET $path HTTP/1.1\r\n&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            bufferedWriter.write(&lt;span class=&#34;string&#34;&gt;&amp;quot;Host: www.baidu.com\r\n&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            bufferedWriter.write(&lt;span class=&#34;string&#34;&gt;&amp;quot;\r\n&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            bufferedWriter.flush()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            val myRequest = BufferedReader(InputStreamReader(socket.getInputStream(), &lt;span class=&#34;string&#34;&gt;&amp;quot;UTF-8&amp;quot;&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; d = -&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;while&lt;/span&gt; (myRequest.read().also(&amp;#123; d = it &amp;#125;) != -&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                print(d.toChar())&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;catch&lt;/span&gt; (e: IOException) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            e.printStackTrace()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;æ•´ä½“æµç¨‹&#34;&gt;æ•´ä½“æµç¨‹&lt;a title=&#34;#æ•´ä½“æµç¨‹&#34; href=&#34;#æ•´ä½“æµç¨‹&#34;&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;GetExample&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;comment&#34;&gt;// æ ¸ç½‘ç»œç®¡ç†è€… - æ ¸å¿ƒç±»&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; OkHttpClient client = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; OkHttpClient();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;function&#34;&gt;String &lt;span class=&#34;title&#34;&gt;run&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(String url)&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;throws&lt;/span&gt; IOException &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// è¯·æ±‚æ­å»º&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    Request request = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; Request.Builder().url(url).build();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;/*&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;      é˜»å¡å¼execute -&amp;gt; ç«‹å³è°ƒç”¨è¯·æ±‚ï¼Œå¹¶é˜»å¡ï¼Œç›´åˆ°å“åº”å¯ä»¥å¤„ç†æˆ–å‡ºç°é”™è¯¯&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;      ä¸ºäº†é¿å…èµ„æºæ³„æ¼ï¼Œè°ƒç”¨è€…åº”è¯¥å…³é—­Responseï¼Œè€ŒResponseåˆä¼šå…³é—­åº•å±‚çš„ResponseBodyã€‚ //ç¡®ä¿å“åº”(å’Œåº•å±‚å“åº”ä½“)æ˜¯å…³é—­çš„&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;      æ³¨æ„ï¼Œä¼ è¾“å±‚çš„æˆåŠŸ(æ¥æ”¶HTTPå“åº”ä»£ç ã€æŠ¥å¤´å’Œæ­£æ–‡)ä¸ä¸€å®šè¡¨ç¤ºåº”ç”¨å±‚çš„æˆåŠŸ:å“åº”å¯èƒ½ä»ç„¶è¡¨ç¤ºä¸æ»¡æ„çš„HTTPå“åº”ä»£ç ï¼Œå¦‚404æˆ–500ã€‚&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;     */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;try&lt;/span&gt; (Response response = client.newCall(request).execute()) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; response.body().string();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(String[] args)&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;throws&lt;/span&gt; IOException &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    GetExample example = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; GetExample();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    String response = example.run(&lt;span class=&#34;string&#34;&gt;&amp;quot;https://raw.github.com/square/okhttp/master/README.md&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    System.out.println(response);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/10/25/5hiy4O.png&#34; alt=&#34;5hiy4O.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;è¿æ¥å»ºç«‹&#34;&gt;è¿æ¥å»ºç«‹&lt;a title=&#34;#è¿æ¥å»ºç«‹&#34; href=&#34;#è¿æ¥å»ºç«‹&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Volleyç­‰å¾ˆå¤šç½‘ç»œè¯·æ±‚æ¡†æ¶å¾ˆå¤šåº•å±‚éƒ½æ˜¯é€šè¿‡ HTTPURLConnection æ¥ä¸æœåŠ¡ç«¯å»ºç«‹è¿æ¥çš„ï¼Œè€Œ OkHttp å°±æ¯”è¾ƒä¼˜ç§€äº†ã€‚å› ä¸º HTTP åè®®æ˜¯å»ºç«‹åœ¨ TCP/IP åè®®åŸºç¡€ä¹‹ä¸Šçš„ï¼Œåº•å±‚è¿˜æ˜¯èµ°çš„ Socketï¼Œæ‰€ä»¥OkHttp ç›´æ¥ä½¿ç”¨ Socket æ¥å®Œæˆ HTTP è¯·æ±‚ã€‚&lt;/p&gt;
&lt;h3 id=&#34;okhttpclient&#34;&gt;OkHttpClient&lt;a title=&#34;#okhttpclient&#34; href=&#34;#okhttpclient&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;å®˜æ–¹æ¨èæˆ‘ä»¬ä½¿ç”¨å•ä¾‹å»åˆ›å»ºOkHttpClientï¼Œé‡ç”¨æ‰€æœ‰HTTPè°ƒç”¨çš„æ—¶å€™ï¼Œæ€§èƒ½æ˜¯æœ€ä½³çš„ï¼Œ è¿™æ˜¯å› ä¸ºæ¯ä¸ªå®¢æˆ·ç«¯éƒ½æ‹¥æœ‰è‡ªå·±çš„è¿æ¥æ± å’Œçº¿ç¨‹æ± ã€‚ é‡ç”¨è¿æ¥å’Œçº¿ç¨‹å¯å‡å°‘å»¶è¿Ÿå¹¶èŠ‚çœå†…å­˜ã€‚ ç›¸åï¼Œä¸ºæ¯ä¸ªè¯·æ±‚åˆ›å»ºä¸€ä¸ªå®¢æˆ·ç«¯ä¼šæµªè´¹ç©ºé—²æ± ä¸Šçš„èµ„æº&lt;/p&gt;
&lt;h3 id=&#34;request&#34;&gt;Request&lt;a title=&#34;#request&#34; href=&#34;#request&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;é‡‡ç”¨Builderçš„æ–¹å¼è¿›è¡Œè®¾è®¡ï¼Œä¸»è¦åŒ…å«äº†urlã€methodã€headersã€bodyå’ŒCacheControlç»„æˆçš„å„ç§é…ç½®é¡¹&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; Dispatcher dispatcher;  &lt;span class=&#34;comment&#34;&gt;//åˆ†å‘å™¨&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; Proxy proxy;  &lt;span class=&#34;comment&#34;&gt;//ä»£ç†&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; List&amp;lt;Protocol&amp;gt; protocols; &lt;span class=&#34;comment&#34;&gt;//åè®®&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; List&amp;lt;ConnectionSpec&amp;gt; connectionSpecs; &lt;span class=&#34;comment&#34;&gt;//ä¼ è¾“å±‚ç‰ˆæœ¬å’Œè¿æ¥åè®®&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; List&amp;lt;Interceptor&amp;gt; interceptors; &lt;span class=&#34;comment&#34;&gt;//æ‹¦æˆªå™¨&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; List&amp;lt;Interceptor&amp;gt; networkInterceptors; &lt;span class=&#34;comment&#34;&gt;//ç½‘ç»œæ‹¦æˆªå™¨&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; ProxySelector proxySelector; &lt;span class=&#34;comment&#34;&gt;//ä»£ç†é€‰æ‹©&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; CookieJar cookieJar; &lt;span class=&#34;comment&#34;&gt;//cookie&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; Cache cache; &lt;span class=&#34;comment&#34;&gt;//ç¼“å­˜&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; InternalCache internalCache;  &lt;span class=&#34;comment&#34;&gt;//å†…éƒ¨ç¼“å­˜&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; SocketFactory socketFactory;  &lt;span class=&#34;comment&#34;&gt;//socket å·¥å‚&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; SSLSocketFactory sslSocketFactory; &lt;span class=&#34;comment&#34;&gt;//å®‰å…¨å¥—æ¥å±‚socket å·¥å‚ï¼Œç”¨äºHTTPS&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; CertificateChainCleaner certificateChainCleaner; &lt;span class=&#34;comment&#34;&gt;// éªŒè¯ç¡®è®¤å“åº”è¯ä¹¦ é€‚ç”¨ HTTPS è¯·æ±‚è¿æ¥çš„ä¸»æœºåã€‚&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; HostnameVerifier hostnameVerifier;    &lt;span class=&#34;comment&#34;&gt;//  ä¸»æœºåå­—ç¡®è®¤&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; CertificatePinner certificatePinner;  &lt;span class=&#34;comment&#34;&gt;//  è¯ä¹¦é“¾&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; Authenticator proxyAuthenticator;     &lt;span class=&#34;comment&#34;&gt;//ä»£ç†èº«ä»½éªŒè¯&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; Authenticator authenticator;      &lt;span class=&#34;comment&#34;&gt;// æœ¬åœ°èº«ä»½éªŒè¯&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; ConnectionPool connectionPool;    &lt;span class=&#34;comment&#34;&gt;//è¿æ¥æ± ,å¤ç”¨è¿æ¥&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; Dns dns;  &lt;span class=&#34;comment&#34;&gt;//åŸŸå&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; followSslRedirects;  &lt;span class=&#34;comment&#34;&gt;//å®‰å…¨å¥—æ¥å±‚é‡å®šå‘&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; followRedirects;  &lt;span class=&#34;comment&#34;&gt;//æœ¬åœ°é‡å®šå‘&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;boolean&lt;/span&gt; retryOnConnectionFailure; &lt;span class=&#34;comment&#34;&gt;//é‡è¯•è¿æ¥å¤±è´¥&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; connectTimeout;    &lt;span class=&#34;comment&#34;&gt;//è¿æ¥è¶…æ—¶&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; readTimeout; &lt;span class=&#34;comment&#34;&gt;//read è¶…æ—¶&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; writeTimeout; &lt;span class=&#34;comment&#34;&gt;//write è¶…æ—¶ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;call&#34;&gt;Call&lt;a title=&#34;#call&#34; href=&#34;#call&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸€ä¸ªæä¾› HTTP è¯·æ±‚æ‰§è¡Œç›¸å…³æ¥å£çš„æ¥å£ç±»ï¼Œå…·ä½“çš„å®ç°ç±»æ˜¯ RealCall&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;å¯ä»¥å–æ¶ˆ&lt;/li&gt;
&lt;li&gt;æ­¤å¯¹è±¡è¡¨ç¤ºå•ä¸ªè¯·æ±‚/å“åº”å¯¹(æµ),å› æ­¤ä¸èƒ½æ‰§è¡Œä¸¤æ¬¡&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;realcall&#34;&gt;RealCall&lt;a title=&#34;#realcall&#34; href=&#34;#realcall&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;OkHttpçš„åº”ç”¨å±‚å’Œç½‘ç»œå±‚ä¹‹é—´çš„æ¡¥æ¢,åŒ…å«äº†ç½‘ç»œçš„è¿æ¥ã€è¯·æ±‚ã€å“åº”å’Œæµå¤„ç†æ•´ä¸ªæµç¨‹,ä¹Ÿæ˜¯OkHttpä¸­æœ€å…³é”®æ ¸å¿ƒçš„ç±»&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h5 id=&#34;asynctimeout&#34;&gt;AsyncTimeout&lt;a title=&#34;#asynctimeout&#34; href=&#34;#asynctimeout&#34;&gt;&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;æ­¤è¶…æ—¶ç”¨åœ¨åœ¨åå°çº¿ç¨‹æ‰§è¡Œè¶…æ—¶æ—¶æ‰§è¡Œæ“ä½œã€‚ ä½¿ç”¨å®ƒæ¥å®ç°æœ¬åœ°ä¸æ”¯æŒçš„è¶…æ—¶ï¼Œä¾‹å¦‚å†™å…¥æ—¶è¢«é˜»æ­¢çš„å¥—æ¥å­—,å­ç±»åº”è¯¥è¦†ç›–timedOutä»¥åœ¨å‘ç”Ÿè¶…æ—¶æ—¶é‡‡å–è¡ŒåŠ¨ã€‚ æ­¤æ–¹æ³•å°†ç”±å…±äº«çœ‹é—¨ç‹—çº¿ç¨‹è°ƒç”¨ï¼Œå› æ­¤ä¸åº”æ‰§è¡Œä»»ä½•é•¿æ—¶é—´è¿è¡Œçš„æ“ä½œã€‚ å¦åˆ™ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šé¢ä¸´è§¦å‘å…¶ä»–è¶…æ—¶çš„é£é™©ã€‚&lt;br&gt;
ä½¿ç”¨sinkå’Œsourceå°†æ­¤è¶…æ—¶åº”ç”¨äºæµã€‚ è¿”å›çš„å€¼å°†è¶…æ—¶åº”ç”¨äºåŒ…è£…æµä¸Šçš„æ¯ä¸ªæ“ä½œã€‚&lt;br&gt;
è°ƒç”¨è€…åº”è¯¥åœ¨æ‰§è¡Œå¯èƒ½è¶…æ—¶çš„å·¥ä½œä¹‹å‰è°ƒç”¨enter ï¼Œç„¶åé€€å‡ºã€‚ exitçš„è¿”å›å€¼è¡¨ç¤ºæ˜¯å¦è§¦å‘äº†è¶…æ—¶ã€‚ è¯·æ³¨æ„ï¼Œå¯¹timedOutçš„è°ƒç”¨æ˜¯å¼‚æ­¥çš„ï¼Œå¯ä»¥åœ¨exitä¹‹åè°ƒç”¨&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; val timeout = object : AsyncTimeout() &amp;#123;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;function&#34;&gt;override fun &lt;span class=&#34;title&#34;&gt;timedOut&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// å–æ¶ˆè¯·æ±‚  &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  cancel()  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;.apply &amp;#123;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  timeout(client.callTimeoutMillis.toLong(), MILLISECONDS)  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h5 id=&#34;execute&#34;&gt;execute&lt;a title=&#34;#execute&#34; href=&#34;#execute&#34;&gt;&lt;/a&gt;&lt;/h5&gt;
&lt;blockquote&gt;
&lt;p&gt;åŒæ­¥è¯·æ±‚,  é©¬ä¸Šæ‰§è¡Œå¹¶é˜»å¡ç›´åˆ°å¯ä»¥å¤„ç†å“åº”æˆ–å‡ºç°é”™è¯¯&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&#34;highlight kotlin&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;override&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;execute&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;: Response &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;comment&#34;&gt;/**&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;   * Atomicå°±æ˜¯åŸå­æ€§çš„æ„æ€ï¼Œæºç é‡Œç”¨äº†Volatileå±æ€§ï¼Œå³èƒ½å¤Ÿä¿è¯åœ¨é«˜å¹¶å‘çš„æƒ…å†µä¸‹åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½å¤Ÿè®¿é—®è¿™ä¸ªå±æ€§å€¼&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;   * executed æ˜¯ä¸€ä¸ªåŸå­å˜é‡ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨ AtomicBoolean é«˜æ•ˆå¹¶å‘å¤„ç† â€œåªåˆå§‹åŒ–ä¸€æ¬¡â€ çš„åŠŸèƒ½è¦æ±‚,ç”¨ compareAndSet(false, true)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;   * åˆ¤æ–­å¤šçº¿ç¨‹çŠ¶æ€ä¸‹ï¼Œè¯·æ±‚æ˜¯å¦é‡æ–°æ‰§è¡Œï¼šå¦‚æœå€¼ä¸ºfalseï¼Œåˆ™æŠ›å‡ºä¸€ä¸ªIllegalStateExceptionï¼Œå¹¶è¿”å›è°ƒç”¨lazyMessageçš„ç»“æœã€‚&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;   */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  check(executed.compareAndSet(&lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt;, &lt;span class=&#34;literal&#34;&gt;true&lt;/span&gt;)) &amp;#123; &lt;span class=&#34;string&#34;&gt;&amp;quot;Already Executed&amp;quot;&lt;/span&gt; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;comment&#34;&gt;// è¶…æ—¶è®¡æ•°å¼€å§‹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  timeout.enter()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;comment&#34;&gt;// æ‰§è¡Œè¯·æ±‚å‰å¤„ç† -&amp;gt; æ ˆè·Ÿè¸ªï¼Œäº‹ä»¶å›è°ƒç­‰ç­‰&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  callStart()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;try&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// è°ƒåº¦å™¨å¼€å§‹æ‰§è¡Œ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    client.dispatcher.executed(&lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// è¿”å›æ‹¦æˆªå™¨å¤„ç†ä¸‹çš„å“åº”&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; getResponseWithInterceptorChain()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125; &lt;span class=&#34;keyword&#34;&gt;finally&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// è°ƒåº¦å™¨è¿”å›å®Œæˆä¿¡å·&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    client.dispatcher.finished(&lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h5 id=&#34;enqueue&#34;&gt;enqueue&lt;a title=&#34;#enqueue&#34; href=&#34;#enqueue&#34;&gt;&lt;/a&gt;&lt;/h5&gt;
&lt;blockquote&gt;
&lt;p&gt;å¼‚æ­¥è°ƒåº¦,  å°†è¯·æ±‚æ”¾åˆ°é˜Ÿåˆ—ä¸­ç­‰åˆ°æ‰§è¡Œ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;RealCall.kt&lt;/p&gt;
&lt;figure class=&#34;highlight kotlin&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;override&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;enqueue&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(responseCallback: &lt;span class=&#34;type&#34;&gt;Callback&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt; &amp;#123;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;comment&#34;&gt;// é¦–å…ˆåˆ¤æ–­å½“å‰è¯·æ±‚æ˜¯å¦å·²æ‰§è¡Œï¼Œå¦‚æœå·²ç»æ‰§è¡Œåˆ™æ‰“å°æ—¥å¿—ï¼Œå¹¶æŠ›å‡º IllegalStateException å¼‚å¸¸&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  check(executed.compareAndSet(&lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt;, &lt;span class=&#34;literal&#34;&gt;true&lt;/span&gt;)) &amp;#123; &lt;span class=&#34;string&#34;&gt;&amp;quot;Already Executed&amp;quot;&lt;/span&gt; &amp;#125;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  callStart()  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;comment&#34;&gt;// åˆ›å»ºä¸€ä¸ªAsyncCallå¯¹è±¡,æ”¾è¿›åˆ†å‘å™¨é˜Ÿåˆ—ä¸­&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  client.dispatcher.enqueue(AsyncCall(responseCallback))  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;callStart&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt;&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«åœ¨æ‰§è¡Œæ­¤æ–¹æ³•æ—¶åˆ›å»ºçš„å †æ ˆè·Ÿè¸ª&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;.callStackTrace = Platform.&lt;span class=&#34;keyword&#34;&gt;get&lt;/span&gt;().getStackTraceForCloseable(&lt;span class=&#34;string&#34;&gt;&amp;quot;response.body().close()&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    eventListener.callStart(&lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Dispatcher.kt&lt;/p&gt;
&lt;figure class=&#34;highlight kotlin&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;///////////////////////////////////////////////////////////////////////////&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// https://zhuanlan.zhihu.com/p/261397170&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// ArrayDeque -  Java é›†åˆä¸­åŒç«¯é˜Ÿåˆ—çš„æ•°ç»„å®ç°&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// ArrayDeque å‡ ä¹æ²¡æœ‰å®¹é‡é™åˆ¶ï¼Œè®¾è®¡ä¸ºçº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œç¦æ­¢ null å…ƒç´ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// ArrayDequeæ˜¯Dequeçš„å®ç°ç±»ï¼Œå¯ä»¥ä½œä¸ºæ ˆæ¥ä½¿ç”¨ï¼Œæ•ˆç‡é«˜äºStackï¼›ä¹Ÿå¯ä»¥ä½œä¸ºé˜Ÿåˆ—æ¥ä½¿ç”¨ï¼Œæ•ˆç‡é«˜äºLinkedListã€‚&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// ArrayDeque å¤§å¤šæ•°çš„é¢æ“ä½œéƒ½åœ¨å›ºå®šæ—¶é—´å†…è¿è¡Œï¼Œä¾‹å¤–æƒ…å†µåŒ…æ‹¬ removeï¼ŒremoveFirstOccurrenceï¼ŒremoveLastOccurrenceï¼Œcontainsï¼Œiterator.remove()ï¼Œå’Œæ‰¹é‡æ“ä½œï¼Œè¿™äº›å°†ä»¥çº¿æ€§æ—¶é—´è¿è¡Œ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;///////////////////////////////////////////////////////////////////////////&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;val&lt;/span&gt; runningSyncCalls = ArrayDeque&amp;lt;RealCall&amp;gt;()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;internal&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;enqueue&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(call: &lt;span class=&#34;type&#34;&gt;AsyncCall&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  synchronized(&lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// å°†è¯·æ±‚ AsyncCall æ·»åŠ åˆ°å¾…æ‰§è¡Œé˜Ÿåˆ—&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    readyAsyncCalls.add(call)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// åˆ¤æ–­å½“å‰è¯·æ±‚æ˜¯å¦å·²å­˜åœ¨å¯å¤ç”¨çš„ hos&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!call.call.forWebSocket) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;val&lt;/span&gt; existingCall = findExistingCallWithHost(call.host)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (existingCall != &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;) call.reuseCallsPerHostFrom(existingCall)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;comment&#34;&gt;// å°†ç¬¦åˆæ¡ä»¶çš„Callä»readyAsyncCalls æå‡åˆ°runningAsyncCallså¹¶åœ¨æ‰§è¡Œå®ƒä»¬&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  promoteAndExecute()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;RealCall.AsyncCall&lt;/p&gt;
&lt;figure class=&#34;highlight kotlin&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;override&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;run&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt;&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// ç»™å½“å‰AsyncCallå¼‚æ­¥çº¿ç¨‹è®¾ç½®åç§°&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    threadName(&lt;span class=&#34;string&#34;&gt;&amp;quot;OkHttp &lt;span class=&#34;subst&#34;&gt;$&amp;#123;redactedUrl()&amp;#125;&lt;/span&gt;&amp;quot;&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; signalledCallback = &lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      timeout.enter()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;try&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// è·å–è¯·æ±‚ç»“æœ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;val&lt;/span&gt; response = getResponseWithInterceptorChain()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        signalledCallback = &lt;span class=&#34;literal&#34;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// è§¦å‘ç›¸åº”å›è°ƒ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        responseCallback.onResponse(&lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;symbol&#34;&gt;@RealCall&lt;/span&gt;, response)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &amp;#125; &lt;span class=&#34;keyword&#34;&gt;catch&lt;/span&gt; (e: IOException) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (signalledCallback) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;          &lt;span class=&#34;comment&#34;&gt;// Do not signal the callback twice!&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;          Platform.&lt;span class=&#34;keyword&#34;&gt;get&lt;/span&gt;().log(&lt;span class=&#34;string&#34;&gt;&amp;quot;Callback failure for &lt;span class=&#34;subst&#34;&gt;$&amp;#123;toLoggableString()&amp;#125;&lt;/span&gt;&amp;quot;&lt;/span&gt;, Platform.INFO, e)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;          responseCallback.onFailure(&lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;symbol&#34;&gt;@RealCall&lt;/span&gt;, e)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &amp;#125; &lt;span class=&#34;keyword&#34;&gt;catch&lt;/span&gt; (t: Throwable) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        cancel()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!signalledCallback) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;          &lt;span class=&#34;keyword&#34;&gt;val&lt;/span&gt; canceledException = IOException(&lt;span class=&#34;string&#34;&gt;&amp;quot;canceled due to &lt;span class=&#34;variable&#34;&gt;$t&lt;/span&gt;&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;          canceledException.addSuppressed(t)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;          responseCallback.onFailure(&lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;symbol&#34;&gt;@RealCall&lt;/span&gt;, canceledException)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;throw&lt;/span&gt; t&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &amp;#125; &lt;span class=&#34;keyword&#34;&gt;finally&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// å…³é—­è¯·æ±‚&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        client.dispatcher.finished(&lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;dispatcher(åˆ†å‘å™¨)&#34;&gt;Dispatcher(åˆ†å‘å™¨)&lt;a title=&#34;#dispatcher(åˆ†å‘å™¨)&#34; href=&#34;#dispatcher(åˆ†å‘å™¨)&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;ç”¨äºç®¡ç†å…¶å¯¹åº” OkHttpClient çš„æ‰€æœ‰è¯·æ±‚,å¯¹Callè¿›è¡Œç»Ÿä¸€çš„æ§åˆ¶ï¼Œä¾‹å¦‚ç»“æŸæ‰€æœ‰è¯·æ±‚ã€è·å–çº¿ç¨‹æ± ç­‰ç­‰&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;readyAsyncCallsï¼šä¸€ä¸ªæ–°çš„å¼‚æ­¥è¯·æ±‚é¦–å…ˆä¼šè¢«åŠ å…¥è¯¥é˜Ÿåˆ—ä¸­&lt;/li&gt;
&lt;li&gt;runningAsyncCallsï¼šå½“å‰æ­£åœ¨è¿è¡Œä¸­çš„å¼‚æ­¥è¯·æ±‚&lt;/li&gt;
&lt;li&gt;runningSyncCallsï¼šå½“å‰æ­£åœ¨è¿è¡Œçš„åŒæ­¥è¯·æ±‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¼‚æ­¥è¯·æ±‚è·ŸåŒæ­¥è¯·æ±‚ä¸€æ ·,æœ€ç»ˆéƒ½ä¼šè°ƒç”¨åˆ°&lt;code&gt;getResponseWithInterceptorChain()&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;interceptor(æ‹¦æˆªå™¨)&#34;&gt;Interceptor(æ‹¦æˆªå™¨)&lt;a title=&#34;#interceptor(æ‹¦æˆªå™¨)&#34; href=&#34;#interceptor(æ‹¦æˆªå™¨)&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;Interceptor æ¥å£ä½œä¸ºä¸€ä¸ªæ‹¦æˆªå™¨çš„æŠ½è±¡æ¦‚å¿µï¼Œè¢«è®¾è®¡ä¸ºè´£ä»»é“¾ä¸Šçš„å•ä½èŠ‚ç‚¹ï¼Œç”¨äºè§‚å¯Ÿã€æ‹¦æˆªã€å¤„ç†è¯·æ±‚ç­‰ï¼Œä¾‹å¦‚æ·»åŠ  Headerã€é‡å®šå‘ã€æ•°æ®å¤„ç†ç­‰ç­‰ã€‚&lt;br&gt;
Interceptor ä¹‹é—´äº’ç›¸ç‹¬ç«‹ï¼Œæ¯ä¸ª Interceptor åªè´Ÿè´£è‡ªå·±å…³æ³¨çš„ä»»åŠ¡ï¼Œä¸ä¸å…¶ä»– Interceptor æ¥è§¦ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;RealCall.kt&lt;/p&gt;
&lt;figure class=&#34;highlight kotlin&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Throws(IOException::class)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;internal&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;getResponseWithInterceptorChain&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;: Response &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;comment&#34;&gt;// &lt;span class=&#34;doctag&#34;&gt;TODO:&lt;/span&gt; 2021/8/13 okhttpçš„æ ¸å¿ƒæ˜¯æ‹¦æˆªå™¨ï¼Œè€Œæ‹¦æˆªå™¨æ‰€é‡‡ç”¨çš„è®¾è®¡æ¨¡å¼æ˜¯è´£ä»»é“¾è®¾è®¡ï¼Œå³æ¯ä¸ªæ‹¦æˆªå™¨åªå¤„ç†ä¸è‡ªå·±ç›¸å…³çš„ä¸šåŠ¡é€»è¾‘ https://zhuanlan.zhihu.com/p/340090732&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;comment&#34;&gt;// æ„å»ºæ•´ä¸ªç½‘ç»œè¯·æ±‚æ‹¦æˆª&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;val&lt;/span&gt; interceptors = mutableListOf&amp;lt;Interceptor&amp;gt;()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;comment&#34;&gt;// æ·»åŠ Clientçš„æ‹¦æˆªå™¨&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  interceptors += client.interceptors&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;comment&#34;&gt;// æ·»åŠ å¤±è´¥é‡è¿çš„æ‹¦æˆªå™¨&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  interceptors += RetryAndFollowUpInterceptor(client)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;comment&#34;&gt;// æ·»åŠ è¯·æ±‚æ¡¥æ¢æ‹¦æˆªå™¨ - åœ¨å¯¹ç”¨æˆ·çš„è¯·æ±‚å¤´éƒ¨åŠ äº†ä¸€äº›ä¿¡æ¯ï¼Œç„¶ååœ¨è·å–åˆ°çš„å“åº”ä¸­ä¹Ÿåšäº†ä¸€äº›å¤„ç†ã€‚è€Œè¿™äº›å¤„ç†å¯¹ç”¨æˆ·æ˜¯é€æ˜çš„ï¼Œå‡å°‘äº†å®¢æˆ·è¯·æ±‚çš„å·¥ä½œ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  interceptors += BridgeInterceptor(client.cookieJar)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;comment&#34;&gt;// æ·»åŠ ç¼“å­˜æ‹¦æˆªå™¨ - ç†æ¥è‡ªç¼“å­˜çš„è¯·æ±‚å¹¶å°†å“åº”å†™å…¥ç¼“å­˜ã€‚&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  interceptors += CacheInterceptor(client.cache)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;comment&#34;&gt;// æ·»åŠ è¯·æ±‚ä¸­æ‹¦æˆªå™¨ - æ‰“å¼€ä¸ç›®æ ‡æœåŠ¡å™¨çš„è¿æ¥å¹¶ç»§ç»­ä¸‹ä¸€ä¸ªæ‹¦æˆªå™¨ã€‚ ç½‘ç»œå¯èƒ½ç”¨äºè¿”å›çš„å“åº”ï¼Œæˆ–ä½¿ç”¨æ¡ä»¶ GET éªŒè¯ç¼“å­˜çš„å“åº”&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  interceptors += ConnectInterceptor&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!forWebSocket) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    interceptors += client.networkInterceptors&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;comment&#34;&gt;// è¿™æ˜¯é“¾ä¸­çš„æœ€åä¸€ä¸ªæ‹¦æˆªå™¨ã€‚ å®ƒå¯¹æœåŠ¡å™¨è¿›è¡Œç½‘ç»œè°ƒç”¨,çœŸæ­£çš„ç½‘ç»œè¯·æ±‚ä»è¿™é‡Œå¼€å§‹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  interceptors += CallServerInterceptor(forWebSocket)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;comment&#34;&gt;// æ„å»ºç½‘ç»œè¯·æ±‚é“¾ - ä¸€ä¸ªå…·ä½“çš„æ‹¦æˆªå™¨é“¾ï¼Œæ‰¿è½½ç€æ•´ä¸ªæ‹¦æˆªå™¨é“¾ï¼šæ‰€æœ‰åº”ç”¨ç¨‹åºæ‹¦æˆªå™¨ã€OkHttpæ ¸å¿ƒã€æ‰€æœ‰ç½‘ç»œæ‹¦æˆªå™¨ï¼Œæœ€åæ˜¯ç½‘ç»œè°ƒç”¨è€…ã€‚&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;val&lt;/span&gt; chain = RealInterceptorChain(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      call = &lt;span class=&#34;keyword&#34;&gt;this&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      interceptors = interceptors,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      index = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      exchange = &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      request = originalRequest,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      connectTimeoutMillis = client.connectTimeoutMillis,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      readTimeoutMillis = client.readTimeoutMillis,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      writeTimeoutMillis = client.writeTimeoutMillis&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  )&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; calledNoMoreExchanges = &lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;try&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;val&lt;/span&gt; response = chain.proceed(originalRequest)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// æ˜¯å¦å–æ¶ˆè¯·æ±‚&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (isCanceled()) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      response.closeQuietly()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;throw&lt;/span&gt; IOException(&lt;span class=&#34;string&#34;&gt;&amp;quot;Canceled&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; response&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125; &lt;span class=&#34;keyword&#34;&gt;catch&lt;/span&gt; (e: IOException) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    calledNoMoreExchanges = &lt;span class=&#34;literal&#34;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;throw&lt;/span&gt; noMoreExchanges(e) &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; Throwable&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125; &lt;span class=&#34;keyword&#34;&gt;finally&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!calledNoMoreExchanges) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      noMoreExchanges(&lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;RealInterceptorChain.kt&lt;/p&gt;
&lt;figure class=&#34;highlight kotlin&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Throws(IOException::class)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;override&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;fun&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;proceed&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(request: &lt;span class=&#34;type&#34;&gt;Request&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;: Response &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;comment&#34;&gt;// åˆ¤æ–­æ‹¦æˆªå™¨æ˜¯å¦ä¸ºç©º&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  check(index &amp;lt; interceptors.size)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;comment&#34;&gt;// è¯·æ±‚æ•°åŠ 1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  calls++&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (exchange != &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    check(exchange.finder.sameHostAndPort(request.url)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;string&#34;&gt;&amp;quot;network interceptor &lt;span class=&#34;subst&#34;&gt;$&amp;#123;interceptors[index - &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;]&amp;#125;&lt;/span&gt; must retain the same host and port&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    check(calls == &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;string&#34;&gt;&amp;quot;network interceptor &lt;span class=&#34;subst&#34;&gt;$&amp;#123;interceptors[index - &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;]&amp;#125;&lt;/span&gt; must call proceed() exactly once&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;comment&#34;&gt;// Call the next interceptor in the chain. è°ƒç”¨é“¾ä¸­çš„ä¸‹ä¸€ä¸ªæ‹¦æˆªå™¨&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;val&lt;/span&gt; next = copy(index = index + &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, request = request)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;comment&#34;&gt;// è·å–å½“å‰çš„æ‹¦æˆªå™¨&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;val&lt;/span&gt; interceptor = interceptors[index]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;comment&#34;&gt;// å¼€å§‹ä¸€ä¸ªä¸ªçš„æ‰§è¡Œæ¯ä¸€ä¸ªæ‹¦æˆªå™¨ï¼Œæ¯ä¸ªæ‹¦æˆªå™¨çš„interceptéƒ½ä¼šè°ƒåˆ° å½“å‰ç±»çš„proceed ï¼Œç›´è‡³æœ€åä¸€ä¸ªCallServerInterceptoræ‰§è¡Œå®Œ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;meta&#34;&gt;@Suppress(&lt;span class=&#34;meta-string&#34;&gt;&amp;quot;USELESS_ELVIS&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;val&lt;/span&gt; response = interceptor.intercept(next) ?: &lt;span class=&#34;keyword&#34;&gt;throw&lt;/span&gt; NullPointerException(&lt;span class=&#34;string&#34;&gt;&amp;quot;interceptor &lt;span class=&#34;variable&#34;&gt;$interceptor&lt;/span&gt; returned null&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (exchange != &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    check(index + &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt; &amp;gt;= interceptors.size || next.calls == &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;string&#34;&gt;&amp;quot;network interceptor &lt;span class=&#34;variable&#34;&gt;$interceptor&lt;/span&gt; must call proceed() exactly once&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  check(response.body != &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;) &amp;#123; &lt;span class=&#34;string&#34;&gt;&amp;quot;interceptor &lt;span class=&#34;variable&#34;&gt;$interceptor&lt;/span&gt; returned a response with no body&amp;quot;&lt;/span&gt; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; response&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;chain&#34;&gt;Chain&lt;a title=&#34;#chain&#34; href=&#34;#chain&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;Interceptor ä¸ Chain å½¼æ­¤äº’ç›¸ä¾èµ–ï¼Œäº’ç›¸è°ƒç”¨ï¼Œå…±åŒå‘å±•ï¼Œå½¢æˆäº†ä¸€ä¸ªå®Œç¾çš„è°ƒç”¨é“¾&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Chain è¢«ç”¨æ¥æè¿°è´£ä»»é“¾ï¼Œé€šè¿‡å…¶ä¸­çš„ process æ–¹æ³•å¼€å§‹ä¾æ¬¡æ‰§è¡Œé“¾ä¸Šçš„æ¯ä¸ªèŠ‚ç‚¹ï¼Œå¹¶è¿”å›å¤„ç†åçš„ Responseã€‚&lt;br&gt;
Chain çš„å”¯ä¸€å®ç°ä¸º RealInterceptorChainï¼ˆä¸‹æ–‡ç®€ç§° RICï¼‰ï¼ŒRIC å¯ä»¥ç§°ä¹‹ä¸º&lt;strong&gt;æ‹¦æˆªå™¨è´£ä»»é“¾&lt;/strong&gt;ï¼Œå…¶ä¸­çš„èŠ‚ç‚¹ç”± RealCall ä¸­æ·»åŠ è¿›æ¥çš„ Interceptor ä»¬ç»„æˆã€‚ç”±äº Interceptor çš„äº’ç›¸ç‹¬ç«‹æ€§ï¼ŒRIC ä¸­è¿˜ä¼šåŒ…å«ä¸€äº›å…¬å…±å‚æ•°åŠå…±äº«çš„å¯¹è±¡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/10/25/5hbpJx.png&#34; alt=&#34;5hbpJx.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;about&#34;&gt;About&lt;a title=&#34;#about&#34; href=&#34;#about&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://zhuanlan.zhihu.com/p/116777864&#34; target=&#34;_blank&#34;&gt;OkHttpæºç æ·±åº¦è§£æ&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://zhuanlan.zhihu.com/p/104813091&#34; target=&#34;_blank&#34;&gt;OkHttpæºç è§£æ&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://juejin.cn/post/7020027832977850381&#34; target=&#34;_blank&#34;&gt;OkHttpæºç åŸç†&lt;/a&gt;&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://onion99.github.io/2021/11/01/5FIszA6Ut2OHE8Sg/</guid>
            <title>å®‰å“ä¼˜åŒ– - å¸ƒå±€ä¼˜åŒ–</title>
            <link>https://onion99.github.io/2021/11/01/5FIszA6Ut2OHE8Sg/</link>
            <category>æ€§èƒ½ä¼˜åŒ–</category>
            <pubDate>Mon, 01 Nov 2021 04:50:14 +0800</pubDate>
            <description><![CDATA[ &lt;h3 id=&#34;å¸ƒå±€è€—æ—¶ç»Ÿè®¡&#34;&gt;å¸ƒå±€è€—æ—¶ç»Ÿè®¡&lt;a title=&#34;#å¸ƒå±€è€—æ—¶ç»Ÿè®¡&#34; href=&#34;#å¸ƒå±€è€—æ—¶ç»Ÿè®¡&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;æ‰‹åŠ¨åŸ‹ç‚¹&lt;/li&gt;
&lt;li&gt;AOP/ArtHook
&lt;ul&gt;
&lt;li&gt;åˆ‡å…¥Activityçš„setContentView&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;å¸ƒå±€åŠ è½½ä¼˜åŒ–&#34;&gt;å¸ƒå±€åŠ è½½ä¼˜åŒ–&lt;a title=&#34;#å¸ƒå±€åŠ è½½ä¼˜åŒ–&#34; href=&#34;#å¸ƒå±€åŠ è½½ä¼˜åŒ–&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ä»£ç å†™å¸ƒå±€
&lt;ul&gt;
&lt;li&gt;Javaä»£ç å†™å¸ƒå±€&lt;/li&gt;
&lt;li&gt;Anko&lt;/li&gt;
&lt;li&gt;JetpackCompose&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;X2C&lt;/li&gt;
&lt;li&gt;Litho&lt;/li&gt;
&lt;/ul&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;h3 id=&#34;è§†å›¾ç»˜åˆ¶ä¼˜åŒ–&#34;&gt;è§†å›¾ç»˜åˆ¶ä¼˜åŒ–&lt;a title=&#34;#è§†å›¾ç»˜åˆ¶ä¼˜åŒ–&#34; href=&#34;#è§†å›¾ç»˜åˆ¶ä¼˜åŒ–&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ä¼˜åŒ–å¸ƒå±€å±‚çº§ä»¥åŠåµŒå¥—
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨ConstraintLayout&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é¿å…è¿‡åº¦ç»˜åˆ¶,è‡ªå®šä¹‰Viewé¿å…å¤šæ¬¡è°ƒç”¨ onDraw,onMeasure&lt;/li&gt;
&lt;li&gt;å…¶ä»–
&lt;ul&gt;
&lt;li&gt;ViewStub: å»¶è¿Ÿåˆå§‹åŒ–&lt;/li&gt;
&lt;li&gt;onDraw,onMeasureä¸­é¿å…åˆ›å»ºå¤§å¯¹è±¡,è€—æ—¶æ“ä½œ&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;include&#34;&gt;Include&lt;a title=&#34;#include&#34; href=&#34;#include&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;æé«˜å¸ƒå±€å¤ç”¨æ€§&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;login.xml&lt;/p&gt;
&lt;figure class=&#34;highlight xml&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;include&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;    &lt;span class=&#34;attr&#34;&gt;android:layout_width&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;match_parent&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;    &lt;span class=&#34;attr&#34;&gt;android:layout_height&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;40dp&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;    &lt;span class=&#34;attr&#34;&gt;layout&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;@layout/titlebar&amp;quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;includeæ‰€åœ¨çš„layoutçš„å¸ƒå±€æœ‰ç»™å…¶è®¾ç½®id, è€Œincludeæ ‡ç­¾é‡Œé¢åˆç»™è‡ªå·±çš„æ ¹å®¹å™¨è®¾ç½®id,æœ€å¥½ä¸¤ä¸ªidéƒ½ç›¸åŒ,å¦åˆ™findviewæ—¶æ‹¿åˆ°ç©ºå¯¹è±¡&lt;/p&gt;
&lt;h4 id=&#34;merge&#34;&gt;Merge&lt;a title=&#34;#merge&#34; href=&#34;#merge&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;å¸®åŠ©includeæ ‡ç­¾æ’é™¤å¤šä½™çš„ä¸€å±‚ViewGroupå®¹å™¨ï¼Œå‡å°‘view hierarchyçš„ç»“æ„ï¼Œæå‡UIæ¸²æŸ“çš„æ€§èƒ½&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;titlebar.xml&lt;/p&gt;
&lt;figure class=&#34;highlight xml&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;merge&lt;/span&gt; &lt;span class=&#34;attr&#34;&gt;xmlns:android&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;http://schemas.android.com/apk/res/android&amp;quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;Button&lt;/span&gt; &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;        &lt;span class=&#34;attr&#34;&gt;android:layout_width&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;match_parent&amp;quot;&lt;/span&gt;  &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;        &lt;span class=&#34;attr&#34;&gt;android:layout_height&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;wrap_content&amp;quot;&lt;/span&gt;  &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;        &lt;span class=&#34;attr&#34;&gt;android:layout_marginLeft&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;20dp&amp;quot;&lt;/span&gt;  &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;        &lt;span class=&#34;attr&#34;&gt;android:layout_marginRight&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;20dp&amp;quot;&lt;/span&gt;  &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;        &lt;span class=&#34;attr&#34;&gt;android:text&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;æ ‡é¢˜&amp;quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;merge&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;å› ä¸ºmergeæ ‡ç­¾å¹¶ä¸æ˜¯View,æ‰€ä»¥åœ¨é€šè¿‡LayoutInflate.inflate()æ–¹æ³•æ¸²æŸ“çš„æ—¶å€™,ç¬¬äºŒä¸ªå‚æ•°å¿…é¡»æŒ‡å®šä¸€ä¸ªçˆ¶å®¹å™¨(parent),ä¸”ç¬¬ä¸‰ä¸ªå‚æ•°(attachToRoot)å¿…é¡»ä¸ºtrue&lt;/li&gt;
&lt;li&gt;mergeæ ‡ç­¾å¿…é¡»ä½¿ç”¨åœ¨æ ¹å¸ƒå±€ï¼Œå¹¶ä¸”ViewStubæ ‡ç­¾ä¸­çš„layoutå¸ƒå±€ä¸èƒ½ä½¿ç”¨mergeæ ‡ç­¾&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;viewstub&#34;&gt;ViewStub&lt;a title=&#34;#viewstub&#34; href=&#34;#viewstub&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;å»¶è¿Ÿç»˜åˆ¶View&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;layout.xml&lt;/p&gt;
&lt;figure class=&#34;highlight xml&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;ViewStub&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;    &lt;span class=&#34;attr&#34;&gt;android:id&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;@+id/viewstub&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;    &lt;span class=&#34;attr&#34;&gt;android:layout_width&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;match_parent&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;    &lt;span class=&#34;attr&#34;&gt;android:layout_height&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;wrap_content&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;    &lt;span class=&#34;attr&#34;&gt;android:layout&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;@layout/info&amp;quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;activity.java&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;ViewStub stub = ((ViewStub) findViewById(R.id.viewstub));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(stub!=&lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    View stubView = stub.inflate();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    EditText editText = (EditText) stubView.findViewById(R.id.edit_password);  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;ViewStubæ ‡ç­¾ä¸æ”¯æŒmergeæ ‡ç­¾&lt;/li&gt;
&lt;li&gt;ViewStubçš„inflateåªèƒ½è¢«è°ƒç”¨ä¸€æ¬¡,ç¬¬äºŒæ¬¡è°ƒç”¨ä¼šæŠ›å‡ºå¼‚å¸¸&lt;/li&gt;
&lt;li&gt;è™½ç„¶ViewStubæ˜¯ä¸å ç”¨ä»»ä½•ç©ºé—´çš„ï¼Œä½†æ˜¯æ¯ä¸ªå¸ƒå±€éƒ½å¿…é¡»è¦æŒ‡å®šlayout_widthå’Œlayout_heightå±æ€§ï¼Œå¦åˆ™è¿è¡Œå°±ä¼šæŠ¥é”™&lt;/li&gt;
&lt;/ul&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://onion99.github.io/2021/11/01/6JN9JxpnRSjVeWry/</guid>
            <title>å®‰å“ä¼˜åŒ– - çº¿ç¨‹ä¼˜åŒ–</title>
            <link>https://onion99.github.io/2021/11/01/6JN9JxpnRSjVeWry/</link>
            <category>æ€§èƒ½ä¼˜åŒ–</category>
            <pubDate>Mon, 01 Nov 2021 04:48:51 +0800</pubDate>
            <description><![CDATA[ &lt;h3 id=&#34;çº¿ç¨‹è°ƒåº¦&#34;&gt;çº¿ç¨‹è°ƒåº¦&lt;a title=&#34;#çº¿ç¨‹è°ƒåº¦&#34; href=&#34;#çº¿ç¨‹è°ƒåº¦&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;ä»»æ„æ—¶åˆ»ï¼Œåªæœ‰ä¸€ä¸ªçº¿ç¨‹å ç”¨CPUï¼Œå¤„äºè¿è¡ŒçŠ¶æ€&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¤šçº¿ç¨‹å¹¶å‘ï¼šè½®æµè·å–cpuä½¿ç”¨æƒ&lt;br&gt;
JVMè´Ÿè´£çº¿ç¨‹è°ƒåº¦ï¼šæŒ‰ç…§ç‰¹å®šè°ƒåº¦æ¨¡å‹åˆ†é…CPUä½¿ç”¨æƒ&lt;/p&gt;
&lt;h4 id=&#34;è°ƒåº¦æ¨¡å‹&#34;&gt;è°ƒåº¦æ¨¡å‹&lt;a title=&#34;#è°ƒåº¦æ¨¡å‹&#34; href=&#34;#è°ƒåº¦æ¨¡å‹&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;åˆ†æ—¶è°ƒåº¦æ¨¡å‹: è½®æµè·å–,å‡åŒ€åˆ†é…cpuæ—¶é—´&lt;/li&gt;
&lt;li&gt;æŠ¢å å¼è°ƒåº¦æ¨¡å‹:  æŒ‰ç…§ä¼˜å…ˆçº§æ¥&lt;/li&gt;
&lt;/ul&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;h3 id=&#34;androidå¼‚æ­¥æ–¹å¼&#34;&gt;Androidå¼‚æ­¥æ–¹å¼&lt;a title=&#34;#androidå¼‚æ­¥æ–¹å¼&#34; href=&#34;#androidå¼‚æ­¥æ–¹å¼&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Thread
&lt;ul&gt;
&lt;li&gt;æœ€ç®€å•ã€å¸¸è§çš„æ–¹å¼&lt;/li&gt;
&lt;li&gt;ä¸æ˜“å¤ç”¨ï¼Œé¢‘ç¹åˆ›å»ºé”€æ¯å¼€é”€å¤§&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;HandlerThread
&lt;ul&gt;
&lt;li&gt;è‡ªå¸¦æ¶ˆæ¯å¾ªç¯çš„çº¿ç¨‹&lt;/li&gt;
&lt;li&gt;ä¸²è¡Œæ‰§è¡Œ,é•¿æ—¶é—´è¿è¡Œï¼Œä¸æ–­ä»é˜Ÿåˆ—ä¸­è·å–ä»»åŠ¡&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;IntentService
&lt;ul&gt;
&lt;li&gt;ç»§æ‰¿è‡ªServiceåœ¨å†…éƒ¨åˆ›å»ºHandlerThread&lt;/li&gt;
&lt;li&gt;å¼‚æ­¥ã€ä¸å ç”¨ä¸»çº¿ç¨‹&lt;/li&gt;
&lt;li&gt;ä¼˜å…ˆçº§é«˜ï¼Œä¸æ˜“è¢«ç³»ç»Ÿkil&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;AsyncTask
&lt;ul&gt;
&lt;li&gt;Androidæä¾›çš„å·¥å…·ç±»&lt;/li&gt;
&lt;li&gt;æ— éœ€è‡ªå·±å¤„ç†çº¿ç¨‹åˆ‡æ¢&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;çº¿ç¨‹æ± 
&lt;ul&gt;
&lt;li&gt;jdkæä¾›çš„çº¿ç¨‹æ± &lt;/li&gt;
&lt;li&gt;æ˜“å¤ç”¨ï¼Œå‡å°‘é¢‘ç¹åˆ›å»ºã€é”€æ¯çš„æ—¶é—´&lt;/li&gt;
&lt;li&gt;åŠŸèƒ½å¼ºå¤§ï¼šå®šæ—¶ã€ä»»åŠ¡åˆ—é˜Ÿã€å¹¶å‘æ•°æ§åˆ¶ç­‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;RxJava
&lt;ul&gt;
&lt;li&gt;ç”±å¼ºå¤§çš„Scheduleré›†åˆæä¾›&lt;/li&gt;
&lt;li&gt;ä¸åŒç±»å‹çš„åŒºåˆ†ï¼šIOå¯†é›†å‹ã€CPUå¯†é›†å‹&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;åç¨‹&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;çº¿ç¨‹ä½¿ç”¨å‡†åˆ™&#34;&gt;çº¿ç¨‹ä½¿ç”¨å‡†åˆ™&lt;a title=&#34;#çº¿ç¨‹ä½¿ç”¨å‡†åˆ™&#34; href=&#34;#çº¿ç¨‹ä½¿ç”¨å‡†åˆ™&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;1ã€ä¸¥ç¦ä½¿ç”¨new Thread,å› ä¸ºè¿™æ ·ä¸ä¾¿æ§åˆ¶,å¯èƒ½äº§ç”Ÿé¢„æœŸä¹‹å¤–çš„äº‹æƒ…&lt;br&gt;
2ã€æä¾›åŸºç¡€çº¿ç¨‹æ± ä¾›å„ä¸ªä¸šåŠ¡æ ˆä½¿ç”¨ï¼ˆé¿å…å„ä¸ªä¸šåŠ¡æ ˆå„è‡ªç»´æŠ¤ä¸€å¥—çº¿ç¨‹æ± ï¼Œå¯¼è‡´çº¿ç¨‹æ•°è¿‡å¤šï¼‰&lt;br&gt;
3ã€æ ¹æ®ä»»åŠ¡ç±»å‹é€‰æ‹©åˆé€‚çš„å¼‚æ­¥æ–¹å¼ï¼ˆä¼˜å…ˆçº§ä½é•¿æ—¶é—´æ‰§è¡Œ-HandlerThreadï¼Œå®šæ—¶æ‰§è¡Œ-çº¿ç¨‹æ± ï¼‰&lt;br&gt;
4ã€åˆ›å»ºçº¿ç¨‹å¿…é¡»å‘½åï¼ˆæ–¹ä¾¿å®šä½çº¿ç¨‹å½’å±ï¼Œè¿è¡ŒæœŸThread.currentThread().setNameä¿®æ”¹åå­—ï¼‰&lt;br&gt;
5ã€å…³é”®å¼‚æ­¥ä»»åŠ¡ç›‘æ§ï¼ˆå¼‚æ­¥ä¸ç­‰äºä¸è€—æ—¶ï¼ŒAOPçš„æ–¹å¼æ¥åšç›‘æ§ï¼‰&lt;br&gt;
6ã€é‡è§†ä¼˜å…ˆçº§çš„è®¾ç½®ï¼ˆProcess.setThreadPriority(),å¯ä»¥è®¾ç½®å¤šæ¬¡ï¼‰&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://onion99.github.io/2021/11/01/9LsQhIFgDkllFt0Q/</guid>
            <title>å®‰å“ä¼˜åŒ– - åŒ…ä½“ç§¯</title>
            <link>https://onion99.github.io/2021/11/01/9LsQhIFgDkllFt0Q/</link>
            <category>æ€§èƒ½ä¼˜åŒ–</category>
            <pubDate>Mon, 01 Nov 2021 04:48:08 +0800</pubDate>
            <description><![CDATA[ &lt;p&gt;&lt;a href=&#34;https://cloud.tencent.com/developer/article/1425318&#34; target=&#34;_blank&#34;&gt;Android APP ç»ˆæç˜¦èº«æŒ‡å—&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å›¾ç‰‡è½¬WebP&lt;/li&gt;
&lt;li&gt;å»æ‰ä¸å¿…è¦çš„soåº“&lt;/li&gt;
&lt;li&gt;å¼€å¯shrinkResourceså»é™¤æ— ç”¨èµ„æº&lt;/li&gt;
&lt;li&gt;å¼€å¯minifyEnabledæ··æ·†ä»£ç &lt;/li&gt;
&lt;li&gt;åˆ é™¤æ— ç”¨çš„è¯­è¨€èµ„æº&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨å¾®ä¿¡èµ„æºå‹ç¼©æ‰“åŒ…å·¥å…·&lt;/li&gt;
&lt;li&gt;é¿å…é‡å¤åº“,ä»¥åŠé¿å…ä¸åŒç‰ˆæœ¬çš„åº“&lt;/li&gt;
&lt;li&gt;AndroidManifestä¸­ -&amp;gt; android:extractNativeLibs=â€œtrueâ€&lt;/li&gt;
&lt;/ul&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://onion99.github.io/2021/11/01/UYa5EEntsM9sKTYz/</guid>
            <title>å®‰å“ä¼˜åŒ– - å¡é¡¿ä¼˜åŒ–</title>
            <link>https://onion99.github.io/2021/11/01/UYa5EEntsM9sKTYz/</link>
            <category>æ€§èƒ½ä¼˜åŒ–</category>
            <pubDate>Mon, 01 Nov 2021 04:47:12 +0800</pubDate>
            <description><![CDATA[ &lt;blockquote&gt;
&lt;p&gt;å¡é¡¿äº§ç”Ÿçš„æ ¹æœ¬åŸå› å°±æ˜¯CPUå’ŒGPUæ²¡æœ‰åŠæ—¶å¤„ç†å¥½æ•°æ®ï¼Œé’ˆå¯¹å¡é¡¿çš„ä¼˜åŒ–å°±æœ‰æ€è·¯äº†ï¼šå°½å¯èƒ½å‡å°‘ CPU å’Œ GPU èµ„æºçš„æ¶ˆè€—&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;CPUï¼šä¸­å¤®å¤„ç†å™¨ï¼ˆCPUï¼Œcentral processing unitï¼‰ä½œä¸ºè®¡ç®—æœºç³»ç»Ÿçš„è¿ç®—å’Œæ§åˆ¶æ ¸å¿ƒï¼Œæ˜¯ä¿¡æ¯å¤„ç†ã€ç¨‹åºè¿è¡Œçš„æœ€ç»ˆæ‰§è¡Œå•å…ƒ&lt;/li&gt;
&lt;li&gt;GPUï¼šå›¾å½¢å¤„ç†å™¨ï¼ˆè‹±è¯­ï¼šGraphics Processing Unitï¼Œç¼©å†™ï¼šGPUï¼‰ï¼Œåˆç§°æ˜¾ç¤ºæ ¸å¿ƒ,åšå›¾åƒå’Œå›¾å½¢ç›¸å…³è¿ç®—å·¥ä½œçš„å¾®å¤„ç†å™¨&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;å¡é¡¿æ£€æµ‹&#34;&gt;å¡é¡¿æ£€æµ‹&lt;a title=&#34;#å¡é¡¿æ£€æµ‹&#34; href=&#34;#å¡é¡¿æ£€æµ‹&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/lmj623565791/article/details/58626355&#34; target=&#34;_blank&#34;&gt;Android UIæ€§èƒ½ä¼˜åŒ– æ£€æµ‹åº”ç”¨ä¸­çš„UIå¡é¡¿&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.jianshu.com/p/9e8f88eac490&#34; target=&#34;_blank&#34;&gt;Androidæ€§èƒ½ä¼˜åŒ–-æ£€æµ‹Appå¡é¡¿ - ç®€ä¹¦ (jianshu.com)&lt;/a&gt;&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;h4 id=&#34;ç”¨uiçº¿ç¨‹looperæ‰“å°çš„æ—¥å¿—&#34;&gt;ç”¨UIçº¿ç¨‹Looperæ‰“å°çš„æ—¥å¿—&lt;a title=&#34;#ç”¨uiçº¿ç¨‹looperæ‰“å°çš„æ—¥å¿—&#34; href=&#34;#ç”¨uiçº¿ç¨‹looperæ‰“å°çš„æ—¥å¿—&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;å¼€æºå·¥å…·:&lt;br&gt;
&lt;a href=&#34;https://github.com/Kyson/AndroidGodEye&#34; target=&#34;_blank&#34;&gt;Kyson/AndroidGodEye: An app performance monitor(APM) , like â€œAndroid Studio profilerâ€, you can easily monitor the performance of your app real time in browser (github.com)&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/markzhai/AndroidPerformanceMonitor&#34; target=&#34;_blank&#34;&gt;markzhai/AndroidPerformanceMonitor: A transparent ui-block detection library for Android. (known as BlockCanary) &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/BzCoder/BlockCanaryCompat&#34; target=&#34;_blank&#34;&gt;BzCoder/BlockCanaryCompat: å¡é¡¿ç›‘æ§ï¼ŒBlockCanary é€‚é…Android O ä»¥ä¸Šç³»ç»Ÿ (github.com)&lt;/a&gt;&lt;/p&gt;
&lt;h4 id=&#34;choreographer&#34;&gt;Choreographer&lt;a title=&#34;#choreographer&#34; href=&#34;#choreographer&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Androidç³»ç»Ÿæ¯éš”16mså‘å‡ºVSYNCä¿¡å·ï¼Œè§¦å‘å¯¹UIè¿›è¡Œæ¸²æŸ“ã€‚å¼€å‘è€…å¯ä»¥ä½¿ç”¨Choreographer#postFrameCallbackè®¾ç½®è‡ªå·±çš„callbackä¸Choreographeräº¤äº’ï¼Œä½ è®¾ç½®çš„FrameCallCackï¼ˆdoFrameæ–¹æ³•ï¼‰ä¼šåœ¨ä¸‹ä¸€ä¸ªframeè¢«æ¸²æŸ“æ—¶è§¦å‘ã€‚ç†è®ºä¸Šæ¥è¯´ä¸¤æ¬¡å›è°ƒçš„æ—¶é—´å‘¨æœŸåº”è¯¥åœ¨16msï¼Œå¦‚æœè¶…è¿‡äº†16msæˆ‘ä»¬åˆ™è®¤ä¸ºå‘ç”Ÿäº†å¡é¡¿ï¼Œæˆ‘ä»¬ä¸»è¦å°±æ˜¯åˆ©ç”¨ä¸¤æ¬¡å›è°ƒé—´çš„æ—¶é—´å‘¨æœŸæ¥åˆ¤æ–­&lt;/p&gt;
&lt;p&gt;å¼€æºå·¥å…·:&lt;br&gt;
&lt;a href=&#34;https://github.com/wasabeef/Takt&#34; target=&#34;_blank&#34;&gt;wasabeef/Takt: Takt is Android library for measuring the FPS using Choreographer&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/friendlyrobotnyc/TinyDancer&#34; target=&#34;_blank&#34;&gt;friendlyrobotnyc/TinyDancer: An android library for displaying fps from the choreographer and percentage of time with two or more frames dropped &lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;anråˆ†æ&#34;&gt;ANRåˆ†æ&lt;a title=&#34;#anråˆ†æ&#34; href=&#34;#anråˆ†æ&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;Application Not Respondingï¼Œä¹Ÿå°±æ˜¯åº”ç”¨ç¨‹åºæ— å“åº”&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;äº§ç”ŸåŸå› &#34;&gt;äº§ç”ŸåŸå› &lt;a title=&#34;#äº§ç”ŸåŸå› &#34; href=&#34;#äº§ç”ŸåŸå› &#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;InputDispatching Timeoutï¼š5ç§’å†…æ— æ³•å“åº”å±å¹•è§¦æ‘¸äº‹ä»¶æˆ–é”®ç›˜è¾“å…¥äº‹ä»¶&lt;/li&gt;
&lt;li&gt;BroadcastQueue Timeout ï¼šåœ¨æ‰§è¡Œå‰å°å¹¿æ’­ï¼ˆBroadcastReceiverï¼‰çš„&lt;code&gt;onReceive()&lt;/code&gt;å‡½æ•°æ—¶10ç§’æ²¡æœ‰å¤„ç†å®Œæˆï¼Œåå°ä¸º60ç§’&lt;/li&gt;
&lt;li&gt;Service Timeoutï¼šå‰å°æœåŠ¡20ç§’å†…ï¼Œåå°æœåŠ¡åœ¨200ç§’å†…æ²¡æœ‰æ‰§è¡Œå®Œæ¯•&lt;/li&gt;
&lt;li&gt;ContentProvider Timeoutï¼šContentProviderçš„publishåœ¨10så†…æ²¡è¿›è¡Œå®Œ&lt;/li&gt;
&lt;li&gt;å…¶ä»–
&lt;ul&gt;
&lt;li&gt;ä¸»çº¿ç¨‹é˜»å¡æˆ–ä¸»çº¿ç¨‹æ•°æ®è¯»å–&lt;/li&gt;
&lt;li&gt;CPUæ»¡è´Ÿè·ï¼ŒI/Oé˜»å¡&lt;/li&gt;
&lt;li&gt;å†…å­˜ä¸è¶³&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åˆ†æ:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;logä¸Šçš„anr reason&lt;/li&gt;
&lt;li&gt;adb å¯¼å‡ºANRæ—¥å¿—
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;adb pull /data/anr/traces.txt&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://onion99.github.io/2021/11/01/T8ghe13OAeLx6NBP/</guid>
            <title>å®‰å“ä¼˜åŒ– - å†…å­˜ä¼˜åŒ–</title>
            <link>https://onion99.github.io/2021/11/01/T8ghe13OAeLx6NBP/</link>
            <category>æ€§èƒ½ä¼˜åŒ–</category>
            <pubDate>Mon, 01 Nov 2021 04:46:21 +0800</pubDate>
            <description><![CDATA[ &lt;h3 id=&#34;å†…å­˜ä¿¡æ¯æŸ¥çœ‹&#34;&gt;å†…å­˜ä¿¡æ¯æŸ¥çœ‹&lt;a title=&#34;#å†…å­˜ä¿¡æ¯æŸ¥çœ‹&#34; href=&#34;#å†…å­˜ä¿¡æ¯æŸ¥çœ‹&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.jianshu.com/p/28b9cd87e667&#34; target=&#34;_blank&#34;&gt;Appå†…å­˜ä¼˜åŒ–å®è·µï¼šä¸€æ­¥ä¸€æ­¥åšå†…å­˜åˆ†æä¸ä¼˜åŒ–&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æŸ¥çœ‹æ¯ä¸ªAppè¿›ç¨‹å¯ä»¥åˆ†é…åˆ°çš„æœ€å¤§å†…å­˜&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;adb shell getprop | grep dalvik.vm.heapsize&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Appçš„å†…å­˜ä½¿ç”¨æƒ…å†µæ¦‚è§ˆ&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;adb shell dumpsys meminfo åŒ…å&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;ä¼˜åŒ–å·¥å…·&#34;&gt;ä¼˜åŒ–å·¥å…·&lt;a title=&#34;#ä¼˜åŒ–å·¥å…·&#34; href=&#34;#ä¼˜åŒ–å·¥å…·&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;CPU Profiler&lt;/li&gt;
&lt;li&gt;Memory Analyzerï¼ˆMATï¼‰&lt;/li&gt;
&lt;li&gt;LeakCannary&lt;/li&gt;
&lt;/ul&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;h3 id=&#34;ä¼˜åŒ–æ–¹å‘&#34;&gt;ä¼˜åŒ–æ–¹å‘&lt;a title=&#34;#ä¼˜åŒ–æ–¹å‘&#34; href=&#34;#ä¼˜åŒ–æ–¹å‘&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.cnblogs.com/wangjie1990/p/11327112.html&#34; target=&#34;_blank&#34;&gt;Android å¦‚ä½•ä¼˜åŒ–APPå†…å­˜ &lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è°¨æ…ä½¿ç”¨Services
&lt;ul&gt;
&lt;li&gt;å¯åŠ¨ä¸€ä¸ªServiceæ—¶ï¼Œ ç³»ç»Ÿéœ€è¦å§‹ç»ˆä¿æŒè¿è¡Œè¯¥Serviceçš„è¿›ç¨‹,è¯¥Serviceå ç”¨çš„RAMå¯¹å…¶ä»–è¿›ç¨‹ä¸å…±äº«&lt;/li&gt;
&lt;li&gt;é¿å…ä½¿ç”¨æŒä¹…æ€§æœåŠ¡,å¦‚&lt;code&gt;JobScheduler&lt;/code&gt;ä¹‹ç±»&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ç»è¿‡ä¼˜åŒ–çš„å¤šæ•°æ®å®¹å™¨
&lt;ul&gt;
&lt;li&gt;å¦‚SparseArrayï¼ŒSparseBooleanArrayå’ŒLongSparseArray&lt;/li&gt;
&lt;li&gt;å¦‚æœ‰å¿…è¦ï¼Œæ‚¨å¯ä»¥éšæ—¶åˆ‡æ¢åˆ°åŸå§‹æ•°ç»„ä»¥è·å¾—ç²¾ç®€çš„æ•°æ®ç»“æ„&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨nano protobufsè¿›è¡Œåºåˆ—åŒ–æ•°æ®&lt;/li&gt;
&lt;li&gt;é¿å…å†…å­˜æ³„æ¼
&lt;ul&gt;
&lt;li&gt;å†…å­˜æ³„éœ²ä¼šå¯¼è‡´å¤§é‡çš„åƒåœ¾æ”¶é›†äº‹ä»¶å‘ç”Ÿ,ä»è€Œå¯¼è‡´ç³»ç»Ÿæ‰§è¡Œå…¶ä»–å†…å®¹(å¦‚æ¸²æŸ“æˆ–è€…ä¼ è¾“)çš„æ—¶é—´å˜å°‘&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç§»é™¤å†…å­˜å¯†é›†å‹èµ„æºï¼Œä»¥åŠlibåº“
&lt;ul&gt;
&lt;li&gt;å‡å°APKçš„å¤§å°&lt;/li&gt;
&lt;li&gt;è¯·ä½¿ç”¨ä¸è¿›è¡Œåå°„æ‰«æçš„ä¾èµ–æ³¨å…¥åº“(Dagger2),é¢‘ç¹çš„åå°„éœ€è¦æ›´å¤šçš„CPUå’Œå†…å­˜æ¶ˆè€—&lt;/li&gt;
&lt;li&gt;è°¨æ…ä½¿ç”¨å¤–éƒ¨åº“,å¤–éƒ¨åº“å¯èƒ½å¯¹åŒä¸€ä¸ªåŠŸèƒ½æœ‰ä¸ä¸€æ ·çš„å®ç°,è¿™å¯èƒ½å¯¼è‡´é¢„æœŸä¹‹å¤–çš„äº‹æƒ…&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://onion99.github.io/2021/11/01/4LlbPfdOOCp58LMK/</guid>
            <title>å®‰å“ä¼˜åŒ– - å¯åŠ¨ä¼˜åŒ–</title>
            <link>https://onion99.github.io/2021/11/01/4LlbPfdOOCp58LMK/</link>
            <category>æ€§èƒ½ä¼˜åŒ–</category>
            <pubDate>Mon, 01 Nov 2021 04:43:04 +0800</pubDate>
            <description><![CDATA[ &lt;h3 id=&#34;å¯åŠ¨æµç¨‹&#34;&gt;å¯åŠ¨æµç¨‹&lt;a title=&#34;#å¯åŠ¨æµç¨‹&#34; href=&#34;#å¯åŠ¨æµç¨‹&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;h4 id=&#34;ç›¸å…³&#34;&gt;ç›¸å…³&lt;a title=&#34;#ç›¸å…³&#34; href=&#34;#ç›¸å…³&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;å¯åŠ¨çš„æµç¨‹å°±æ˜¯é€šè¿‡è¿™å…­ä¸ªå¤§ç±»åœ¨è¿™ä¸‰ä¸ªè¿›ç¨‹ä¹‹é—´ä¸æ–­é€šä¿¡çš„è¿‡ç¨‹&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h5 id=&#34;ä¸‰ä¸ªè¿›ç¨‹&#34;&gt;ä¸‰ä¸ªè¿›ç¨‹&lt;a title=&#34;#ä¸‰ä¸ªè¿›ç¨‹&#34; href=&#34;#ä¸‰ä¸ªè¿›ç¨‹&#34;&gt;&lt;/a&gt;&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;Launcherè¿›ç¨‹: æ•´ä¸ªAppå¯åŠ¨æµç¨‹çš„èµ·ç‚¹,è´Ÿè´£å¤„ç†æ¡Œé¢ä¸ç”¨æˆ·ä¹‹é—´çš„äº¤äº’äº‹ä»¶,å¯ä»¥æƒ³è±¡ä¸ºä¸€ä¸ªæ¡Œé¢å¯åŠ¨å™¨&lt;/li&gt;
&lt;li&gt;SystemServerè¿›ç¨‹: Androidä¸­çš„æ‰€æœ‰SystemServeréƒ½ç”±å…¶å­µåŒ–(Fork)å‡ºæ¥,ä¾‹å¦‚AMS,WindowsMannager,PackageManagerServiceç­‰&lt;/li&gt;
&lt;li&gt;Appè¿›ç¨‹: å¯åŠ¨çš„Appæ‰€åœ¨çš„è¿›ç¨‹&lt;/li&gt;
&lt;/ul&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;h5 id=&#34;å…­ä¸ªå¤§ç±»&#34;&gt;å…­ä¸ªå¤§ç±»&lt;a title=&#34;#å…­ä¸ªå¤§ç±»&#34; href=&#34;#å…­ä¸ªå¤§ç±»&#34;&gt;&lt;/a&gt;&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;ActivityManagerService:  å³AMS,è´Ÿè´£ç®¡ç†ç³»ç»Ÿä¸­å››å¤§ç»„ä»¶çš„å¯åŠ¨,åˆ‡æ¢,è°ƒåº¦ä»¥åŠåº”ç”¨è¿›ç¨‹çš„ç®¡ç†&lt;/li&gt;
&lt;li&gt;Instrumentation: ç›‘æ§åº”ç”¨ç¨‹åºå’Œç³»ç»Ÿçš„äº¤äº’&lt;/li&gt;
&lt;li&gt;ActivityThread: åº”ç”¨çš„å…¥å£ç±»ï¼Œé€šè¿‡è°ƒç”¨mainæ–¹æ³•ï¼Œå¼€å¯æ¶ˆæ¯å¾ªç¯é˜Ÿåˆ—ã€‚ActivityThreadæ‰€åœ¨çš„çº¿ç¨‹è¢«ç§°ä¸ºä¸»çº¿ç¨‹&lt;/li&gt;
&lt;li&gt;ApplicationThread: æä¾›Binderé€šè®¯æ¥å£ï¼ŒAMSåˆ™é€šè¿‡ä»£ç†è°ƒç”¨æ­¤Appè¿›ç¨‹çš„æœ¬åœ°æ–¹æ³•&lt;/li&gt;
&lt;li&gt;ActivityManagerProxyï¼šAMSæœåŠ¡åœ¨å½“å‰è¿›ç¨‹çš„ä»£ç†ç±»ï¼Œè´Ÿè´£ä¸AMSé€šä¿¡&lt;/li&gt;
&lt;li&gt;ApplicationThreadProxyï¼šApplicationThreadåœ¨AMSæœåŠ¡ä¸­çš„ä»£ç†ç±»ï¼Œè´Ÿè´£ä¸ApplicationThreadé€šä¿¡&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;é¡ºåº&#34;&gt;é¡ºåº&lt;a title=&#34;#é¡ºåº&#34; href=&#34;#é¡ºåº&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/huangliniqng/article/details/89364064&#34; target=&#34;_blank&#34;&gt;APPå¯åŠ¨æµç¨‹è§£æ,å¢™è£‚æ¨è&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://www.cnblogs.com/not2/p/14326090.html&#34; target=&#34;_blank&#34;&gt;Appå¯åŠ¨é€Ÿåº¦ä¼˜åŒ– T2&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://blog.csdn.net/huangliniqng/article/details/89364064&#34; target=&#34;_blank&#34;&gt;å…·ä½“ä»£ç æµç¨‹&lt;/a&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Launcheré€šçŸ¥AMS, è¦å¯åŠ¨æŸä¸€åº”ç”¨,å¹¶è¯´æ˜å¯¹åº”çš„LauncherActivity&lt;/li&gt;
&lt;li&gt;AMSè¡¨ç¤ºæ”¶åˆ°, ç­‰å¾…Launcherè¿›å…¥PauseçŠ¶æ€&lt;/li&gt;
&lt;li&gt;Launcherè¿›å…¥PauseçŠ¶æ€, é€šçŸ¥AMSå¯ä»¥å¯åŠ¨æŸä¸€åº”ç”¨äº†&lt;/li&gt;
&lt;li&gt;AMSå¼€å§‹æ£€æŸ¥æŸä¸€åº”ç”¨æ˜¯å¦å¯åŠ¨
&lt;ul&gt;
&lt;li&gt;æ˜¯,åˆ™ç›´æ¥å¯åŠ¨,æµç¨‹ç»ˆæ­¢&lt;/li&gt;
&lt;li&gt;å¦,AMSåˆ™åœ¨çš„è¿›ç¨‹ä¸­åˆ›å»ºActivityThreadå¯¹è±¡,å¹¶å¯åŠ¨mainå‡½æ•°&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æŸä¸€åº”ç”¨é€šçŸ¥AMSå¯åŠ¨å‡†å¤‡å°±ç»ª&lt;/li&gt;
&lt;li&gt;AMSé€šçŸ¥æŸä¸€åº”ç”¨è¦å¯åŠ¨çš„é¡µé¢,æŸä¸€åº”ç”¨å¯åŠ¨å¯¹åº”é¡µé¢&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/10/27/57Z1PJ.png&#34; alt=&#34;57Z1PJ.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;å¯åŠ¨åˆ†ç±»&#34;&gt;å¯åŠ¨åˆ†ç±»&lt;a title=&#34;#å¯åŠ¨åˆ†ç±»&#34; href=&#34;#å¯åŠ¨åˆ†ç±»&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;å†·å¯åŠ¨
&lt;ul&gt;
&lt;li&gt;è€—æ—¶æœ€å¤š,ä¼˜åŒ–é‡ç‚¹&lt;/li&gt;
&lt;li&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/10/27/57ZxJJ.png&#34; alt=&#34;57ZxJJ.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;çƒ­å¯åŠ¨
&lt;ul&gt;
&lt;li&gt;æœ€å¿«.å³åå°åˆ°å‰å°çš„åˆ‡æ¢&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ¸©å¯åŠ¨
&lt;ul&gt;
&lt;li&gt;è¾ƒå¿«,åªé‡èµ°Activityçš„ç”Ÿå‘½å‘¨æœŸ,å³é”€æ¯åé‡å»º&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;è€—æ—¶ç»Ÿè®¡&#34;&gt;è€—æ—¶ç»Ÿè®¡&lt;a title=&#34;#è€—æ—¶ç»Ÿè®¡&#34; href=&#34;#è€—æ—¶ç»Ÿè®¡&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;h4 id=&#34;systrace&#34;&gt;Systrace&lt;a title=&#34;#systrace&#34; href=&#34;#systrace&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;TraceCompat.beginSection(&lt;span class=&#34;string&#34;&gt;&amp;quot;sectionName&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;TraceCompat.endSection();&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;code&gt;python systrace.py -t 10 [other-options] [categories]&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&#34;traceview&#34;&gt;Traceview&lt;a title=&#34;#traceview&#34; href=&#34;#traceview&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/10/27/57llge.png&#34; alt=&#34;57llge.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨æ–¹å¼&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;Debug.startMethodTracing(&lt;span class=&#34;string&#34;&gt;&amp;quot;fileName&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Debug.stopMethodTracing()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;è¿è¡Œä¹‹åå¯ä»¥åœ¨ç›®å½•ä¸‹ç”Ÿæˆæ–‡ä»¶ï¼šå†…éƒ¨å­˜å‚¨/android/data/${application}/files/fileName.traceï¼Œæ­¤æ–‡ä»¶å¯ä»¥ä½¿ç”¨Android Studio Profileæ‰“å¼€&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Wall Clock time : æ˜¯çº¿ç¨‹çœŸæ­£æ‰§è¡Œçš„æ—¶é—´&lt;/li&gt;
&lt;li&gt;Thread time : CPUæ‰§è¡Œçš„æ—¶é—´,æ¯”Wall Clock Timeå°‘,ä¸åŒ…å«é”æ—¶é—´,ç­‰å¾…æ—¶é—´&lt;/li&gt;
&lt;li&gt;Top Down:å°±æ˜¯å‡½æ•°çš„è°ƒç”¨åˆ—è¡¨&lt;/li&gt;
&lt;li&gt;Call Chart: ç³»ç»ŸApié»„è‰²ï¼Œåº”ç”¨è°ƒç”¨çš„æ–¹æ³•ç»¿è‰²ï¼Œç¬¬ä¸‰æ–¹Api(java sdkä¹Ÿå±äºç¬¬ä¸‰æ–¹)è“è‰²&lt;/li&gt;
&lt;li&gt;Flame Chart:  ä¸»è¦çš„ä½œç”¨æ˜¯æ”¶é›†è°ƒç”¨æ–¹æ³•çš„æ—¶é—´ï¼Œæ¯”å¦‚å¤šæ¬¡è°ƒç”¨LayoutInflate.inflateï¼ŒFlame Chartä¼šæŠŠä»–ä»¬éƒ½æ”¶é›†åˆ°ä¸€èµ·ã€‚&lt;/li&gt;
&lt;li&gt;Bottom Up: å’ŒTop Downæ˜¯ç›¸åçš„&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;adb-å‘½ä»¤ç»Ÿè®¡&#34;&gt;Adb å‘½ä»¤ç»Ÿè®¡&lt;a title=&#34;#adb-å‘½ä»¤ç»Ÿè®¡&#34; href=&#34;#adb-å‘½ä»¤ç»Ÿè®¡&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;&lt;code&gt;adb shell am start -S -W åŒ…å/å¯åŠ¨ç±»çš„å…¨é™å®šå&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ThisTime : æœ€åä¸€ä¸ª Activity çš„å¯åŠ¨è€—æ—¶&lt;br&gt;
TotalTime : å¯åŠ¨ä¸€è¿ä¸²çš„ Activity æ€»è€—æ—¶&lt;br&gt;
WaitTime : åº”ç”¨è¿›ç¨‹çš„åˆ›å»ºè¿‡ç¨‹ + TotalTime&lt;/p&gt;
&lt;h4 id=&#34;ç³»ç»Ÿæ—¥å¿—ç»Ÿè®¡&#34;&gt;ç³»ç»Ÿæ—¥å¿—ç»Ÿè®¡&lt;a title=&#34;#ç³»ç»Ÿæ—¥å¿—ç»Ÿè®¡&#34; href=&#34;#ç³»ç»Ÿæ—¥å¿—ç»Ÿè®¡&#34;&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;è¿‡æ»¤&lt;code&gt;displayed&lt;/code&gt;è¾“å‡ºçš„å¯åŠ¨æ—¥å¿—&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://z3.ax1x.com/2021/10/27/57mU4e.png&#34; alt=&#34;57mU4e.png&#34; loading=&#34;lazy&#34; class=&#34;Ï†bp&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;å†·å¯åŠ¨ä¼˜åŒ–&#34;&gt;å†·å¯åŠ¨ä¼˜åŒ–&lt;a title=&#34;#å†·å¯åŠ¨ä¼˜åŒ–&#34; href=&#34;#å†·å¯åŠ¨ä¼˜åŒ–&#34;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://jishuin.proginn.com/p/763bfbd345f0&#34; target=&#34;_blank&#34;&gt; App å¯åŠ¨æ—¶é—´ä¼˜åŒ–è¯¦è§£&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä¼˜åŒ–æ–¹å‘:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å»¶è¿ŸåŠ è½½ / æ‡’åŠ è½½&lt;/li&gt;
&lt;li&gt;å¼‚æ­¥çº¿ç¨‹æ‰§è¡Œè€—æ—¶æ“ä½œï¼Œå¦‚å›¾ç‰‡åŠ è½½ã€ç½‘ç»œè®¿é—®ã€IOæ“ä½œç­‰&lt;/li&gt;
&lt;li&gt;ViewStubçš„ä½¿ç”¨&lt;/li&gt;
&lt;li&gt;å‡å°‘å¸ƒå±€å±‚æ¬¡å’ŒåµŒå¥—å¸ƒå±€&lt;/li&gt;
&lt;/ul&gt;
 ]]></description>
        </item>
    </channel>
</rss>
